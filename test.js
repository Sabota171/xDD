(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{41396:function(m,R){!function(m){"use strict";var R,extendStatics=function(m,R){return(extendStatics=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(m,R){m.__proto__=R}||function(m,R){for(var C in R)Object.prototype.hasOwnProperty.call(R,C)&&(m[C]=R[C])})(m,R)};function __extends(m,R){if("function"!=typeof R&&null!==R)throw TypeError("Class extends value "+String(R)+" is not a constructor or null");function __(){this.constructor=m}extendStatics(m,R),m.prototype=null===R?Object.create(R):(__.prototype=R.prototype,new __)}function __decorate(m,R,C,T){var L,U=arguments.length,$=U<3?R:null===T?T=Object.getOwnPropertyDescriptor(R,C):T;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)$=Reflect.decorate(m,R,C,T);else for(var B=m.length-1;B>=0;B--)(L=m[B])&&($=(U<3?L($):U>3?L(R,C,$):L(R,C))||$);return U>3&&$&&Object.defineProperty(R,C,$),$}function __spreadArray(m,R,C){if(C||2==arguments.length)for(var T,L=0,U=R.length;L=m.length)return!1;for(var C=m.length-1,T=R;TT?1:0},T=function(){function ArraySchema(){for(var m=[],R=0;R>6:(T<55296||T>=57344?m[R++]=224|T>>12:(L++,T=65536+((1023&T)<<10|1023&C.charCodeAt(L)),m[R++]=240|T>>18,m[R++]=128|T>>12&63),m[R++]=128|T>>6&63),m[R++]=128|63&T)}function int8$1(m,R){m.push(255&R)}function uint8$1(m,R){m.push(255&R)}function int16$1(m,R){m.push(255&R),m.push(R>>8&255)}function uint16$1(m,R){m.push(255&R),m.push(R>>8&255)}function int32$1(m,R){m.push(255&R),m.push(R>>8&255),m.push(R>>16&255),m.push(R>>24&255)}function uint32$1(m,R){var C=R>>24,T=R>>16,L=R>>8;m.push(255&R),m.push(255&L),m.push(255&T),m.push(255&C)}function int64$1(m,R){uint32$1(m,R>>>0),uint32$1(m,Math.floor(R/4294967296))}function uint64$1(m,R){uint32$1(m,R>>>0),uint32$1(m,R/4294967296>>0)}var H=new Int32Array(2),G=new Float32Array(H.buffer),q=new Float64Array(H.buffer);function writeFloat32(m,R){G[0]=R,int32$1(m,H[0])}function writeFloat64(m,R){q[0]=R,int32$1(m,H[0]),int32$1(m,H[1])}function string$1(m,R){R||(R="");var C=function(m){for(var R=0,C=0,T=0,L=m.length;T=57344?C+=3:(T++,C+=4);return C}(R),T=0;if(C<32)m.push(160|C),T=1;else if(C<256)m.push(217),uint8$1(m,C),T=2;else if(C<65536)m.push(218),uint16$1(m,C),T=3;else if(C<4294967296)m.push(219),uint32$1(m,C),T=5;else throw Error("String too long");return utf8Write(m,m.length,R),T+C}function number$1(m,R){return isNaN(R)?number$1(m,0):isFinite(R)?R!==(0|R)?(m.push(203),writeFloat64(m,R),9):R>=0?R<128?(uint8$1(m,R),1):R<256?(m.push(204),uint8$1(m,R),2):R<65536?(m.push(205),uint16$1(m,R),3):R<4294967296?(m.push(206),uint32$1(m,R),5):(m.push(207),uint64$1(m,R),9):R>=-32?(m.push(224|R+32),1):R>=-128?(m.push(208),int8$1(m,R),2):R>=-32768?(m.push(209),int16$1(m,R),3):R>=-2147483648?(m.push(210),int32$1(m,R),5):(m.push(211),int64$1(m,R),9):number$1(m,R>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER)}var W=Object.freeze({__proto__:null,utf8Write:utf8Write,int8:int8$1,uint8:uint8$1,int16:int16$1,uint16:uint16$1,int32:int32$1,uint32:uint32$1,int64:int64$1,uint64:uint64$1,float32:function(m,R){writeFloat32(m,R)},float64:function(m,R){writeFloat64(m,R)},writeFloat32:writeFloat32,writeFloat64:writeFloat64,boolean:function(m,R){return uint8$1(m,R?1:0)},string:string$1,number:number$1});function int8(m,R){return uint8(m,R)<<24>>24}function uint8(m,R){return m[R.offset++]}function int16(m,R){return uint16(m,R)<<16>>16}function uint16(m,R){return m[R.offset++]|m[R.offset++]<<8}function int32(m,R){return m[R.offset++]|m[R.offset++]<<8|m[R.offset++]<<16|m[R.offset++]<<24}function uint32(m,R){return int32(m,R)>>>0}function int64(m,R){var C=uint32(m,R);return 4294967296*int32(m,R)+C}function uint64(m,R){var C=uint32(m,R);return 4294967296*uint32(m,R)+C}var Z=new Int32Array(2),Y=new Float32Array(Z.buffer),K=new Float64Array(Z.buffer);function readFloat32(m,R){return Z[0]=int32(m,R),Y[0]}function readFloat64(m,R){return Z[0]=int32(m,R),Z[1]=int32(m,R),K[0]}function string(m,R){var C,T=m[R.offset++];T<192?C=31&T:217===T?C=uint8(m,R):218===T?C=uint16(m,R):219===T&&(C=uint32(m,R));var L=function(m,R,C){for(var T="",L=0,U=R,$=R+C;U<$;U++){var B=m[U];if((128&B)==0){T+=String.fromCharCode(B);continue}if((224&B)==192){T+=String.fromCharCode((31&B)<<6|63&m[++U]);continue}if((240&B)==224){T+=String.fromCharCode((15&B)<<12|(63&m[++U])<<6|(63&m[++U])<<0);continue}if((248&B)==240){(L=(7&B)<<18|(63&m[++U])<<12|(63&m[++U])<<6|(63&m[++U])<<0)>=65536?(L-=65536,T+=String.fromCharCode((L>>>10)+55296,(1023&L)+56320)):T+=String.fromCharCode(L);continue}console.error("Invalid byte "+B.toString(16))}return T}(m,R.offset,C);return R.offset+=C,L}function number(m,R){var C=m[R.offset++];if(C<128)return C;if(202===C)return readFloat32(m,R);if(203===C)return readFloat64(m,R);if(204===C)return uint8(m,R);if(205===C)return uint16(m,R);if(206===C)return uint32(m,R);if(207===C)return uint64(m,R);else if(208===C)return int8(m,R);else if(209===C)return int16(m,R);else if(210===C)return int32(m,R);else if(211===C)return int64(m,R);else if(C>223)return-((255-C+1)*1)}function switchStructureCheck(m,R){return 255===m[R.offset-1]&&(m[R.offset]<128||m[R.offset]>=202&&m[R.offset]<=211)}var J=Object.freeze({__proto__:null,int8:int8,uint8:uint8,int16:int16,uint16:uint16,int32:int32,uint32:uint32,float32:function(m,R){return readFloat32(m,R)},float64:function(m,R){return readFloat64(m,R)},int64:int64,uint64:uint64,readFloat32:readFloat32,readFloat64:readFloat64,boolean:function(m,R){return uint8(m,R)>0},string:string,stringCheck:function(m,R){var C=m[R.offset];return C<192&&C>160||217===C||218===C||219===C},number:number,numberCheck:function(m,R){var C=m[R.offset];return C<128||C>=202&&C<=211},arrayCheck:function(m,R){return m[R.offset]<160},switchStructureCheck:switchStructureCheck}),X=function(){function CollectionSchema(m){var R=this;this.$changes=new C(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,m&&m.forEach(function(m){return R.add(m)})}return CollectionSchema.prototype.onAdd=function(R,C){return void 0===C&&(C=!0),addCallback(this.$callbacks||(this.$callbacks=[]),m.OPERATION.ADD,R,C?this.$items:void 0)},CollectionSchema.prototype.onRemove=function(R){return addCallback(this.$callbacks||(this.$callbacks=[]),m.OPERATION.DELETE,R)},CollectionSchema.prototype.onChange=function(R){return addCallback(this.$callbacks||(this.$callbacks=[]),m.OPERATION.REPLACE,R)},CollectionSchema.is=function(m){return void 0!==m.collection},CollectionSchema.prototype.add=function(m){var R=this.$refId++;return void 0!==m.$changes&&m.$changes.setParent(this,this.$changes.root,R),this.$changes.indexes[R]=R,this.$indexes.set(R,R),this.$items.set(R,m),this.$changes.change(R),R},CollectionSchema.prototype.at=function(m){var R=Array.from(this.$items.keys())[m];return this.$items.get(R)},CollectionSchema.prototype.entries=function(){return this.$items.entries()},CollectionSchema.prototype.delete=function(m){for(var R,C,T=this.$items.entries();(C=T.next())&&!C.done;)if(m===C.value[1]){R=C.value[0];break}return void 0!==R&&(this.$changes.delete(R),this.$indexes.delete(R),this.$items.delete(R))},CollectionSchema.prototype.clear=function(R){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),R&&removeChildRefs.call(this,R),this.$items.clear(),this.$changes.operation({index:0,op:m.OPERATION.CLEAR}),this.$changes.touchParents()},CollectionSchema.prototype.has=function(m){return Array.from(this.$items.values()).some(function(R){return R===m})},CollectionSchema.prototype.forEach=function(m){var R=this;this.$items.forEach(function(C,T,L){return m(C,T,R)})},CollectionSchema.prototype.values=function(){return this.$items.values()},Object.defineProperty(CollectionSchema.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),CollectionSchema.prototype.setIndex=function(m,R){this.$indexes.set(m,R)},CollectionSchema.prototype.getIndex=function(m){return this.$indexes.get(m)},CollectionSchema.prototype.getByIndex=function(m){return this.$items.get(this.$indexes.get(m))},CollectionSchema.prototype.deleteByIndex=function(m){var R=this.$indexes.get(m);this.$items.delete(R),this.$indexes.delete(m)},CollectionSchema.prototype.toArray=function(){return Array.from(this.$items.values())},CollectionSchema.prototype.toJSON=function(){var m=[];return this.forEach(function(R,C){m.push("function"==typeof R.toJSON?R.toJSON():R)}),m},CollectionSchema.prototype.clone=function(m){var R;return m?R=Object.assign(new CollectionSchema,this):(R=new CollectionSchema,this.forEach(function(m){m.$changes?R.add(m.clone()):R.add(m)})),R},CollectionSchema}(),Q=function(){function SetSchema(m){var R=this;this.$changes=new C(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,m&&m.forEach(function(m){return R.add(m)})}return SetSchema.prototype.onAdd=function(R,C){return void 0===C&&(C=!0),addCallback(this.$callbacks||(this.$callbacks=[]),m.OPERATION.ADD,R,C?this.$items:void 0)},SetSchema.prototype.onRemove=function(R){return addCallback(this.$callbacks||(this.$callbacks=[]),m.OPERATION.DELETE,R)},SetSchema.prototype.onChange=function(R){return addCallback(this.$callbacks||(this.$callbacks=[]),m.OPERATION.REPLACE,R)},SetSchema.is=function(m){return void 0!==m.set},SetSchema.prototype.add=function(R){if(this.has(R))return!1;var C,T,L=this.$refId++;void 0!==R.$changes&&R.$changes.setParent(this,this.$changes.root,L);var U=null!==(T=null===(C=this.$changes.indexes[L])||void 0===C?void 0:C.op)&&void 0!==T?T:m.OPERATION.ADD;return this.$changes.indexes[L]=L,this.$indexes.set(L,L),this.$items.set(L,R),this.$changes.change(L,U),L},SetSchema.prototype.entries=function(){return this.$items.entries()},SetSchema.prototype.delete=function(m){for(var R,C,T=this.$items.entries();(C=T.next())&&!C.done;)if(m===C.value[1]){R=C.value[0];break}return void 0!==R&&(this.$changes.delete(R),this.$indexes.delete(R),this.$items.delete(R))},SetSchema.prototype.clear=function(R){this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),R&&removeChildRefs.call(this,R),this.$items.clear(),this.$changes.operation({index:0,op:m.OPERATION.CLEAR}),this.$changes.touchParents()},SetSchema.prototype.has=function(m){for(var R,C=this.$items.values(),T=!1;(R=C.next())&&!R.done;)if(m===R.value){T=!0;break}return T},SetSchema.prototype.forEach=function(m){var R=this;this.$items.forEach(function(C,T,L){return m(C,T,R)})},SetSchema.prototype.values=function(){return this.$items.values()},Object.defineProperty(SetSchema.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),SetSchema.prototype.setIndex=function(m,R){this.$indexes.set(m,R)},SetSchema.prototype.getIndex=function(m){return this.$indexes.get(m)},SetSchema.prototype.getByIndex=function(m){return this.$items.get(this.$indexes.get(m))},SetSchema.prototype.deleteByIndex=function(m){var R=this.$indexes.get(m);this.$items.delete(R),this.$indexes.delete(m)},SetSchema.prototype.toArray=function(){return Array.from(this.$items.values())},SetSchema.prototype.toJSON=function(){var m=[];return this.forEach(function(R,C){m.push("function"==typeof R.toJSON?R.toJSON():R)}),m},SetSchema.prototype.clone=function(m){var R;return m?R=Object.assign(new SetSchema,this):(R=new SetSchema,this.forEach(function(m){m.$changes?R.add(m.clone()):R.add(m)})),R},SetSchema}(),ee=function(){function ClientState(){this.refIds=new WeakSet,this.containerIndexes=new WeakMap}return ClientState.prototype.addRefId=function(m){this.refIds.has(m)||(this.refIds.add(m),this.containerIndexes.set(m,new Set))},ClientState.get=function(m){return void 0===m.$filterState&&(m.$filterState=new ClientState),m.$filterState},ClientState}(),et=function(){function ReferenceTracker(){this.refs=new Map,this.refCounts={},this.deletedRefs=new Set,this.nextUniqueId=0}return ReferenceTracker.prototype.getNextUniqueId=function(){return this.nextUniqueId++},ReferenceTracker.prototype.addRef=function(m,R,C){void 0===C&&(C=!0),this.refs.set(m,R),C&&(this.refCounts[m]=(this.refCounts[m]||0)+1)},ReferenceTracker.prototype.removeRef=function(m){this.refCounts[m]=this.refCounts[m]-1,this.deletedRefs.add(m)},ReferenceTracker.prototype.clearRefs=function(){this.refs.clear(),this.deletedRefs.clear(),this.refCounts={}},ReferenceTracker.prototype.garbageCollectDeletedRefs=function(){var m=this;this.deletedRefs.forEach(function(R){if(!(m.refCounts[R]>0)){var C=m.refs.get(R);if(C instanceof en)for(var T in C._definition.schema)"string"!=typeof C._definition.schema[T]&&C[T]&&C[T].$changes&&m.removeRef(C[T].$changes.refId);else{var L=C.$changes.parent._definition;"function"==typeof Object.values(L.schema[L.fieldsByIndex[C.$changes.parentIndex]])[0]&&Array.from(C.values()).forEach(function(R){return m.removeRef(R.$changes.refId)})}m.refs.delete(R),delete m.refCounts[R]}}),this.deletedRefs.clear()},ReferenceTracker}(),er=function(m){function EncodeSchemaError(){return null!==m&&m.apply(this,arguments)||this}return __extends(EncodeSchemaError,m),EncodeSchemaError}(Error);function assertInstanceType(m,R,C,T){if(!(m instanceof R))throw new er("a '".concat(R.name,"' was expected, but '").concat(m.constructor.name,"' was provided in ").concat(C.constructor.name,"#").concat(T))}var en=function(){function Schema(){for(var m=[],R=0;R>6<<6:Z;if(et===m.OPERATION.CLEAR){$.clear(V);continue}var er=ee?Z%(et||255):number(R,C),en=ee?$._definition.fieldsByIndex[er]:"",eo=K.getType(er),ei=void 0,ea=void 0,es=void 0;if(ee?ea=$["_".concat(en)]:(ea=$.getByIndex(er),(et&m.OPERATION.ADD)===m.OPERATION.ADD?(es=$ instanceof L?string(R,C):er,$.setIndex(er,es)):es=$.getIndex(er)),(et&m.OPERATION.DELETE)===m.OPERATION.DELETE&&(et!==m.OPERATION.DELETE_AND_ADD&&$.deleteByIndex(er),ea&&ea.$changes&&H.removeRef(ea.$changes.refId),ei=null),void 0===en){console.warn("@colyseus/schema: definition mismatch");for(var el={offset:C.offset};C.offset1?R-1:0),T=1;T3?R.i-4:R.i:Array.isArray(m)?1:s(m)?2:v(m)?3:0}function u(m,R){return 2===o(m)?m.has(R):Object.prototype.hasOwnProperty.call(m,R)}function f(m,R,C){var T=o(m);2===T?m.set(R,C):3===T?m.add(C):m[R]=C}function c(m,R){return m===R?0!==m||1/m==1/R:m!=m&&R!=R}function s(m){return B&&m instanceof Map}function v(m){return V&&m instanceof Set}function p(m){return m.o||m.t}function l(m){if(Array.isArray(m))return Array.prototype.slice.call(m);var R=K(m);delete R[W];for(var C=Y(R),T=0;T1&&(m.set=m.add=m.clear=m.delete=h),Object.freeze(m),R&&i(m,function(m,R){return d(R,!0)},!0)),m}function h(){n(2)}function y(m){return null==m||"object"!=typeof m||Object.isFrozen(m)}function b(m){var R=J[m];return R||n(18,m),R}function j(m,R){R&&(b("Patches"),m.u=[],m.s=[],m.v=R)}function g(m){O(m),m.p.forEach(S),m.p=null}function O(m){m===U&&(U=m.l)}function w(m){return U={p:[],l:U,h:m,m:!0,_:0}}function S(m){var R=m[W];0===R.i||1===R.i?R.j():R.g=!0}function P(m,R){R._=R.p.length;var C=R.p[0],T=void 0!==m&&m!==C;return R.h.O||b("ES5").S(R,m,T),T?(C[W].P&&(g(R),n(4)),t(m)&&(m=M(R,m),R.l||x(R,m)),R.u&&b("Patches").M(C[W].t,m,R.u,R.s)):m=M(R,C,[]),g(R),R.u&&R.v(R.u,R.s),m!==G?m:void 0}function M(m,R,C){if(y(R))return R;var T=R[W];if(!T)return i(R,function(L,U){return A(m,T,R,L,U,C)},!0),R;if(T.A!==m)return R;if(!T.P)return x(m,T.t,!0),T.t;if(!T.I){T.I=!0,T.A._--;var L=4===T.i||5===T.i?T.o=l(T.k):T.o,U=L,$=!1;3===T.i&&(U=new Set(L),L.clear(),$=!0),i(U,function(R,U){return A(m,T,L,R,U,C,$)}),x(m,L,!1),C&&m.u&&b("Patches").N(T,C,m.u,m.s)}return T.o}function A(m,R,C,T,L,U,$){if(r(L)){var B=M(m,L,U&&R&&3!==R.i&&!u(R.R,T)?U.concat(T):void 0);if(f(C,T,B),!r(B))return;m.m=!1}else $&&C.add(L);if(t(L)&&!y(L)){if(!m.h.D&&m._<1)return;M(m,L),R&&R.A.l||x(m,L)}}function x(m,R,C){void 0===C&&(C=!1),!m.l&&m.h.D&&m.m&&d(R,C)}function z(m,R){var C=m[W];return(C?p(C):m)[R]}function I(m,R){if(R in m)for(var C=Object.getPrototypeOf(m);C;){var T=Object.getOwnPropertyDescriptor(C,R);if(T)return T;C=Object.getPrototypeOf(C)}}function k(m){m.P||(m.P=!0,m.l&&k(m.l))}function E(m){m.o||(m.o=l(m.t))}function N(m,R,C){var T,L,$,B,V,H,G,q=s(R)?b("MapSet").F(R,C):v(R)?b("MapSet").T(R,C):m.O?($=L={i:(T=Array.isArray(R))?1:0,A:C?C.A:U,P:!1,I:!1,R:{},l:C,t:R,k:null,o:null,j:null,C:!1},B=X,T&&($=[L],B=Q),H=(V=Proxy.revocable($,B)).revoke,G=V.proxy,L.k=G,L.j=H,G):b("ES5").J(R,C);return(C?C.A:U).p.push(q),q}function D(m,R){switch(R){case 2:return new Map(m);case 3:return Array.from(m)}return l(m)}C.d(R,{xC:function(){return configureStore},hg:function(){return ey},oM:function(){return createSlice}});var T,L,U,$="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),B="undefined"!=typeof Map,V="undefined"!=typeof Set,H="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,G=$?Symbol.for("immer-nothing"):((L={})["immer-nothing"]=!0,L),q=$?Symbol.for("immer-draftable"):"__$immer_draftable",W=$?Symbol.for("immer-state"):"__$immer_state",Z=""+Object.prototype.constructor,Y="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(m){return Object.getOwnPropertyNames(m).concat(Object.getOwnPropertySymbols(m))}:Object.getOwnPropertyNames,K=Object.getOwnPropertyDescriptors||function(m){var R={};return Y(m).forEach(function(C){R[C]=Object.getOwnPropertyDescriptor(m,C)}),R},J={},X={get:function(m,R){if(R===W)return m;var C,T,L=p(m);if(!u(L,R))return(T=I(L,R))?"value"in T?T.value:null===(C=T.get)||void 0===C?void 0:C.call(m.k):void 0;var U=L[R];return m.I||!t(U)?U:U===z(m.t,R)?(E(m),m.o[R]=N(m.A.h,U,m)):U},has:function(m,R){return R in p(m)},ownKeys:function(m){return Reflect.ownKeys(p(m))},set:function(m,R,C){var T=I(p(m),R);if(null==T?void 0:T.set)return T.set.call(m.k,C),!0;if(!m.P){var L=z(p(m),R),U=null==L?void 0:L[W];if(U&&U.t===C)return m.o[R]=C,m.R[R]=!1,!0;if(c(C,L)&&(void 0!==C||u(m.t,R)))return!0;E(m),k(m)}return m.o[R]===C&&(void 0!==C||R in m.o)||Number.isNaN(C)&&Number.isNaN(m.o[R])||(m.o[R]=C,m.R[R]=!0),!0},deleteProperty:function(m,R){return void 0!==z(m.t,R)||R in m.t?(m.R[R]=!1,E(m),k(m)):delete m.R[R],m.o&&delete m.o[R],!0},getOwnPropertyDescriptor:function(m,R){var C=p(m),T=Reflect.getOwnPropertyDescriptor(C,R);return T?{writable:!0,configurable:1!==m.i||"length"!==R,enumerable:T.enumerable,value:C[R]}:T},defineProperty:function(){n(11)},getPrototypeOf:function(m){return Object.getPrototypeOf(m.t)},setPrototypeOf:function(){n(12)}},Q={};i(X,function(m,R){Q[m]=function(){return arguments[0]=arguments[0][0],R.apply(this,arguments)}}),Q.deleteProperty=function(m,R){return Q.set.call(this,m,R,void 0)},Q.set=function(m,R,C){return X.set.call(this,m[0],R,C,m[0])};var ee=new(function(){function e(m){var R=this;this.O=H,this.D=!0,this.produce=function(m,C,T){if("function"==typeof m&&"function"!=typeof C){var L,U=C;return C=m,function(m){var T=this;void 0===m&&(m=U);for(var L=arguments.length,$=Array(L>1?L-1:0),B=1;B1?T-1:0),U=1;U=0;C--){var C,T=R[C];if(0===T.path.length&&"replace"===T.op){m=T.value;break}}C>-1&&(R=R.slice(C+1));var L=b("Patches").$;return r(m)?L(m,R):this.produce(m,function(m){return L(m,R)})},e}()),et=ee.produce;ee.produceWithPatches.bind(ee),ee.setAutoFreeze.bind(ee),ee.setUseProxies.bind(ee),ee.applyPatches.bind(ee),ee.createDraft.bind(ee),ee.finishDraft.bind(ee);var er=C(4942);function ownKeys(m,R){var C=Object.keys(m);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(m);R&&(T=T.filter(function(R){return Object.getOwnPropertyDescriptor(m,R).enumerable})),C.push.apply(C,T)}return C}function _objectSpread2(m){for(var R=1;R0&&L[L.length-1])&&(6===U[0]||2===U[0])){$=0;continue}if(3===U[0]&&(!L||U[1]>L[0]&&U[1]=0;R--){var C=m[R][W];if(!C.P)switch(C.i){case 5:a(C)&&k(C);break;case 4:o(C)&&k(C)}}}function o(m){for(var R=m.t,C=m.k,T=Y(C),L=T.length-1;L>=0;L--){var U=T[L];if(U!==W){var $=R[U];if(void 0===$&&!u(R,U))return!0;var B=C[U],V=B&&B[W];if(V?V.t!==$:!c(B,$))return!0}}var H=!!R[W];return T.length!==Y(R).length+(H?0:1)}function a(m){var R=m.k;if(R.length!==m.t.length)return!0;var C=Object.getOwnPropertyDescriptor(R,R.length-1);if(C&&!C.get)return!0;for(var T=0;Tthis.token=m)}get hasToken(){return!!this.token}login(m={}){return B(this,void 0,void 0,function*(){let R=Object.assign({},m);this.hasToken&&(R.token=this.token);let C=yield this.request("post","/auth",R);for(let m in this.token=C.token,(0,H.setItem)(G,this.token),C)this.hasOwnProperty(m)&&(this[m]=C[m]);return this.registerPingService(),this})}save(){return B(this,void 0,void 0,function*(){return yield this.request("put","/auth",{},{username:this.username,displayName:this.displayName,avatarUrl:this.avatarUrl,lang:this.lang,location:this.location,timezone:this.timezone}),this})}getFriends(){return B(this,void 0,void 0,function*(){return yield this.request("get","/friends/all")})}getOnlineFriends(){return B(this,void 0,void 0,function*(){return yield this.request("get","/friends/online")})}getFriendRequests(){return B(this,void 0,void 0,function*(){return yield this.request("get","/friends/requests")})}sendFriendRequest(m){return B(this,void 0,void 0,function*(){return yield this.request("post","/friends/requests",{userId:m})})}acceptFriendRequest(m){return B(this,void 0,void 0,function*(){return yield this.request("put","/friends/requests",{userId:m})})}declineFriendRequest(m){return B(this,void 0,void 0,function*(){return yield this.request("del","/friends/requests",{userId:m})})}blockUser(m){return B(this,void 0,void 0,function*(){return yield this.request("post","/friends/block",{userId:m})})}unblockUser(m){return B(this,void 0,void 0,function*(){return yield this.request("put","/friends/block",{userId:m})})}request(m,R,C={},T,L={}){return B(this,void 0,void 0,function*(){L.Accept="application/json",this.hasToken&&(L.Authorization="Bearer "+this.token);let U=[];for(let m in C)U.push(`${m}=${C[m]}`);let $=U.length>0?`?${U.join("&")}`:"",B={headers:L};return T&&(B.body=T),(yield V[m](`${this.endpoint}${R}${$}`,B)).data})}logout(){this.token=void 0,(0,H.removeItem)(G),this.unregisterPingService()}registerPingService(m=15e3){this.unregisterPingService(),this.keepOnlineInterval=setInterval(()=>this.request("get","/auth"),m)}unregisterPingService(){clearInterval(this.keepOnlineInterval)}}},4705:function(m,R,C){"use strict";var T,L=this&&this.__awaiter||function(m,R,C,T){return new(C||(C=Promise))(function(L,U){function fulfilled(m){try{step(T.next(m))}catch(m){U(m)}}function rejected(m){try{step(T.throw(m))}catch(m){U(m)}}function step(m){var R;m.done?L(m.value):((R=m.value)instanceof C?R:new C(function(m){m(R)})).then(fulfilled,rejected)}step((T=T.apply(m,R||[])).next())})};Object.defineProperty(R,"__esModule",{value:!0}),R.Client=R.MatchMakeError=void 0;let U=C(76629),$=C(65199),B=C(68270);let MatchMakeError=class MatchMakeError extends Error{constructor(m,R){super(m),this.code=R,Object.setPrototypeOf(this,MatchMakeError.prototype)}};R.MatchMakeError=MatchMakeError;let V="undefined"!=typeof window&&void 0!==(null===(T=null==window?void 0:window.location)||void 0===T?void 0:T.hostname)?`${window.location.protocol.replace("http","ws")}//${window.location.hostname}${window.location.port&&`:${window.location.port}`}`:"ws://127.0.0.1:2567";R.Client=class{constructor(m=V){if("string"==typeof m){let R=new URL(m),C="https:"===R.protocol||"wss:"===R.protocol,T=Number(R.port||(C?443:80));this.settings={hostname:R.hostname,pathname:"/"!==R.pathname?R.pathname:"",port:T,secure:C}}else void 0===m.port&&(m.port=m.secure?443:80),void 0===m.pathname&&(m.pathname=""),this.settings=m}joinOrCreate(m,R={},C){return L(this,void 0,void 0,function*(){return yield this.createMatchMakeRequest("joinOrCreate",m,R,C)})}create(m,R={},C){return L(this,void 0,void 0,function*(){return yield this.createMatchMakeRequest("create",m,R,C)})}join(m,R={},C){return L(this,void 0,void 0,function*(){return yield this.createMatchMakeRequest("join",m,R,C)})}joinById(m,R={},C){return L(this,void 0,void 0,function*(){return yield this.createMatchMakeRequest("joinById",m,R,C)})}reconnect(m,R){return L(this,void 0,void 0,function*(){if("string"==typeof m&&"string"==typeof R)throw Error("DEPRECATED: .reconnect() now only accepts 'reconnectionToken' as argument.\nYou can get this token from previously connected `room.reconnectionToken`");let[C,T]=m.split(":");return yield this.createMatchMakeRequest("reconnect",C,{reconnectionToken:T},R)})}getAvailableRooms(m=""){return L(this,void 0,void 0,function*(){return(yield(0,U.get)(this.getHttpEndpoint(`${m}`),{headers:{Accept:"application/json"}})).data})}consumeSeatReservation(m,R,C){return L(this,void 0,void 0,function*(){let T=this.createRoom(m.room.name,R);T.roomId=m.room.roomId,T.sessionId=m.sessionId;let U={sessionId:T.sessionId};m.reconnectionToken&&(U.reconnectionToken=m.reconnectionToken);let B=C||T;return T.connect(this.buildEndpoint(m.room,U),m.devMode&&(()=>L(this,void 0,void 0,function*(){console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} Re-establishing connection with room id '${T.roomId}'...`);let C=0,retryReconnection=()=>L(this,void 0,void 0,function*(){C++;try{yield this.consumeSeatReservation(m,R,B),console.info(`[Colyseus devMode]: ${String.fromCodePoint(9989)} Successfully re-established connection with room '${T.roomId}'`)}catch(m){C<8?(console.info(`[Colyseus devMode]: ${String.fromCodePoint(128260)} retrying... (${C} out of 8)`),setTimeout(retryReconnection,2e3)):console.info(`[Colyseus devMode]: ${String.fromCodePoint(10060)} Failed to reconnect. Is your server running? Please check server logs.`)}});setTimeout(retryReconnection,2e3)})),B),new Promise((m,R)=>{let onError=(m,C)=>R(new $.ServerError(m,C));B.onError.once(onError),B.onJoin.once(()=>{B.onError.remove(onError),m(B)})})})}createMatchMakeRequest(m,R,C={},T,$){return L(this,void 0,void 0,function*(){let L=(yield(0,U.post)(this.getHttpEndpoint(`${m}/${R}`),{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(C)})).data;if(L.error)throw new MatchMakeError(L.error,L.code);return"reconnect"===m&&(L.reconnectionToken=C.reconnectionToken),yield this.consumeSeatReservation(L,T,$)})}createRoom(m,R){return new B.Room(m,R)}buildEndpoint(m,R={}){let C=[];for(let m in R)R.hasOwnProperty(m)&&C.push(`${m}=${R[m]}`);let T=this.settings.secure?"wss://":"ws://";return m.publicAddress?T+=`${m.publicAddress}`:T+=`${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}`,`${T}/${m.processId}/${m.roomId}?${C.join("&")}`}getHttpEndpoint(m=""){return`${this.settings.secure?"https":"http"}://${this.settings.hostname}${this.getEndpointPort()}${this.settings.pathname}/matchmake/${m}`}getEndpointPort(){return 80!==this.settings.port&&443!==this.settings.port?`:${this.settings.port}`:""}}},22826:function(m,R,C){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.Connection=void 0;let T=C(14956);R.Connection=class{constructor(){this.events={},this.transport=new T.WebSocketTransport(this.events)}send(m){this.transport.send(m)}connect(m){this.transport.connect(m)}close(m,R){this.transport.close(m,R)}get isOpen(){return this.transport.isOpen}}},60845:function(m,R){"use strict";var C,T;Object.defineProperty(R,"__esModule",{value:!0}),R.utf8Length=R.utf8Read=R.ErrorCode=R.Protocol=void 0,(C=R.Protocol||(R.Protocol={}))[C.HANDSHAKE=9]="HANDSHAKE",C[C.JOIN_ROOM=10]="JOIN_ROOM",C[C.ERROR=11]="ERROR",C[C.LEAVE_ROOM=12]="LEAVE_ROOM",C[C.ROOM_DATA=13]="ROOM_DATA",C[C.ROOM_STATE=14]="ROOM_STATE",C[C.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",C[C.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA",C[C.ROOM_DATA_BYTES=17]="ROOM_DATA_BYTES",(T=R.ErrorCode||(R.ErrorCode={}))[T.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",T[T.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",T[T.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",T[T.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",T[T.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",T[T.AUTH_FAILED=4215]="AUTH_FAILED",T[T.APPLICATION_ERROR=4216]="APPLICATION_ERROR",R.utf8Read=function(m,R){let C=m[R++];for(var T="",L=0,U=R,$=R+C;U<$;U++){var B=m[U];if((128&B)==0){T+=String.fromCharCode(B);continue}if((224&B)==192){T+=String.fromCharCode((31&B)<<6|63&m[++U]);continue}if((240&B)==224){T+=String.fromCharCode((15&B)<<12|(63&m[++U])<<6|(63&m[++U])<<0);continue}if((248&B)==240){(L=(7&B)<<18|(63&m[++U])<<12|(63&m[++U])<<6|(63&m[++U])<<0)>=65536?(L-=65536,T+=String.fromCharCode((L>>>10)+55296,(1023&L)+56320)):T+=String.fromCharCode(L);continue}throw Error("Invalid byte "+B.toString(16))}return T},R.utf8Length=function(m=""){let R=0,C=0;for(let T=0,L=m.length;T=57344?C+=3:(T++,C+=4);return C+1}},68270:function(m,R,C){"use strict";var T=this&&this.__createBinding||(Object.create?function(m,R,C,T){void 0===T&&(T=C);var L=Object.getOwnPropertyDescriptor(R,C);(!L||("get"in L?!R.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return R[C]}}),Object.defineProperty(m,T,L)}:function(m,R,C,T){void 0===T&&(T=C),m[T]=R[C]}),L=this&&this.__setModuleDefault||(Object.create?function(m,R){Object.defineProperty(m,"default",{enumerable:!0,value:R})}:function(m,R){m.default=R}),U=this&&this.__importStar||function(m){if(m&&m.__esModule)return m;var R={};if(null!=m)for(var C in m)"default"!==C&&Object.prototype.hasOwnProperty.call(m,C)&&T(R,m,C);return L(R,m),R};Object.defineProperty(R,"__esModule",{value:!0}),R.Room=void 0;let $=U(C(59572)),B=C(22826),V=C(60845),H=C(70944),G=C(58295),q=C(16976),W=C(41396),Z=C(65199);let Room=class Room{constructor(m,R){this.onStateChange=(0,q.createSignal)(),this.onError=(0,q.createSignal)(),this.onLeave=(0,q.createSignal)(),this.onJoin=(0,q.createSignal)(),this.hasJoined=!1,this.onMessageHandlers=(0,G.createNanoEvents)(),this.roomId=null,this.name=m,R&&(this.serializer=new((0,H.getSerializer)("schema")),this.rootSchema=R,this.serializer.state=new R),this.onError((m,R)=>{var C;return null===(C=console.warn)||void 0===C?void 0:C.call(console,`colyseus.js - onError => (${m}) ${R}`)}),this.onLeave(()=>this.removeAllListeners())}get id(){return this.roomId}connect(m,R,C=this){let T=new B.Connection;C.connection=T,T.events.onmessage=Room.prototype.onMessageCallback.bind(C),T.events.onclose=function(m){var T;if(!C.hasJoined){null===(T=console.warn)||void 0===T||T.call(console,`Room connection was closed unexpectedly (${m.code}): ${m.reason}`),C.onError.invoke(m.code,m.reason);return}m.code===Z.CloseCode.DEVMODE_RESTART&&R?R():(C.onLeave.invoke(m.code),C.destroy())},T.events.onerror=function(m){var R;null===(R=console.warn)||void 0===R||R.call(console,`Room, onError (${m.code}): ${m.reason}`),C.onError.invoke(m.code,m.reason)},T.connect(m)}leave(m=!0){return new Promise(R=>{this.onLeave(m=>R(m)),this.connection?m?this.connection.send([V.Protocol.LEAVE_ROOM]):this.connection.close():this.onLeave.invoke(Z.CloseCode.CONSENTED)})}onMessage(m,R){return this.onMessageHandlers.on(this.getMessageHandlerKey(m),R)}send(m,R){let C;let T=[V.Protocol.ROOM_DATA];if("string"==typeof m?W.encode.string(T,m):W.encode.number(T,m),void 0!==R){let m=$.encode(R);(C=new Uint8Array(T.length+m.byteLength)).set(new Uint8Array(T),0),C.set(new Uint8Array(m),T.length)}else C=new Uint8Array(T);this.connection.send(C.buffer)}sendBytes(m,R){let C;let T=[V.Protocol.ROOM_DATA_BYTES];"string"==typeof m?W.encode.string(T,m):W.encode.number(T,m),(C=new Uint8Array(T.length+(R.byteLength||R.length))).set(new Uint8Array(T),0),C.set(new Uint8Array(R),T.length),this.connection.send(C.buffer)}get state(){return this.serializer.getState()}removeAllListeners(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={}}onMessageCallback(m){let R=Array.from(new Uint8Array(m.data)),C=R[0];if(C===V.Protocol.JOIN_ROOM){let m=1,C=(0,V.utf8Read)(R,m);if(m+=(0,V.utf8Length)(C),this.serializerId=(0,V.utf8Read)(R,m),m+=(0,V.utf8Length)(this.serializerId),!this.serializer){let m=(0,H.getSerializer)(this.serializerId);this.serializer=new m}R.length>m&&this.serializer.handshake&&this.serializer.handshake(R,{offset:m}),this.reconnectionToken=`${this.roomId}:${C}`,this.hasJoined=!0,this.onJoin.invoke(),this.connection.send([V.Protocol.JOIN_ROOM])}else if(C===V.Protocol.ERROR){let m={offset:1},C=W.decode.number(R,m),T=W.decode.string(R,m);this.onError.invoke(C,T)}else if(C===V.Protocol.LEAVE_ROOM)this.leave();else if(C===V.Protocol.ROOM_DATA_SCHEMA){let m={offset:1},C=this.serializer.getState().constructor._context,T=C.get(W.decode.number(R,m)),L=new T;L.decode(R,m),this.dispatchMessage(T,L)}else if(C===V.Protocol.ROOM_STATE)R.shift(),this.setState(R);else if(C===V.Protocol.ROOM_STATE_PATCH)R.shift(),this.patch(R);else if(C===V.Protocol.ROOM_DATA){let C={offset:1},T=W.decode.stringCheck(R,C)?W.decode.string(R,C):W.decode.number(R,C),L=R.length>C.offset?$.decode(m.data,C.offset):void 0;this.dispatchMessage(T,L)}else if(C===V.Protocol.ROOM_DATA_BYTES){let m={offset:1},C=W.decode.stringCheck(R,m)?W.decode.string(R,m):W.decode.number(R,m);this.dispatchMessage(C,new Uint8Array(R.slice(m.offset)))}}setState(m){this.serializer.setState(m),this.onStateChange.invoke(this.serializer.getState())}patch(m){this.serializer.patch(m),this.onStateChange.invoke(this.serializer.getState())}dispatchMessage(m,R){var C;let T=this.getMessageHandlerKey(m);this.onMessageHandlers.events[T]?this.onMessageHandlers.emit(T,R):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",m,R):null===(C=console.warn)||void 0===C||C.call(console,`colyseus.js: onMessage() not registered for type '${m}'.`)}destroy(){this.serializer&&this.serializer.teardown()}getMessageHandlerKey(m){switch(typeof m){case"function":return`$${m._typeid}`;case"string":return m;case"number":return`i${m}`;default:throw Error("invalid message type.")}}};R.Room=Room},47723:function(m,R){"use strict";let C;function getStorage(){return C||(C="undefined"!=typeof cc&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:"undefined"!=typeof window&&window.localStorage?window.localStorage:{cache:{},setItem:function(m,R){this.cache[m]=R},getItem:function(m){this.cache[m]},removeItem:function(m){delete this.cache[m]}}),C}Object.defineProperty(R,"__esModule",{value:!0}),R.getItem=R.removeItem=R.setItem=void 0,R.setItem=function(m,R){getStorage().setItem(m,R)},R.removeItem=function(m){getStorage().removeItem(m)},R.getItem=function(m,R){let C=getStorage().getItem(m);"undefined"!=typeof Promise&&C instanceof Promise?C.then(m=>R(m)):R(C)}},58295:function(m,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.createNanoEvents=void 0,R.createNanoEvents=()=>({emit(m,...R){let C=this.events[m]||[];for(let m=0,T=C.length;m{var C;this.events[m]=null===(C=this.events[m])||void 0===C?void 0:C.filter(m=>R!==m)}}})},16976:function(m,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.createSignal=R.EventEmitter=void 0;let EventEmitter=class EventEmitter{constructor(){this.handlers=[]}register(m,R=!1){return this.handlers.push(m),this}invoke(...m){this.handlers.forEach(R=>R.apply(this,m))}invokeAsync(...m){return Promise.all(this.handlers.map(R=>R.apply(this,m)))}remove(m){let R=this.handlers.indexOf(m);this.handlers[R]=this.handlers[this.handlers.length-1],this.handlers.pop()}clear(){this.handlers=[]}};R.EventEmitter=EventEmitter,R.createSignal=function(){let m=new EventEmitter;function register(R){return m.register(R,this===null)}return register.once=R=>{let callback=function(...C){R.apply(this,C),m.remove(callback)};m.register(callback)},register.remove=R=>m.remove(R),register.invoke=(...R)=>m.invoke(...R),register.invokeAsync=(...R)=>m.invokeAsync(...R),register.clear=()=>m.clear(),register}},65199:function(m,R){"use strict";var C;Object.defineProperty(R,"__esModule",{value:!0}),R.ServerError=R.CloseCode=void 0,(C=R.CloseCode||(R.CloseCode={}))[C.CONSENTED=4e3]="CONSENTED",C[C.DEVMODE_RESTART=4010]="DEVMODE_RESTART",R.ServerError=class extends Error{constructor(m,R){super(R),this.name="ServerError",this.code=m}}},7767:function(m,R,C){"use strict";R.mV=R.KU=void 0,C(21331);var T=C(4705);Object.defineProperty(R,"KU",{enumerable:!0,get:function(){return T.Client}}),C(60845),C(68270),C(84063);let L=C(44066);Object.defineProperty(R,"mV",{enumerable:!0,get:function(){return L.SchemaSerializer}});let U=C(34197),$=C(70944);(0,$.registerSerializer)("schema",L.SchemaSerializer),(0,$.registerSerializer)("none",U.NoneSerializer)},21331:function(){ArrayBuffer.isView||(ArrayBuffer.isView=m=>null!==m&&"object"==typeof m&&m.buffer instanceof ArrayBuffer),"undefined"==typeof globalThis&&"undefined"!=typeof window&&(window.globalThis=window)},59572:function(m,R){"use strict";function Decoder(m,R){if(this._offset=R,m instanceof ArrayBuffer)this._buffer=m,this._view=new DataView(this._buffer);else if(ArrayBuffer.isView(m))this._buffer=m.buffer,this._view=new DataView(this._buffer,m.byteOffset,m.byteLength);else throw Error("Invalid argument")}Object.defineProperty(R,"__esModule",{value:!0}),R.decode=R.encode=void 0,Decoder.prototype._array=function(m){for(var R=Array(m),C=0;C=65536?(L-=65536,T+=String.fromCharCode((L>>>10)+55296,(1023&L)+56320)):T+=String.fromCharCode(L);continue}throw Error("Invalid byte "+B.toString(16))}return T}(this._view,this._offset,m);return this._offset+=m,R},Decoder.prototype._bin=function(m){var R=this._buffer.slice(this._offset,this._offset+m);return this._offset+=m,R},Decoder.prototype._parse=function(){var m,R=this._view.getUint8(this._offset++),C=0,T=0,L=0,U=0;if(R<192)return R<128?R:R<144?this._map(15&R):R<160?this._array(15&R):this._str(31&R);if(R>223)return-((255-R+1)*1);switch(R){case 192:return null;case 194:return!1;case 195:return!0;case 196:return C=this._view.getUint8(this._offset),this._offset+=1,this._bin(C);case 197:return C=this._view.getUint16(this._offset),this._offset+=2,this._bin(C);case 198:return C=this._view.getUint32(this._offset),this._offset+=4,this._bin(C);case 199:if(C=this._view.getUint8(this._offset),T=this._view.getInt8(this._offset+1),this._offset+=2,-1===T){var $=this._view.getUint32(this._offset);return L=this._view.getInt32(this._offset+4),U=this._view.getUint32(this._offset+8),this._offset+=12,new Date((4294967296*L+U)*1e3+$/1e6)}return[T,this._bin(C)];case 200:return C=this._view.getUint16(this._offset),T=this._view.getInt8(this._offset+2),this._offset+=3,[T,this._bin(C)];case 201:return C=this._view.getUint32(this._offset),T=this._view.getInt8(this._offset+4),this._offset+=5,[T,this._bin(C)];case 202:return m=this._view.getFloat32(this._offset),this._offset+=4,m;case 203:return m=this._view.getFloat64(this._offset),this._offset+=8,m;case 204:return m=this._view.getUint8(this._offset),this._offset+=1,m;case 205:return m=this._view.getUint16(this._offset),this._offset+=2,m;case 206:return m=this._view.getUint32(this._offset),this._offset+=4,m;case 207:return L=4294967296*this._view.getUint32(this._offset),U=this._view.getUint32(this._offset+4),this._offset+=8,L+U;case 208:return m=this._view.getInt8(this._offset),this._offset+=1,m;case 209:return m=this._view.getInt16(this._offset),this._offset+=2,m;case 210:return m=this._view.getInt32(this._offset),this._offset+=4,m;case 211:return L=4294967296*this._view.getInt32(this._offset),U=this._view.getUint32(this._offset+4),this._offset+=8,L+U;case 212:if(T=this._view.getInt8(this._offset),this._offset+=1,0===T){this._offset+=1;return}return[T,this._bin(1)];case 213:return T=this._view.getInt8(this._offset),this._offset+=1,[T,this._bin(2)];case 214:if(T=this._view.getInt8(this._offset),this._offset+=1,-1===T)return m=this._view.getUint32(this._offset),this._offset+=4,new Date(1e3*m);return[T,this._bin(4)];case 215:if(T=this._view.getInt8(this._offset),this._offset+=1,0===T)return L=4294967296*this._view.getInt32(this._offset),U=this._view.getUint32(this._offset+4),this._offset+=8,new Date(L+U);if(-1===T){L=this._view.getUint32(this._offset),U=this._view.getUint32(this._offset+4),this._offset+=8;var B=(3&L)*4294967296+U;return new Date(1e3*B+(L>>>2)/1e6)}return[T,this._bin(8)];case 216:return T=this._view.getInt8(this._offset),this._offset+=1,[T,this._bin(16)];case 217:return C=this._view.getUint8(this._offset),this._offset+=1,this._str(C);case 218:return C=this._view.getUint16(this._offset),this._offset+=2,this._str(C);case 219:return C=this._view.getUint32(this._offset),this._offset+=4,this._str(C);case 220:return C=this._view.getUint16(this._offset),this._offset+=2,this._array(C);case 221:return C=this._view.getUint32(this._offset),this._offset+=4,this._array(C);case 222:return C=this._view.getUint16(this._offset),this._offset+=2,this._map(C);case 223:return C=this._view.getUint32(this._offset),this._offset+=4,this._map(C)}throw Error("Could not parse")},R.decode=function(m,R=0){var C=new Decoder(m,R),T=C._parse();if(C._offset!==m.byteLength)throw Error(m.byteLength-C._offset+" trailing bytes");return T},R.encode=function(m){var R=[],C=[],T=function _encode(m,R,C){var T=typeof C,L=0,U=0,$=0,B=0,V=0,H=0;if("string"===T){if((V=function(m){for(var R=0,C=0,T=0,L=m.length;T=57344?C+=3:(T++,C+=4);return C}(C))<32)m.push(160|V),H=1;else if(V<256)m.push(217,V),H=2;else if(V<65536)m.push(218,V>>8,V),H=3;else if(V<4294967296)m.push(219,V>>24,V>>16,V>>8,V),H=5;else throw Error("String too long");return R.push({_str:C,_length:V,_offset:m.length}),H+V}if("number"===T)return Math.floor(C)===C&&isFinite(C)?C>=0?C<128?(m.push(C),1):C<256?(m.push(204,C),2):C<65536?(m.push(205,C>>8,C),3):C<4294967296?(m.push(206,C>>24,C>>16,C>>8,C),5):($=C/4294967296>>0,B=C>>>0,m.push(207,$>>24,$>>16,$>>8,$,B>>24,B>>16,B>>8,B),9):C>=-32?(m.push(C),1):C>=-128?(m.push(208,C),2):C>=-32768?(m.push(209,C>>8,C),3):C>=-2147483648?(m.push(210,C>>24,C>>16,C>>8,C),5):($=Math.floor(C/4294967296),B=C>>>0,m.push(211,$>>24,$>>16,$>>8,$,B>>24,B>>16,B>>8,B),9):(m.push(203),R.push({_float:C,_length:8,_offset:m.length}),9);if("object"===T){if(null===C)return m.push(192),1;if(Array.isArray(C)){if((V=C.length)<16)m.push(144|V),H=1;else if(V<65536)m.push(220,V>>8,V),H=3;else if(V<4294967296)m.push(221,V>>24,V>>16,V>>8,V),H=5;else throw Error("Array too large");for(L=0;L=0&&W>=0&&q<=17179869183?0===W&&q<=4294967295?(m.push(214,255,q>>24,q>>16,q>>8,q),6):($=q/4294967296,B=4294967295&q,m.push(215,255,W>>22,W>>14,W>>6,$,B>>24,B>>16,B>>8,B),10):($=Math.floor(q/4294967296),B=q>>>0,m.push(199,12,255,W>>24,W>>16,W>>8,W,$>>24,$>>16,$>>8,$,B>>24,B>>16,B>>8,B),15)}if(C instanceof ArrayBuffer){if((V=C.byteLength)<256)m.push(196,V),H=2;else if(V<65536)m.push(197,V>>8,V),H=3;else if(V<4294967296)m.push(198,V>>24,V>>16,V>>8,V),H=5;else throw Error("Buffer too large");return R.push({_bin:C,_length:V,_offset:m.length}),H+V}if("function"==typeof C.toJSON)return _encode(m,R,C.toJSON());var Z=[],Y="",K=Object.keys(C);for(L=0,U=K.length;L>8,V),H=3;else if(V<4294967296)m.push(223,V>>24,V>>16,V>>8,V),H=5;else throw Error("Object too large");for(L=0;L0&&(V=C[0]._offset);for(var H,G=0,q=0,W=0,Z=R.length;W>6):(T<55296||T>=57344?m.setUint8(R++,224|T>>12):(L++,T=65536+((1023&T)<<10|1023&C.charCodeAt(L)),m.setUint8(R++,240|T>>18),m.setUint8(R++,128|T>>12&63)),m.setUint8(R++,128|T>>6&63)),m.setUint8(R++,128|63&T))}(U,q,H._str):void 0!==H._float&&U.setFloat64(q,H._float);$++,B+=G,C[$]&&(V=C[$]._offset)}return L}},34197:function(m,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.NoneSerializer=void 0,R.NoneSerializer=class{setState(m){}getState(){return null}patch(m){}teardown(){}handshake(m){}}},44066:function(m,R,C){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.SchemaSerializer=void 0;let T=C(41396);R.SchemaSerializer=class{setState(m){return this.state.decode(m)}getState(){return this.state}patch(m){return this.state.decode(m)}teardown(){var m,R;null===(R=null===(m=this.state)||void 0===m?void 0:m.$changes)||void 0===R||R.root.clearRefs()}handshake(m,R){if(this.state){let C=new T.Reflection;C.decode(m,R)}else this.state=T.Reflection.decode(m,R)}}},70944:function(m,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.getSerializer=R.registerSerializer=void 0;let C={};R.registerSerializer=function(m,R){C[m]=R},R.getSerializer=function(m){let R=C[m];if(!R)throw Error("missing serializer: "+m);return R}},14956:function(m,R,C){"use strict";var T=this&&this.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(R,"__esModule",{value:!0}),R.WebSocketTransport=void 0;let L=T(C(46579)),U=globalThis.WebSocket||L.default;R.WebSocketTransport=class{constructor(m){this.events=m}send(m){m instanceof ArrayBuffer?this.ws.send(m):Array.isArray(m)&&this.ws.send(new Uint8Array(m).buffer)}connect(m){this.ws=new U(m,this.protocols),this.ws.binaryType="arraybuffer",this.ws.onopen=this.events.onopen,this.ws.onmessage=this.events.onmessage,this.ws.onclose=this.events.onclose,this.ws.onerror=this.events.onerror}close(m,R){this.ws.close(m,R)}get isOpen(){return this.ws.readyState===U.OPEN}}},46579:function(m){"use strict";m.exports=function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},8679:function(m,R,C){"use strict";var T=C(21296),L={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},U={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},$={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},B={};function getStatics(m){return T.isMemo(m)?$:B[m.$$typeof]||L}B[T.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},B[T.Memo]=$;var V=Object.defineProperty,H=Object.getOwnPropertyNames,G=Object.getOwnPropertySymbols,q=Object.getOwnPropertyDescriptor,W=Object.getPrototypeOf,Z=Object.prototype;m.exports=function hoistNonReactStatics(m,R,C){if("string"!=typeof R){if(Z){var T=W(R);T&&T!==Z&&hoistNonReactStatics(m,T,C)}var L=H(R);G&&(L=L.concat(G(R)));for(var $=getStatics(m),B=getStatics(R),Y=0;Y-1};function normalizeName(m){if("string"!=typeof m&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw TypeError("Invalid character in header field name");return m.toLowerCase()}function normalizeValue(m){return"string"!=typeof m&&(m=String(m)),m}function iteratorFor(m){var C={next:function(){var R=m.shift();return{done:void 0===R,value:R}}};return R.iterable&&(C[Symbol.iterator]=function(){return C}),C}function Headers(m){this.map={},m instanceof Headers?m.forEach(function(m,R){this.append(R,m)},this):Array.isArray(m)?m.forEach(function(m){this.append(m[0],m[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(R){this.append(R,m[R])},this)}function consumed(m){if(m.bodyUsed)return Promise.reject(TypeError("Already read"));m.bodyUsed=!0}function fileReaderReady(m){return new Promise(function(R,C){m.onload=function(){R(m.result)},m.onerror=function(){C(m.error)}})}function readBlobAsArrayBuffer(m){var R=new FileReader,C=fileReaderReady(R);return R.readAsArrayBuffer(m),C}function bufferClone(m){if(m.slice)return m.slice(0);var R=new Uint8Array(m.byteLength);return R.set(new Uint8Array(m)),R.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(m){if(this._bodyInit=m,m){if("string"==typeof m)this._bodyText=m;else if(R.blob&&Blob.prototype.isPrototypeOf(m))this._bodyBlob=m;else if(R.formData&&FormData.prototype.isPrototypeOf(m))this._bodyFormData=m;else if(R.searchParams&&URLSearchParams.prototype.isPrototypeOf(m))this._bodyText=m.toString();else{var C;R.arrayBuffer&&R.blob&&(C=m)&&DataView.prototype.isPrototypeOf(C)?(this._bodyArrayBuffer=bufferClone(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):R.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||L(m))?this._bodyArrayBuffer=bufferClone(m):this._bodyText=m=Object.prototype.toString.call(m)}}else this._bodyText="";!this.headers.get("content-type")&&("string"==typeof m?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):R.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},R.blob&&(this.blob=function(){var m=consumed(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(!this._bodyFormData)return Promise.resolve(new Blob([this._bodyText]));throw Error("could not read FormData body as blob")},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var m,R,C,T=consumed(this);if(T)return T;if(this._bodyBlob)return m=this._bodyBlob,C=fileReaderReady(R=new FileReader),R.readAsText(m),C;if(this._bodyArrayBuffer)return Promise.resolve(function(m){for(var R=new Uint8Array(m),C=Array(R.length),T=0;T-1?T:C),this.mode=R.mode||this.mode||null,this.signal=R.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&L)throw TypeError("Body not allowed for GET or HEAD requests");this._initBody(L)}function decode(m){var R=new FormData;return m.trim().split("&").forEach(function(m){if(m){var C=m.split("="),T=C.shift().replace(/\+/g," "),L=C.join("=").replace(/\+/g," ");R.append(decodeURIComponent(T),decodeURIComponent(L))}}),R}function Response(m,R){R||(R={}),this.type="default",this.status=void 0===R.status?200:R.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in R?R.statusText:"OK",this.headers=new Headers(R.headers),this.url=R.url||"",this._initBody(m)}Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var m=new Response(null,{status:0,statusText:""});return m.type="error",m};var $=[301,302,303,307,308];Response.redirect=function(m,R){if(-1===$.indexOf(R))throw RangeError("Invalid status code");return new Response(null,{status:R,headers:{location:m}})},m.DOMException=T.DOMException;try{new m.DOMException}catch(R){m.DOMException=function(m,R){this.message=m,this.name=R;var C=Error(m);this.stack=C.stack},m.DOMException.prototype=Object.create(Error.prototype),m.DOMException.prototype.constructor=m.DOMException}function fetch(C,T){return new Promise(function(L,U){var $=new Request(C,T);if($.signal&&$.signal.aborted)return U(new m.DOMException("Aborted","AbortError"));var B=new XMLHttpRequest;function abortXhr(){B.abort()}B.onload=function(){var m,R,C={status:B.status,statusText:B.statusText,headers:(m=B.getAllResponseHeaders()||"",R=new Headers,m.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(m){var C=m.split(":"),T=C.shift().trim();if(T){var L=C.join(":").trim();R.append(T,L)}}),R)};C.url="responseURL"in B?B.responseURL:C.headers.get("X-Request-URL");var T="response"in B?B.response:B.responseText;L(new Response(T,C))},B.onerror=function(){U(TypeError("Network request failed"))},B.ontimeout=function(){U(TypeError("Network request failed"))},B.onabort=function(){U(new m.DOMException("Aborted","AbortError"))},B.open($.method,$.url,!0),"include"===$.credentials?B.withCredentials=!0:"omit"===$.credentials&&(B.withCredentials=!1),"responseType"in B&&R.blob&&(B.responseType="blob"),$.headers.forEach(function(m,R){B.setRequestHeader(R,m)}),$.signal&&($.signal.addEventListener("abort",abortXhr),B.onreadystatechange=function(){4===B.readyState&&$.signal.removeEventListener("abort",abortXhr)}),B.send(void 0===$._bodyInit?null:$._bodyInit)})}fetch.polyfill=!0,T.fetch||(T.fetch=fetch,T.Headers=Headers,T.Request=Request,T.Response=Response),m.Headers=Headers,m.Request=Request,m.Response=Response,m.fetch=fetch,Object.defineProperty(m,"__esModule",{value:!0})})({}),T.fetch.ponyfill=!0,delete T.fetch.polyfill,(R=T.fetch).default=T.fetch,R.fetch=T.fetch,R.Headers=T.Headers,R.Request=T.Request,R.Response=T.Response,m.exports=R},18552:function(m,R,C){var T=C(10852)(C(55639),"DataView");m.exports=T},1989:function(m,R,C){var T=C(51789),L=C(80401),U=C(57667),$=C(21327),B=C(81866);function Hash(m){var R=-1,C=null==m?0:m.length;for(this.clear();++R-1&&m%1==0&&m-1}},54705:function(m,R,C){var T=C(18470);m.exports=function(m,R){var C=this.__data__,L=T(C,m);return L<0?(++this.size,C.push([m,R])):C[L][1]=R,this}},24785:function(m,R,C){var T=C(1989),L=C(38407),U=C(57071);m.exports=function(){this.size=0,this.__data__={hash:new T,map:new(U||L),string:new T}}},11285:function(m,R,C){var T=C(45050);m.exports=function(m){var R=T(this,m).delete(m);return this.size-=R?1:0,R}},96e3:function(m,R,C){var T=C(45050);m.exports=function(m){return T(this,m).get(m)}},49916:function(m,R,C){var T=C(45050);m.exports=function(m){return T(this,m).has(m)}},95265:function(m,R,C){var T=C(45050);m.exports=function(m,R){var C=T(this,m),L=C.size;return C.set(m,R),this.size+=C.size==L?0:1,this}},24523:function(m,R,C){var T=C(88306);m.exports=function(m){var R=T(m,function(m){return 500===C.size&&C.clear(),m}),C=R.cache;return R}},94536:function(m,R,C){var T=C(10852)(Object,"create");m.exports=T},86916:function(m,R,C){var T=C(5569)(Object.keys,Object);m.exports=T},31167:function(m,R,C){m=C.nmd(m);var T=C(31957),L=R&&!R.nodeType&&R,U=L&&m&&!m.nodeType&&m,$=U&&U.exports===L&&T.process,B=function(){try{var m=U&&U.require&&U.require("util").types;if(m)return m;return $&&$.binding&&$.binding("util")}catch(m){}}();m.exports=B},2333:function(m){var R=Object.prototype.toString;m.exports=function(m){return R.call(m)}},5569:function(m){m.exports=function(m,R){return function(C){return m(R(C))}}},55639:function(m,R,C){var T=C(31957),L="object"==typeof self&&self&&self.Object===Object&&self,U=T||L||Function("return this")();m.exports=U},55514:function(m,R,C){var T=C(24523),L=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,U=/\\(\\)?/g,$=T(function(m){var R=[];return 46===m.charCodeAt(0)&&R.push(""),m.replace(L,function(m,C,T,L){R.push(T?L.replace(U,"$1"):C||m)}),R});m.exports=$},40327:function(m,R,C){var T=C(33448),L=1/0;m.exports=function(m){if("string"==typeof m||T(m))return m;var R=m+"";return"0"==R&&1/m==-L?"-0":R}},80346:function(m){var R=Function.prototype.toString;m.exports=function(m){if(null!=m){try{return R.call(m)}catch(m){}try{return m+""}catch(m){}}return""}},67990:function(m){var R=/\s/;m.exports=function(m){for(var C=m.length;C--&&R.test(m.charAt(C)););return C}},23279:function(m,R,C){var T=C(13218),L=C(7771),U=C(14841),$=Math.max,B=Math.min;m.exports=function(m,R,C){var V,H,G,q,W,Z,Y=0,K=!1,J=!1,X=!0;if("function"!=typeof m)throw TypeError("Expected a function");function invokeFunc(R){var C=V,T=H;return V=H=void 0,Y=R,q=m.apply(T,C)}function shouldInvoke(m){var C=m-Z,T=m-Y;return void 0===Z||C>=R||C<0||J&&T>=G}function timerExpired(){var m,C,T,U=L();if(shouldInvoke(U))return trailingEdge(U);W=setTimeout(timerExpired,(m=U-Z,C=U-Y,T=R-m,J?B(T,G-C):T))}function trailingEdge(m){return(W=void 0,X&&V)?invokeFunc(m):(V=H=void 0,q)}function debounced(){var m,C=L(),T=shouldInvoke(C);if(V=arguments,H=this,Z=C,T){if(void 0===W)return Y=m=Z,W=setTimeout(timerExpired,R),K?invokeFunc(m):q;if(J)return clearTimeout(W),W=setTimeout(timerExpired,R),invokeFunc(Z)}return void 0===W&&(W=setTimeout(timerExpired,R)),q}return R=U(R)||0,T(C)&&(K=!!C.leading,G=(J="maxWait"in C)?$(U(C.maxWait)||0,R):G,X="trailing"in C?!!C.trailing:X),debounced.cancel=function(){void 0!==W&&clearTimeout(W),Y=0,V=Z=H=W=void 0},debounced.flush=function(){return void 0===W?q:trailingEdge(L())},debounced}},77813:function(m){m.exports=function(m,R){return m===R||m!=m&&R!=R}},27361:function(m,R,C){var T=C(97786);m.exports=function(m,R,C){var L=null==m?void 0:T(m,R);return void 0===L?C:L}},35694:function(m,R,C){var T=C(9454),L=C(37005),U=Object.prototype,$=U.hasOwnProperty,B=U.propertyIsEnumerable,V=T(function(){return arguments}())?T:function(m){return L(m)&&$.call(m,"callee")&&!B.call(m,"callee")};m.exports=V},1469:function(m){var R=Array.isArray;m.exports=R},98612:function(m,R,C){var T=C(23560),L=C(41780);m.exports=function(m){return null!=m&&L(m.length)&&!T(m)}},44144:function(m,R,C){m=C.nmd(m);var T=C(55639),L=C(95062),U=R&&!R.nodeType&&R,$=U&&m&&!m.nodeType&&m,B=$&&$.exports===U?T.Buffer:void 0,V=B?B.isBuffer:void 0;m.exports=V||L},41609:function(m,R,C){var T=C(280),L=C(64160),U=C(35694),$=C(1469),B=C(98612),V=C(44144),H=C(25726),G=C(36719),q=Object.prototype.hasOwnProperty;m.exports=function(m){if(null==m)return!0;if(B(m)&&($(m)||"string"==typeof m||"function"==typeof m.splice||V(m)||G(m)||U(m)))return!m.length;var R=L(m);if("[object Map]"==R||"[object Set]"==R)return!m.size;if(H(m))return!T(m).length;for(var C in m)if(q.call(m,C))return!1;return!0}},23560:function(m,R,C){var T=C(44239),L=C(13218);m.exports=function(m){if(!L(m))return!1;var R=T(m);return"[object Function]"==R||"[object GeneratorFunction]"==R||"[object AsyncFunction]"==R||"[object Proxy]"==R}},41780:function(m){m.exports=function(m){return"number"==typeof m&&m>-1&&m%1==0&&m<=9007199254740991}},13218:function(m){m.exports=function(m){var R=typeof m;return null!=m&&("object"==R||"function"==R)}},37005:function(m){m.exports=function(m){return null!=m&&"object"==typeof m}},33448:function(m,R,C){var T=C(44239),L=C(37005);m.exports=function(m){return"symbol"==typeof m||L(m)&&"[object Symbol]"==T(m)}},36719:function(m,R,C){var T=C(38749),L=C(7518),U=C(31167),$=U&&U.isTypedArray,B=$?L($):T;m.exports=B},96486:function(m,R,C){var T;m=C.nmd(m),(function(){var L,U="Expected a function",$="__lodash_hash_undefined__",B="__lodash_placeholder__",V=1/0,H=0/0,G=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],q="[object Arguments]",W="[object Array]",Z="[object Boolean]",Y="[object Date]",K="[object Error]",J="[object Function]",X="[object GeneratorFunction]",Q="[object Map]",ee="[object Number]",et="[object Object]",er="[object Promise]",en="[object RegExp]",eo="[object Set]",ei="[object String]",ea="[object Symbol]",es="[object WeakMap]",el="[object ArrayBuffer]",eu="[object DataView]",ec="[object Float32Array]",ed="[object Float64Array]",ef="[object Int8Array]",ep="[object Int16Array]",eh="[object Int32Array]",eg="[object Uint8Array]",em="[object Uint8ClampedArray]",ey="[object Uint16Array]",ev="[object Uint32Array]",eb=/\b__p \+= '';/g,eE=/\b(__p \+=) '' \+/g,e_=/(__e\(.*?\)|\b__t\)) \+\n'';/g,eS=/&(?:amp|lt|gt|quot|#39);/g,eO=/[&<>"']/g,eA=RegExp(eS.source),ew=RegExp(eO.source),eI=/<%-([\s\S]+?)%>/g,eP=/<%([\s\S]+?)%>/g,eR=/<%=([\s\S]+?)%>/g,ek=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,eC=/^\w*$/,eT=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ex=/[\\^$.*+?()[\]{}|]/g,eL=RegExp(ex.source),eN=/^\s+/,eM=/\s/,ej=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,eD=/\{\n\/\* \[wrapped with (.+)\] \*/,eU=/,? & /,e$=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,eB=/[()=,{}\[\]\/\s]/,eF=/\\(\\)?/g,eV=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ez=/\w*$/,eH=/^[-+]0x[0-9a-f]+$/i,eG=/^0b[01]+$/i,eW=/^\[object .+?Constructor\]$/,eZ=/^0o[0-7]+$/i,eY=/^(?:0|[1-9]\d*)$/,eK=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,eJ=/($^)/,eX=/['\n\r\u2028\u2029\\]/g,eQ="\ud800-\udfff",e0="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",e1="\\u2700-\\u27bf",e2="a-z\\xdf-\\xf6\\xf8-\\xff",e3="A-Z\\xc0-\\xd6\\xd8-\\xde",e4="\\ufe0e\\ufe0f",e6="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",e8="['’]",e5="["+e6+"]",e9="["+e0+"]",e7="["+e2+"]",te="[^"+eQ+e6+"\\d+"+e1+e2+e3+"]",tt="\ud83c[\udffb-\udfff]",tr="[^"+eQ+"]",tn="(?:\ud83c[\udde6-\uddff]){2}",to="[\ud800-\udbff][\udc00-\udfff]",ti="["+e3+"]",ta="\\u200d",ts="(?:"+e7+"|"+te+")",tl="(?:"+e8+"(?:d|ll|m|re|s|t|ve))?",tu="(?:"+e8+"(?:D|LL|M|RE|S|T|VE))?",tc="(?:"+e9+"|"+tt+")?",td="["+e4+"]?",tf="(?:"+ta+"(?:"+[tr,tn,to].join("|")+")"+td+tc+")*",tp=td+tc+tf,th="(?:"+["["+e1+"]",tn,to].join("|")+")"+tp,tg="(?:"+[tr+e9+"?",e9,tn,to,"["+eQ+"]"].join("|")+")",tm=RegExp(e8,"g"),ty=RegExp(e9,"g"),tv=RegExp(tt+"(?="+tt+")|"+tg+tp,"g"),tb=RegExp([ti+"?"+e7+"+"+tl+"(?="+[e5,ti,"$"].join("|")+")","(?:"+ti+"|"+te+")+"+tu+"(?="+[e5,ti+ts,"$"].join("|")+")",ti+"?"+ts+"+"+tl,ti+"+"+tu,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",th].join("|"),"g"),tE=RegExp("["+ta+eQ+e0+e4+"]"),t_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,tS=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],tO=-1,tA={};tA[ec]=tA[ed]=tA[ef]=tA[ep]=tA[eh]=tA[eg]=tA[em]=tA[ey]=tA[ev]=!0,tA[q]=tA[W]=tA[el]=tA[Z]=tA[eu]=tA[Y]=tA[K]=tA[J]=tA[Q]=tA[ee]=tA[et]=tA[en]=tA[eo]=tA[ei]=tA[es]=!1;var tw={};tw[q]=tw[W]=tw[el]=tw[eu]=tw[Z]=tw[Y]=tw[ec]=tw[ed]=tw[ef]=tw[ep]=tw[eh]=tw[Q]=tw[ee]=tw[et]=tw[en]=tw[eo]=tw[ei]=tw[ea]=tw[eg]=tw[em]=tw[ey]=tw[ev]=!0,tw[K]=tw[J]=tw[es]=!1;var tI={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},tP=parseFloat,tR=parseInt,tk="object"==typeof C.g&&C.g&&C.g.Object===Object&&C.g,tC="object"==typeof self&&self&&self.Object===Object&&self,tT=tk||tC||Function("return this")(),tx=R&&!R.nodeType&&R,tL=tx&&m&&!m.nodeType&&m,tN=tL&&tL.exports===tx,tM=tN&&tk.process,tj=function(){try{var m=tL&&tL.require&&tL.require("util").types;if(m)return m;return tM&&tM.binding&&tM.binding("util")}catch(m){}}(),tD=tj&&tj.isArrayBuffer,tU=tj&&tj.isDate,t$=tj&&tj.isMap,tB=tj&&tj.isRegExp,tF=tj&&tj.isSet,tV=tj&&tj.isTypedArray;function apply(m,R,C){switch(C.length){case 0:return m.call(R);case 1:return m.call(R,C[0]);case 2:return m.call(R,C[0],C[1]);case 3:return m.call(R,C[0],C[1],C[2])}return m.apply(R,C)}function arrayAggregator(m,R,C,T){for(var L=-1,U=null==m?0:m.length;++L-1}function arrayIncludesWith(m,R,C){for(var T=-1,L=null==m?0:m.length;++T-1;);return C}function charsEndIndex(m,R){for(var C=m.length;C--&&baseIndexOf(R,m[C],0)>-1;);return C}var tH=basePropertyOf({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),tG=basePropertyOf({"&":"&","<":"<",">":">",'"':""","'":"'"});function escapeStringChar(m){return"\\"+tI[m]}function hasUnicode(m){return tE.test(m)}function mapToArray(m){var R=-1,C=Array(m.size);return m.forEach(function(m,T){C[++R]=[T,m]}),C}function overArg(m,R){return function(C){return m(R(C))}}function replaceHolders(m,R){for(var C=-1,T=m.length,L=0,U=[];++C",""":'"',"'":"'"}),tW=function runInContext(m){var R,C,T,eM,eQ=(m=null==m?tT:tW.defaults(tT.Object(),m,tW.pick(tT,tS))).Array,e0=m.Date,e1=m.Error,e2=m.Function,e3=m.Math,e4=m.Object,e6=m.RegExp,e8=m.String,e5=m.TypeError,e9=eQ.prototype,e7=e2.prototype,te=e4.prototype,tt=m["__core-js_shared__"],tr=e7.toString,tn=te.hasOwnProperty,to=0,ti=(R=/[^.]+$/.exec(tt&&tt.keys&&tt.keys.IE_PROTO||""))?"Symbol(src)_1."+R:"",ta=te.toString,ts=tr.call(e4),tl=tT._,tu=e6("^"+tr.call(tn).replace(ex,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tc=tN?m.Buffer:L,td=m.Symbol,tf=m.Uint8Array,tp=tc?tc.allocUnsafe:L,th=overArg(e4.getPrototypeOf,e4),tg=e4.create,tv=te.propertyIsEnumerable,tE=e9.splice,tI=td?td.isConcatSpreadable:L,tk=td?td.iterator:L,tC=td?td.toStringTag:L,tx=function(){try{var m=getNative(e4,"defineProperty");return m({},"",{}),m}catch(m){}}(),tL=m.clearTimeout!==tT.clearTimeout&&m.clearTimeout,tM=e0&&e0.now!==tT.Date.now&&e0.now,tj=m.setTimeout!==tT.setTimeout&&m.setTimeout,tz=e3.ceil,tZ=e3.floor,tY=e4.getOwnPropertySymbols,tK=tc?tc.isBuffer:L,tJ=m.isFinite,tX=e9.join,tQ=overArg(e4.keys,e4),t0=e3.max,t1=e3.min,t2=e0.now,t3=m.parseInt,t4=e3.random,t6=e9.reverse,t8=getNative(m,"DataView"),t5=getNative(m,"Map"),t9=getNative(m,"Promise"),t7=getNative(m,"Set"),re=getNative(m,"WeakMap"),rt=getNative(e4,"create"),rr=re&&new re,rn={},ro=toSource(t8),ri=toSource(t5),ra=toSource(t9),rs=toSource(t7),rl=toSource(re),ru=td?td.prototype:L,rc=ru?ru.valueOf:L,rd=ru?ru.toString:L;function lodash(m){if(isObjectLike(m)&&!no(m)&&!(m instanceof LazyWrapper)){if(m instanceof LodashWrapper)return m;if(tn.call(m,"__wrapped__"))return wrapperClone(m)}return new LodashWrapper(m)}var rf=function(){function object(){}return function(m){if(!isObject(m))return{};if(tg)return tg(m);object.prototype=m;var R=new object;return object.prototype=L,R}}();function baseLodash(){}function LodashWrapper(m,R){this.__wrapped__=m,this.__actions__=[],this.__chain__=!!R,this.__index__=0,this.__values__=L}function LazyWrapper(m){this.__wrapped__=m,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Hash(m){var R=-1,C=null==m?0:m.length;for(this.clear();++R=R?m:R)),m}function baseClone(m,R,C,T,U,$){var B,V=1&R,H=2&R,G=4&R;if(C&&(B=U?C(m,T,U,$):C(m)),L!==B)return B;if(!isObject(m))return m;var W=no(m);if(W){if(K=m.length,er=new m.constructor(K),K&&"string"==typeof m[0]&&tn.call(m,"index")&&(er.index=m.index,er.input=m.input),B=er,!V)return copyArray(m,B)}else{var K,er,es,eb,eE,e_=rA(m),eS=e_==J||e_==X;if(na(m))return cloneBuffer(m,V);if(e_==et||e_==q||eS&&!U){if(B=H||eS?{}:initCloneObject(m),!V)return H?(es=(eE=B)&©Object(m,keysIn(m),eE),copyObject(m,rO(m),es)):(eb=baseAssign(B,m),copyObject(m,rS(m),eb))}else{if(!tw[e_])return U?m:{};B=function(m,R,C){var T,L,U=m.constructor;switch(R){case el:return cloneArrayBuffer(m);case Z:case Y:return new U(+m);case eu:return T=C?cloneArrayBuffer(m.buffer):m.buffer,new m.constructor(T,m.byteOffset,m.byteLength);case ec:case ed:case ef:case ep:case eh:case eg:case em:case ey:case ev:return cloneTypedArray(m,C);case Q:return new U;case ee:case ei:return new U(m);case en:return(L=new m.constructor(m.source,ez.exec(m))).lastIndex=m.lastIndex,L;case eo:return new U;case ea:return rc?e4(rc.call(m)):{}}}(m,e_,V)}}$||($=new Stack);var eO=$.get(m);if(eO)return eO;$.set(m,B),nc(m)?m.forEach(function(T){B.add(baseClone(T,R,C,T,m,$))}):nl(m)&&m.forEach(function(T,L){B.set(L,baseClone(T,R,C,L,m,$))});var eA=G?H?getAllKeysIn:getAllKeys:H?keysIn:keys,ew=W?L:eA(m);return arrayEach(ew||m,function(T,L){ew&&(T=m[L=T]),assignValue(B,L,baseClone(T,R,C,L,m,$))}),B}function baseConformsTo(m,R,C){var T=C.length;if(null==m)return!T;for(m=e4(m);T--;){var U=C[T],$=R[U],B=m[U];if(L===B&&!(U in m)||!$(B))return!1}return!0}function baseDelay(m,R,C){if("function"!=typeof m)throw new e5(U);return rP(function(){m.apply(L,C)},R)}function baseDifference(m,R,C,T){var L=-1,U=arrayIncludes,$=!0,B=m.length,V=[],H=R.length;if(!B)return V;C&&(R=arrayMap(R,baseUnary(C))),T?(U=arrayIncludesWith,$=!1):R.length>=200&&(U=cacheHas,$=!1,R=new SetCache(R));e:for(;++L-1},ListCache.prototype.set=function(m,R){var C=this.__data__,T=assocIndexOf(C,m);return T<0?(++this.size,C.push([m,R])):C[T][1]=R,this},MapCache.prototype.clear=function(){this.size=0,this.__data__={hash:new Hash,map:new(t5||ListCache),string:new Hash}},MapCache.prototype.delete=function(m){var R=getMapData(this,m).delete(m);return this.size-=R?1:0,R},MapCache.prototype.get=function(m){return getMapData(this,m).get(m)},MapCache.prototype.has=function(m){return getMapData(this,m).has(m)},MapCache.prototype.set=function(m,R){var C=getMapData(this,m),T=C.size;return C.set(m,R),this.size+=C.size==T?0:1,this},SetCache.prototype.add=SetCache.prototype.push=function(m){return this.__data__.set(m,$),this},SetCache.prototype.has=function(m){return this.__data__.has(m)},Stack.prototype.clear=function(){this.__data__=new ListCache,this.size=0},Stack.prototype.delete=function(m){var R=this.__data__,C=R.delete(m);return this.size=R.size,C},Stack.prototype.get=function(m){return this.__data__.get(m)},Stack.prototype.has=function(m){return this.__data__.has(m)},Stack.prototype.set=function(m,R){var C=this.__data__;if(C instanceof ListCache){var T=C.__data__;if(!t5||T.length<199)return T.push([m,R]),this.size=++C.size,this;C=this.__data__=new MapCache(T)}return C.set(m,R),this.size=C.size,this};var rp=createBaseEach(baseForOwn),rh=createBaseEach(baseForOwnRight,!0);function baseEvery(m,R){var C=!0;return rp(m,function(m,T,L){return C=!!R(m,T,L)}),C}function baseExtremum(m,R,C){for(var T=-1,U=m.length;++T0&&C(B)?R>1?baseFlatten(B,R-1,C,T,L):arrayPush(L,B):T||(L[L.length]=B)}return L}var rg=createBaseFor(),rm=createBaseFor(!0);function baseForOwn(m,R){return m&&rg(m,R,keys)}function baseForOwnRight(m,R){return m&&rm(m,R,keys)}function baseFunctions(m,R){return arrayFilter(R,function(R){return isFunction(m[R])})}function baseGet(m,R){R=castPath(R,m);for(var C=0,T=R.length;null!=m&&CR}function baseHas(m,R){return null!=m&&tn.call(m,R)}function baseHasIn(m,R){return null!=m&&R in e4(m)}function baseIntersection(m,R,C){for(var T=C?arrayIncludesWith:arrayIncludes,U=m[0].length,$=m.length,B=$,V=eQ($),H=1/0,G=[];B--;){var q=m[B];B&&R&&(q=arrayMap(q,baseUnary(R))),H=t1(q.length,H),V[B]=!C&&(R||U>=120&&q.length>=120)?new SetCache(B&&q):L}q=m[0];var W=-1,Z=V[0];e:for(;++W=B)return V;return V*("desc"==C[T]?-1:1)}}return m.index-R.index}(m,R,C)})}function basePickBy(m,R,C){for(var T=-1,L=R.length,U={};++T-1;)B!==m&&tE.call(B,V,1),tE.call(m,V,1);return m}function basePullAt(m,R){for(var C=m?R.length:0,T=C-1;C--;){var L=R[C];if(C==T||L!==U){var U=L;isIndex(L)?tE.call(m,L,1):baseUnset(m,L)}}return m}function baseRandom(m,R){return m+tZ(t4()*(R-m+1))}function baseRepeat(m,R){var C="";if(!m||R<1||R>9007199254740991)return C;do R%2&&(C+=m),(R=tZ(R/2))&&(m+=m);while(R);return C}function baseRest(m,R){return rR(overRest(m,R,identity),m+"")}function baseSet(m,R,C,T){if(!isObject(m))return m;R=castPath(R,m);for(var U=-1,$=R.length,B=$-1,V=m;null!=V&&++U<$;){var H=toKey(R[U]),G=C;if("__proto__"===H||"constructor"===H||"prototype"===H)break;if(U!=B){var q=V[H];G=T?T(q,H,V):L,L===G&&(G=isObject(q)?q:isIndex(R[U+1])?[]:{})}assignValue(V,H,G),V=V[H]}return m}var ry=rr?function(m,R){return rr.set(m,R),m}:identity,rv=tx?function(m,R){return tx(m,"toString",{configurable:!0,enumerable:!1,value:constant(R),writable:!0})}:identity;function baseSlice(m,R,C){var T=-1,L=m.length;R<0&&(R=-R>L?0:L+R),(C=C>L?L:C)<0&&(C+=L),L=R>C?0:C-R>>>0,R>>>=0;for(var U=eQ(L);++T>>1,$=m[U];null!==$&&!isSymbol($)&&(C?$<=R:$=200){var H=R?null:rE(m);if(H)return setToArray(H);$=!1,L=cacheHas,V=new SetCache}else V=R?[]:B;e:for(;++T=T?m:baseSlice(m,R,C)}var rb=tL||function(m){return tT.clearTimeout(m)};function cloneBuffer(m,R){if(R)return m.slice();var C=m.length,T=tp?tp(C):new m.constructor(C);return m.copy(T),T}function cloneArrayBuffer(m){var R=new m.constructor(m.byteLength);return new tf(R).set(new tf(m)),R}function cloneTypedArray(m,R){var C=R?cloneArrayBuffer(m.buffer):m.buffer;return new m.constructor(C,m.byteOffset,m.length)}function compareAscending(m,R){if(m!==R){var C=L!==m,T=null===m,U=m==m,$=isSymbol(m),B=L!==R,V=null===R,H=R==R,G=isSymbol(R);if(!V&&!G&&!$&&m>R||$&&B&&H&&!V&&!G||T&&B&&H||!C&&H||!U)return 1;if(!T&&!$&&!G&&m1?C[U-1]:L,B=U>2?C[2]:L;for($=m.length>3&&"function"==typeof $?(U--,$):L,B&&isIterateeCall(C[0],C[1],B)&&($=U<3?L:$,U=1),R=e4(R);++T-1?U[$?R[B]:B]:L}}function createFlow(m){return flatRest(function(R){var C=R.length,T=C,$=LodashWrapper.prototype.thru;for(m&&R.reverse();T--;){var B=R[T];if("function"!=typeof B)throw new e5(U);if($&&!V&&"wrapper"==getFuncName(B))var V=new LodashWrapper([],!0)}for(T=V?T:C;++T1&&Q.reverse(),q&&HV))return!1;var G=$.get(m),q=$.get(R);if(G&&q)return G==R&&q==m;var W=-1,Z=!0,Y=2&C?new SetCache:L;for($.set(m,R),$.set(R,m);++W-1&&m%1==0&&m1?"& ":"")+R[T],R=R.join(C>2?", ":" "),m.replace(ej,"{\n/* [wrapped with "+R+"] */\n")}(U,(T=(L=U.match(eD))?L[1].split(eU):[],arrayEach(G,function(m){var R="_."+m[0];C&m[1]&&!arrayIncludes(T,R)&&T.push(R)}),T.sort())))}function shortOut(m){var R=0,C=0;return function(){var T=t2(),U=16-(T-C);if(C=T,U>0){if(++R>=800)return arguments[0]}else R=0;return m.apply(L,arguments)}}function shuffleSelf(m,R){var C=-1,T=m.length,U=T-1;for(R=L===R?T:R;++C1?m[R-1]:L;return C="function"==typeof C?(m.pop(),C):L,unzipWith(m,C)});function chain(m){var R=lodash(m);return R.__chain__=!0,R}function thru(m,R){return R(m)}var rW=flatRest(function(m){var R=m.length,C=R?m[0]:0,T=this.__wrapped__,interceptor=function(R){return baseAt(R,m)};return!(R>1)&&!this.__actions__.length&&T instanceof LazyWrapper&&isIndex(C)?((T=T.slice(C,+C+(R?1:0))).__actions__.push({func:thru,args:[interceptor],thisArg:L}),new LodashWrapper(T,this.__chain__).thru(function(m){return R&&!m.length&&m.push(L),m})):this.thru(interceptor)}),rZ=createAggregator(function(m,R,C){tn.call(m,C)?++m[C]:baseAssignValue(m,C,1)}),rY=createFind(findIndex),rK=createFind(findLastIndex);function forEach(m,R){return(no(m)?arrayEach:rp)(m,getIteratee(R,3))}function forEachRight(m,R){return(no(m)?function(m,R){for(var C=null==m?0:m.length;C--&&!1!==R(m[C],C,m););return m}:rh)(m,getIteratee(R,3))}var rJ=createAggregator(function(m,R,C){tn.call(m,C)?m[C].push(R):baseAssignValue(m,C,[R])}),rX=baseRest(function(m,R,C){var T=-1,L="function"==typeof R,U=isArrayLike(m)?eQ(m.length):[];return rp(m,function(m){U[++T]=L?apply(R,m,C):baseInvoke(m,R,C)}),U}),rQ=createAggregator(function(m,R,C){baseAssignValue(m,C,R)});function map(m,R){return(no(m)?arrayMap:baseMap)(m,getIteratee(R,3))}var r0=createAggregator(function(m,R,C){m[C?0:1].push(R)},function(){return[[],[]]}),r1=baseRest(function(m,R){if(null==m)return[];var C=R.length;return C>1&&isIterateeCall(m,R[0],R[1])?R=[]:C>2&&isIterateeCall(R[0],R[1],R[2])&&(R=[R[0]]),baseOrderBy(m,baseFlatten(R,1),[])}),r2=tM||function(){return tT.Date.now()};function ary(m,R,C){return R=C?L:R,R=m&&null==R?m.length:R,createWrap(m,128,L,L,L,L,R)}function before(m,R){var C;if("function"!=typeof R)throw new e5(U);return m=toInteger(m),function(){return--m>0&&(C=R.apply(this,arguments)),m<=1&&(R=L),C}}var r3=baseRest(function(m,R,C){var T=1;if(C.length){var L=replaceHolders(C,getHolder(r3));T|=32}return createWrap(m,T,R,C,L)}),r4=baseRest(function(m,R,C){var T=3;if(C.length){var L=replaceHolders(C,getHolder(r4));T|=32}return createWrap(R,T,m,C,L)});function debounce(m,R,C){var T,$,B,V,H,G,q=0,W=!1,Z=!1,Y=!0;if("function"!=typeof m)throw new e5(U);function invokeFunc(R){var C=T,U=$;return T=$=L,q=R,V=m.apply(U,C)}function shouldInvoke(m){var C=m-G,T=m-q;return L===G||C>=R||C<0||Z&&T>=B}function timerExpired(){var m,C,T,L=r2();if(shouldInvoke(L))return trailingEdge(L);H=rP(timerExpired,(m=L-G,C=L-q,T=R-m,Z?t1(T,B-C):T))}function trailingEdge(m){return(H=L,Y&&T)?invokeFunc(m):(T=$=L,V)}function debounced(){var m,C=r2(),U=shouldInvoke(C);if(T=arguments,$=this,G=C,U){if(L===H)return q=m=G,H=rP(timerExpired,R),W?invokeFunc(m):V;if(Z)return rb(H),H=rP(timerExpired,R),invokeFunc(G)}return L===H&&(H=rP(timerExpired,R)),V}return R=toNumber(R)||0,isObject(C)&&(W=!!C.leading,B=(Z="maxWait"in C)?t0(toNumber(C.maxWait)||0,R):B,Y="trailing"in C?!!C.trailing:Y),debounced.cancel=function(){L!==H&&rb(H),q=0,T=G=$=H=L},debounced.flush=function(){return L===H?V:trailingEdge(r2())},debounced}var r6=baseRest(function(m,R){return baseDelay(m,1,R)}),r8=baseRest(function(m,R,C){return baseDelay(m,toNumber(R)||0,C)});function memoize(m,R){if("function"!=typeof m||null!=R&&"function"!=typeof R)throw new e5(U);var memoized=function(){var C=arguments,T=R?R.apply(this,C):C[0],L=memoized.cache;if(L.has(T))return L.get(T);var U=m.apply(this,C);return memoized.cache=L.set(T,U)||L,U};return memoized.cache=new(memoize.Cache||MapCache),memoized}function negate(m){if("function"!=typeof m)throw new e5(U);return function(){var R=arguments;switch(R.length){case 0:return!m.call(this);case 1:return!m.call(this,R[0]);case 2:return!m.call(this,R[0],R[1]);case 3:return!m.call(this,R[0],R[1],R[2])}return!m.apply(this,R)}}memoize.Cache=MapCache;var r5=baseRest(function(m,R){var C=(R=1==R.length&&no(R[0])?arrayMap(R[0],baseUnary(getIteratee())):arrayMap(baseFlatten(R,1),baseUnary(getIteratee()))).length;return baseRest(function(T){for(var L=-1,U=t1(T.length,C);++L=R}),nn=baseIsArguments(function(){return arguments}())?baseIsArguments:function(m){return isObjectLike(m)&&tn.call(m,"callee")&&!tv.call(m,"callee")},no=eQ.isArray,ni=tD?baseUnary(tD):function(m){return isObjectLike(m)&&baseGetTag(m)==el};function isArrayLike(m){return null!=m&&isLength(m.length)&&!isFunction(m)}function isArrayLikeObject(m){return isObjectLike(m)&&isArrayLike(m)}var na=tK||stubFalse,ns=tU?baseUnary(tU):function(m){return isObjectLike(m)&&baseGetTag(m)==Y};function isError(m){if(!isObjectLike(m))return!1;var R=baseGetTag(m);return R==K||"[object DOMException]"==R||"string"==typeof m.message&&"string"==typeof m.name&&!isPlainObject(m)}function isFunction(m){if(!isObject(m))return!1;var R=baseGetTag(m);return R==J||R==X||"[object AsyncFunction]"==R||"[object Proxy]"==R}function isInteger(m){return"number"==typeof m&&m==toInteger(m)}function isLength(m){return"number"==typeof m&&m>-1&&m%1==0&&m<=9007199254740991}function isObject(m){var R=typeof m;return null!=m&&("object"==R||"function"==R)}function isObjectLike(m){return null!=m&&"object"==typeof m}var nl=t$?baseUnary(t$):function(m){return isObjectLike(m)&&rA(m)==Q};function isNumber(m){return"number"==typeof m||isObjectLike(m)&&baseGetTag(m)==ee}function isPlainObject(m){if(!isObjectLike(m)||baseGetTag(m)!=et)return!1;var R=th(m);if(null===R)return!0;var C=tn.call(R,"constructor")&&R.constructor;return"function"==typeof C&&C instanceof C&&tr.call(C)==ts}var nu=tB?baseUnary(tB):function(m){return isObjectLike(m)&&baseGetTag(m)==en},nc=tF?baseUnary(tF):function(m){return isObjectLike(m)&&rA(m)==eo};function isString(m){return"string"==typeof m||!no(m)&&isObjectLike(m)&&baseGetTag(m)==ei}function isSymbol(m){return"symbol"==typeof m||isObjectLike(m)&&baseGetTag(m)==ea}var nd=tV?baseUnary(tV):function(m){return isObjectLike(m)&&isLength(m.length)&&!!tA[baseGetTag(m)]},nf=createRelationalOperation(baseLt),np=createRelationalOperation(function(m,R){return m<=R});function toArray(m){if(!m)return[];if(isArrayLike(m))return isString(m)?stringToArray(m):copyArray(m);if(tk&&m[tk])return function(m){for(var R,C=[];!(R=m.next()).done;)C.push(R.value);return C}(m[tk]());var R=rA(m);return(R==Q?mapToArray:R==eo?setToArray:values)(m)}function toFinite(m){return m?(m=toNumber(m))===V||m===-V?(m<0?-1:1)*17976931348623157e292:m==m?m:0:0===m?m:0}function toInteger(m){var R=toFinite(m),C=R%1;return R==R?C?R-C:R:0}function toLength(m){return m?baseClamp(toInteger(m),0,4294967295):0}function toNumber(m){if("number"==typeof m)return m;if(isSymbol(m))return H;if(isObject(m)){var R="function"==typeof m.valueOf?m.valueOf():m;m=isObject(R)?R+"":R}if("string"!=typeof m)return 0===m?m:+m;m=baseTrim(m);var C=eG.test(m);return C||eZ.test(m)?tR(m.slice(2),C?2:8):eH.test(m)?H:+m}function toPlainObject(m){return copyObject(m,keysIn(m))}function toString(m){return null==m?"":baseToString(m)}var nh=createAssigner(function(m,R){if(isPrototype(R)||isArrayLike(R)){copyObject(R,keys(R),m);return}for(var C in R)tn.call(R,C)&&assignValue(m,C,R[C])}),ng=createAssigner(function(m,R){copyObject(R,keysIn(R),m)}),nm=createAssigner(function(m,R,C,T){copyObject(R,keysIn(R),m,T)}),ny=createAssigner(function(m,R,C,T){copyObject(R,keys(R),m,T)}),nv=flatRest(baseAt),nb=baseRest(function(m,R){m=e4(m);var C=-1,T=R.length,U=T>2?R[2]:L;for(U&&isIterateeCall(R[0],R[1],U)&&(T=1);++C1),R}),copyObject(m,getAllKeysIn(m),C),T&&(C=baseClone(C,7,customOmitClone));for(var L=R.length;L--;)baseUnset(C,R[L]);return C}),nP=flatRest(function(m,R){return null==m?{}:basePickBy(m,R,function(R,C){return hasIn(m,C)})});function pickBy(m,R){if(null==m)return{};var C=arrayMap(getAllKeysIn(m),function(m){return[m]});return R=getIteratee(R),basePickBy(m,C,function(m,C){return R(m,C[0])})}var nR=createToPairs(keys),nk=createToPairs(keysIn);function values(m){return null==m?[]:baseValues(m,keys(m))}var nC=createCompounder(function(m,R,C){return R=R.toLowerCase(),m+(C?capitalize(R):R)});function capitalize(m){return nD(toString(m).toLowerCase())}function deburr(m){return(m=toString(m))&&m.replace(eK,tH).replace(ty,"")}var nT=createCompounder(function(m,R,C){return m+(C?"-":"")+R.toLowerCase()}),nx=createCompounder(function(m,R,C){return m+(C?" ":"")+R.toLowerCase()}),nL=createCaseFirst("toLowerCase"),nN=createCompounder(function(m,R,C){return m+(C?"_":"")+R.toLowerCase()}),nM=createCompounder(function(m,R,C){return m+(C?" ":"")+nD(R)}),nj=createCompounder(function(m,R,C){return m+(C?" ":"")+R.toUpperCase()}),nD=createCaseFirst("toUpperCase");function words(m,R,C){if(m=toString(m),R=C?L:R,L===R){var T;return(T=m,t_.test(T))?m.match(tb)||[]:m.match(e$)||[]}return m.match(R)||[]}var nU=baseRest(function(m,R){try{return apply(m,L,R)}catch(m){return isError(m)?m:new e1(m)}}),n$=flatRest(function(m,R){return arrayEach(R,function(R){baseAssignValue(m,R=toKey(R),r3(m[R],m))}),m});function constant(m){return function(){return m}}var nB=createFlow(),nF=createFlow(!0);function identity(m){return m}function iteratee(m){return baseIteratee("function"==typeof m?m:baseClone(m,1))}var nV=baseRest(function(m,R){return function(C){return baseInvoke(C,m,R)}}),nz=baseRest(function(m,R){return function(C){return baseInvoke(m,C,R)}});function mixin(m,R,C){var T=keys(R),L=baseFunctions(R,T);null!=C||isObject(R)&&(L.length||!T.length)||(C=R,R=m,m=this,L=baseFunctions(R,keys(R)));var U=!(isObject(C)&&"chain"in C)||!!C.chain,$=isFunction(m);return arrayEach(L,function(C){var T=R[C];m[C]=T,$&&(m.prototype[C]=function(){var R=this.__chain__;if(U||R){var C=m(this.__wrapped__);return(C.__actions__=copyArray(this.__actions__)).push({func:T,args:arguments,thisArg:m}),C.__chain__=R,C}return T.apply(m,arrayPush([this.value()],arguments))})}),m}function noop(){}var nH=createOver(arrayMap),nG=createOver(arrayEvery),nq=createOver(arraySome);function property(m){return isKey(m)?baseProperty(toKey(m)):function(R){return baseGet(R,m)}}var nW=createRange(),nZ=createRange(!0);function stubArray(){return[]}function stubFalse(){return!1}var nY=createMathOperation(function(m,R){return m+R},0),nK=createRound("ceil"),nJ=createMathOperation(function(m,R){return m/R},1),nX=createRound("floor"),nQ=createMathOperation(function(m,R){return m*R},1),n0=createRound("round"),n1=createMathOperation(function(m,R){return m-R},0);return lodash.after=function(m,R){if("function"!=typeof R)throw new e5(U);return m=toInteger(m),function(){if(--m<1)return R.apply(this,arguments)}},lodash.ary=ary,lodash.assign=nh,lodash.assignIn=ng,lodash.assignInWith=nm,lodash.assignWith=ny,lodash.at=nv,lodash.before=before,lodash.bind=r3,lodash.bindAll=n$,lodash.bindKey=r4,lodash.castArray=function(){if(!arguments.length)return[];var m=arguments[0];return no(m)?m:[m]},lodash.chain=chain,lodash.chunk=function(m,R,C){R=(C?isIterateeCall(m,R,C):L===R)?1:t0(toInteger(R),0);var T=null==m?0:m.length;if(!T||R<1)return[];for(var U=0,$=0,B=eQ(tz(T/R));UU?0:U+C),(T=L===T||T>U?U:toInteger(T))<0&&(T+=U),T=C>T?0:toLength(T);C>>0)?(m=toString(m))&&("string"==typeof R||null!=R&&!nu(R))&&!(R=baseToString(R))&&hasUnicode(m)?castSlice(stringToArray(m),0,C):m.split(R,C):[]},lodash.spread=function(m,R){if("function"!=typeof m)throw new e5(U);return R=null==R?0:t0(toInteger(R),0),baseRest(function(C){var T=C[R],L=castSlice(C,0,R);return T&&arrayPush(L,T),apply(m,this,L)})},lodash.tail=function(m){var R=null==m?0:m.length;return R?baseSlice(m,1,R):[]},lodash.take=function(m,R,C){return m&&m.length?baseSlice(m,0,(R=C||L===R?1:toInteger(R))<0?0:R):[]},lodash.takeRight=function(m,R,C){var T=null==m?0:m.length;return T?baseSlice(m,(R=T-(R=C||L===R?1:toInteger(R)))<0?0:R,T):[]},lodash.takeRightWhile=function(m,R){return m&&m.length?baseWhile(m,getIteratee(R,3),!1,!0):[]},lodash.takeWhile=function(m,R){return m&&m.length?baseWhile(m,getIteratee(R,3)):[]},lodash.tap=function(m,R){return R(m),m},lodash.throttle=function(m,R,C){var T=!0,L=!0;if("function"!=typeof m)throw new e5(U);return isObject(C)&&(T="leading"in C?!!C.leading:T,L="trailing"in C?!!C.trailing:L),debounce(m,R,{leading:T,maxWait:R,trailing:L})},lodash.thru=thru,lodash.toArray=toArray,lodash.toPairs=nR,lodash.toPairsIn=nk,lodash.toPath=function(m){return no(m)?arrayMap(m,toKey):isSymbol(m)?[m]:copyArray(rk(toString(m)))},lodash.toPlainObject=toPlainObject,lodash.transform=function(m,R,C){var T=no(m),L=T||na(m)||nd(m);if(R=getIteratee(R,4),null==C){var U=m&&m.constructor;C=L?T?new U:[]:isObject(m)&&isFunction(U)?rf(th(m)):{}}return(L?arrayEach:baseForOwn)(m,function(m,T,L){return R(C,m,T,L)}),C},lodash.unary=function(m){return ary(m,1)},lodash.union=rU,lodash.unionBy=r$,lodash.unionWith=rB,lodash.uniq=function(m){return m&&m.length?baseUniq(m):[]},lodash.uniqBy=function(m,R){return m&&m.length?baseUniq(m,getIteratee(R,2)):[]},lodash.uniqWith=function(m,R){return R="function"==typeof R?R:L,m&&m.length?baseUniq(m,L,R):[]},lodash.unset=function(m,R){return null==m||baseUnset(m,R)},lodash.unzip=unzip,lodash.unzipWith=unzipWith,lodash.update=function(m,R,C){return null==m?m:baseUpdate(m,R,castFunction(C))},lodash.updateWith=function(m,R,C,T){return T="function"==typeof T?T:L,null==m?m:baseUpdate(m,R,castFunction(C),T)},lodash.values=values,lodash.valuesIn=function(m){return null==m?[]:baseValues(m,keysIn(m))},lodash.without=rF,lodash.words=words,lodash.wrap=function(m,R){return r9(castFunction(R),m)},lodash.xor=rV,lodash.xorBy=rz,lodash.xorWith=rH,lodash.zip=rG,lodash.zipObject=function(m,R){return baseZipObject(m||[],R||[],assignValue)},lodash.zipObjectDeep=function(m,R){return baseZipObject(m||[],R||[],baseSet)},lodash.zipWith=rq,lodash.entries=nR,lodash.entriesIn=nk,lodash.extend=ng,lodash.extendWith=nm,mixin(lodash,lodash),lodash.add=nY,lodash.attempt=nU,lodash.camelCase=nC,lodash.capitalize=capitalize,lodash.ceil=nK,lodash.clamp=function(m,R,C){return L===C&&(C=R,R=L),L!==C&&(C=(C=toNumber(C))==C?C:0),L!==R&&(R=(R=toNumber(R))==R?R:0),baseClamp(toNumber(m),R,C)},lodash.clone=function(m){return baseClone(m,4)},lodash.cloneDeep=function(m){return baseClone(m,5)},lodash.cloneDeepWith=function(m,R){return baseClone(m,5,R="function"==typeof R?R:L)},lodash.cloneWith=function(m,R){return baseClone(m,4,R="function"==typeof R?R:L)},lodash.conformsTo=function(m,R){return null==R||baseConformsTo(m,R,keys(R))},lodash.deburr=deburr,lodash.defaultTo=function(m,R){return null==m||m!=m?R:m},lodash.divide=nJ,lodash.endsWith=function(m,R,C){m=toString(m),R=baseToString(R);var T=m.length,U=C=L===C?T:baseClamp(toInteger(C),0,T);return(C-=R.length)>=0&&m.slice(C,U)==R},lodash.eq=eq,lodash.escape=function(m){return(m=toString(m))&&ew.test(m)?m.replace(eO,tG):m},lodash.escapeRegExp=function(m){return(m=toString(m))&&eL.test(m)?m.replace(ex,"\\$&"):m},lodash.every=function(m,R,C){var T=no(m)?arrayEvery:baseEvery;return C&&isIterateeCall(m,R,C)&&(R=L),T(m,getIteratee(R,3))},lodash.find=rY,lodash.findIndex=findIndex,lodash.findKey=function(m,R){return baseFindKey(m,getIteratee(R,3),baseForOwn)},lodash.findLast=rK,lodash.findLastIndex=findLastIndex,lodash.findLastKey=function(m,R){return baseFindKey(m,getIteratee(R,3),baseForOwnRight)},lodash.floor=nX,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=function(m,R){return null==m?m:rg(m,getIteratee(R,3),keysIn)},lodash.forInRight=function(m,R){return null==m?m:rm(m,getIteratee(R,3),keysIn)},lodash.forOwn=function(m,R){return m&&baseForOwn(m,getIteratee(R,3))},lodash.forOwnRight=function(m,R){return m&&baseForOwnRight(m,getIteratee(R,3))},lodash.get=get,lodash.gt=nt,lodash.gte=nr,lodash.has=function(m,R){return null!=m&&hasPath(m,R,baseHas)},lodash.hasIn=hasIn,lodash.head=head,lodash.identity=identity,lodash.includes=function(m,R,C,T){m=isArrayLike(m)?m:values(m),C=C&&!T?toInteger(C):0;var L=m.length;return C<0&&(C=t0(L+C,0)),isString(m)?C<=L&&m.indexOf(R,C)>-1:!!L&&baseIndexOf(m,R,C)>-1},lodash.indexOf=function(m,R,C){var T=null==m?0:m.length;if(!T)return -1;var L=null==C?0:toInteger(C);return L<0&&(L=t0(T+L,0)),baseIndexOf(m,R,L)},lodash.inRange=function(m,R,C){var T,U,$;return R=toFinite(R),L===C?(C=R,R=0):C=toFinite(C),(T=m=toNumber(m))>=t1(U=R,$=C)&&T=-9007199254740991&&m<=9007199254740991},lodash.isSet=nc,lodash.isString=isString,lodash.isSymbol=isSymbol,lodash.isTypedArray=nd,lodash.isUndefined=function(m){return L===m},lodash.isWeakMap=function(m){return isObjectLike(m)&&rA(m)==es},lodash.isWeakSet=function(m){return isObjectLike(m)&&"[object WeakSet]"==baseGetTag(m)},lodash.join=function(m,R){return null==m?"":tX.call(m,R)},lodash.kebabCase=nT,lodash.last=last,lodash.lastIndexOf=function(m,R,C){var T=null==m?0:m.length;if(!T)return -1;var U=T;return L!==C&&(U=(U=toInteger(C))<0?t0(T+U,0):t1(U,T-1)),R==R?function(m,R,C){for(var T=C+1;T--&&m[T]!==R;);return T}(m,R,U):baseFindIndex(m,baseIsNaN,U,!0)},lodash.lowerCase=nx,lodash.lowerFirst=nL,lodash.lt=nf,lodash.lte=np,lodash.max=function(m){return m&&m.length?baseExtremum(m,identity,baseGt):L},lodash.maxBy=function(m,R){return m&&m.length?baseExtremum(m,getIteratee(R,2),baseGt):L},lodash.mean=function(m){return baseMean(m,identity)},lodash.meanBy=function(m,R){return baseMean(m,getIteratee(R,2))},lodash.min=function(m){return m&&m.length?baseExtremum(m,identity,baseLt):L},lodash.minBy=function(m,R){return m&&m.length?baseExtremum(m,getIteratee(R,2),baseLt):L},lodash.stubArray=stubArray,lodash.stubFalse=stubFalse,lodash.stubObject=function(){return{}},lodash.stubString=function(){return""},lodash.stubTrue=function(){return!0},lodash.multiply=nQ,lodash.nth=function(m,R){return m&&m.length?baseNth(m,toInteger(R)):L},lodash.noConflict=function(){return tT._===this&&(tT._=tl),this},lodash.noop=noop,lodash.now=r2,lodash.pad=function(m,R,C){m=toString(m);var T=(R=toInteger(R))?stringSize(m):0;if(!R||T>=R)return m;var L=(R-T)/2;return createPadding(tZ(L),C)+m+createPadding(tz(L),C)},lodash.padEnd=function(m,R,C){m=toString(m);var T=(R=toInteger(R))?stringSize(m):0;return R&&TR){var T=m;m=R,R=T}if(C||m%1||R%1){var U=t4();return t1(m+U*(R-m+tP("1e-"+((U+"").length-1))),R)}return baseRandom(m,R)},lodash.reduce=function(m,R,C){var T=no(m)?arrayReduce:baseReduce,L=arguments.length<3;return T(m,getIteratee(R,4),C,L,rp)},lodash.reduceRight=function(m,R,C){var T=no(m)?arrayReduceRight:baseReduce,L=arguments.length<3;return T(m,getIteratee(R,4),C,L,rh)},lodash.repeat=function(m,R,C){return R=(C?isIterateeCall(m,R,C):L===R)?1:toInteger(R),baseRepeat(toString(m),R)},lodash.replace=function(){var m=arguments,R=toString(m[0]);return m.length<3?R:R.replace(m[1],m[2])},lodash.result=function(m,R,C){R=castPath(R,m);var T=-1,U=R.length;for(U||(U=1,m=L);++T9007199254740991)return[];var C=4294967295,T=t1(m,4294967295);R=getIteratee(R),m-=4294967295;for(var L=baseTimes(T,R);++C=$)return m;var V=C-stringSize(T);if(V<1)return T;var H=B?castSlice(B,0,V).join(""):m.slice(0,V);if(L===U)return H+T;if(B&&(V+=H.length-V),nu(U)){if(m.slice(V).search(U)){var G,q=H;for(U.global||(U=e6(U.source,toString(ez.exec(U))+"g")),U.lastIndex=0;G=U.exec(q);)var W=G.index;H=H.slice(0,L===W?V:W)}}else if(m.indexOf(baseToString(U),V)!=V){var Z=H.lastIndexOf(U);Z>-1&&(H=H.slice(0,Z))}return H+T},lodash.unescape=function(m){return(m=toString(m))&&eA.test(m)?m.replace(eS,tq):m},lodash.uniqueId=function(m){var R=++to;return toString(m)+R},lodash.upperCase=nj,lodash.upperFirst=nD,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.first=head,mixin(lodash,(eM={},baseForOwn(lodash,function(m,R){tn.call(lodash.prototype,R)||(eM[R]=m)}),eM),{chain:!1}),lodash.VERSION="4.17.21",arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(m){lodash[m].placeholder=lodash}),arrayEach(["drop","take"],function(m,R){LazyWrapper.prototype[m]=function(C){C=L===C?1:t0(toInteger(C),0);var T=this.__filtered__&&!R?new LazyWrapper(this):this.clone();return T.__filtered__?T.__takeCount__=t1(C,T.__takeCount__):T.__views__.push({size:t1(C,4294967295),type:m+(T.__dir__<0?"Right":"")}),T},LazyWrapper.prototype[m+"Right"]=function(R){return this.reverse()[m](R).reverse()}}),arrayEach(["filter","map","takeWhile"],function(m,R){var C=R+1,T=1==C||3==C;LazyWrapper.prototype[m]=function(m){var R=this.clone();return R.__iteratees__.push({iteratee:getIteratee(m,3),type:C}),R.__filtered__=R.__filtered__||T,R}}),arrayEach(["head","last"],function(m,R){var C="take"+(R?"Right":"");LazyWrapper.prototype[m]=function(){return this[C](1).value()[0]}}),arrayEach(["initial","tail"],function(m,R){var C="drop"+(R?"":"Right");LazyWrapper.prototype[m]=function(){return this.__filtered__?new LazyWrapper(this):this[C](1)}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.find=function(m){return this.filter(m).head()},LazyWrapper.prototype.findLast=function(m){return this.reverse().find(m)},LazyWrapper.prototype.invokeMap=baseRest(function(m,R){return"function"==typeof m?new LazyWrapper(this):this.map(function(C){return baseInvoke(C,m,R)})}),LazyWrapper.prototype.reject=function(m){return this.filter(negate(getIteratee(m)))},LazyWrapper.prototype.slice=function(m,R){m=toInteger(m);var C=this;return C.__filtered__&&(m>0||R<0)?new LazyWrapper(C):(m<0?C=C.takeRight(-m):m&&(C=C.drop(m)),L!==R&&(C=(R=toInteger(R))<0?C.dropRight(-R):C.take(R-m)),C)},LazyWrapper.prototype.takeRightWhile=function(m){return this.reverse().takeWhile(m).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(4294967295)},baseForOwn(LazyWrapper.prototype,function(m,R){var C=/^(?:filter|find|map|reject)|While$/.test(R),T=/^(?:head|last)$/.test(R),U=lodash[T?"take"+("last"==R?"Right":""):R],$=T||/^find/.test(R);U&&(lodash.prototype[R]=function(){var R=this.__wrapped__,B=T?[1]:arguments,V=R instanceof LazyWrapper,H=B[0],G=V||no(R),interceptor=function(m){var R=U.apply(lodash,arrayPush([m],B));return T&&q?R[0]:R};G&&C&&"function"==typeof H&&1!=H.length&&(V=G=!1);var q=this.__chain__,W=!!this.__actions__.length,Z=$&&!q,Y=V&&!W;if(!$&&G){R=Y?R:new LazyWrapper(this);var K=m.apply(R,B);return K.__actions__.push({func:thru,args:[interceptor],thisArg:L}),new LodashWrapper(K,q)}return Z&&Y?m.apply(this,B):(K=this.thru(interceptor),Z?T?K.value()[0]:K.value():K)})}),arrayEach(["pop","push","shift","sort","splice","unshift"],function(m){var R=e9[m],C=/^(?:push|sort|unshift)$/.test(m)?"tap":"thru",T=/^(?:pop|shift)$/.test(m);lodash.prototype[m]=function(){var m=arguments;if(T&&!this.__chain__){var L=this.value();return R.apply(no(L)?L:[],m)}return this[C](function(C){return R.apply(no(C)?C:[],m)})}}),baseForOwn(LazyWrapper.prototype,function(m,R){var C=lodash[R];if(C){var T=C.name+"";tn.call(rn,T)||(rn[T]=[]),rn[T].push({name:R,func:C})}}),rn[createHybrid(L,2).name]=[{name:"wrapper",func:L}],LazyWrapper.prototype.clone=function(){var m=new LazyWrapper(this.__wrapped__);return m.__actions__=copyArray(this.__actions__),m.__dir__=this.__dir__,m.__filtered__=this.__filtered__,m.__iteratees__=copyArray(this.__iteratees__),m.__takeCount__=this.__takeCount__,m.__views__=copyArray(this.__views__),m},LazyWrapper.prototype.reverse=function(){if(this.__filtered__){var m=new LazyWrapper(this);m.__dir__=-1,m.__filtered__=!0}else m=this.clone(),m.__dir__*=-1;return m},LazyWrapper.prototype.value=function(){var m=this.__wrapped__.value(),R=this.__dir__,C=no(m),T=R<0,L=C?m.length:0,U=function(m,R,C){for(var T=-1,L=C.length;++T=this.__values__.length,R=m?L:this.__values__[this.__index__++];return{done:m,value:R}},lodash.prototype.plant=function(m){for(var R,C=this;C instanceof baseLodash;){var T=wrapperClone(C);T.__index__=0,T.__values__=L,R?U.__wrapped__=T:R=T;var U=T;C=C.__wrapped__}return U.__wrapped__=m,R},lodash.prototype.reverse=function(){var m=this.__wrapped__;if(m instanceof LazyWrapper){var R=m;return this.__actions__.length&&(R=new LazyWrapper(this)),(R=R.reverse()).__actions__.push({func:thru,args:[reverse],thisArg:L}),new LodashWrapper(R,this.__chain__)}return this.thru(reverse)},lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=function(){return baseWrapperValue(this.__wrapped__,this.__actions__)},lodash.prototype.first=lodash.prototype.head,tk&&(lodash.prototype[tk]=function(){return this}),lodash}();tT._=tW,L!==(T=(function(){return tW}).call(R,C,R,m))&&(m.exports=T)}).call(this)},88306:function(m,R,C){var T=C(83369);function memoize(m,R){if("function"!=typeof m||null!=R&&"function"!=typeof R)throw TypeError("Expected a function");var memoized=function(){var C=arguments,T=R?R.apply(this,C):C[0],L=memoized.cache;if(L.has(T))return L.get(T);var U=m.apply(this,C);return memoized.cache=L.set(T,U)||L,U};return memoized.cache=new(memoize.Cache||T),memoized}memoize.Cache=T,m.exports=memoize},7771:function(m,R,C){var T=C(55639);m.exports=function(){return T.Date.now()}},36968:function(m,R,C){var T=C(10611);m.exports=function(m,R,C){return null==m?m:T(m,R,C)}},95062:function(m){m.exports=function(){return!1}},23493:function(m,R,C){var T=C(23279),L=C(13218);m.exports=function(m,R,C){var U=!0,$=!0;if("function"!=typeof m)throw TypeError("Expected a function");return L(C)&&(U="leading"in C?!!C.leading:U,$="trailing"in C?!!C.trailing:$),T(m,R,{leading:U,maxWait:R,trailing:$})}},14841:function(m,R,C){var T=C(27561),L=C(13218),U=C(33448),$=0/0,B=/^[-+]0x[0-9a-f]+$/i,V=/^0b[01]+$/i,H=/^0o[0-7]+$/i,G=parseInt;m.exports=function(m){if("number"==typeof m)return m;if(U(m))return $;if(L(m)){var R="function"==typeof m.valueOf?m.valueOf():m;m=L(R)?R+"":R}if("string"!=typeof m)return 0===m?m:+m;m=T(m);var C=V.test(m);return C||H.test(m)?G(m.slice(2),C?2:8):B.test(m)?$:+m}},79833:function(m,R,C){var T=C(80531);m.exports=function(m){return null==m?"":T(m)}},83454:function(m,R,C){"use strict";var T,L;m.exports=(null==(T=C.g.process)?void 0:T.env)&&"object"==typeof(null==(L=C.g.process)?void 0:L.env)?C.g.process:C(77663)},6840:function(m,R,C){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return C(10333)}])},61036:function(m,R,C){"use strict";C.d(R,{Bf:function(){return handleShare},Fc:function(){return getSpeckMapId},HX:function(){return cached},J2:function(){return getItemImage},Kt:function(){return formatDisplayInfo},Qb:function(){return formatTierAsRomanNumeral},Zo:function(){return formatTimeRemaining},je:function(){return Capitalize},sA:function(){return i18nKeyFromID},x9:function(){return duration},xn:function(){return arrayToMap}});var T=C(34853),L=C(70247),U=C(83928),$=C(80535),B=C(77497);function duration(m){let{days:R=0,hours:C=0,minutes:T=0,seconds:L=0,ms:U=0}=m;return U+1e3*L+6e4*T+36e5*C+864e5*R}let V={};async function cached(m,R){var C;let T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:duration({minutes:2}),L=(null===(C=V[m])||void 0===C?void 0:C.timestamp)||0;if(Date.now()-L>T){let C=await R(),T=Date.now();V[m]={result:C,timestamp:T}}return V[m].result}function formatDisplayInfo(m){var R,C;let L=null==m?void 0:null===(R=m.displayInfo)||void 0===R?void 0:R.format;return L&&(L=T.ZP.t(L,{ns:"ui"}),null===(C=m.displayInfo.values)||void 0===C||C.forEach((m,R)=>{L=L.replace("{".concat(R,"}"),null==m?void 0:m.toString())})),L}let formatTimeAsString=(m,R,C,T)=>{let L="";return m>0&&(L+="".concat(m,"d ")),R>0&&(L+="".concat(R,"h ")),C>0&&(L+="".concat(C,"m ")),0===m&&0===R&&0===C&&T<60&&T>=0&&(L="".concat(T,"s")),L};function formatTimeRemaining(m){return m<0||"number"!=typeof m||Number.isNaN(m)?"...":formatTimeAsString(Math.floor(m/86400),Math.floor(m/3600%24),Math.floor(m/60%60),Math.floor(m%60))}function formatTierAsRomanNumeral(m){switch(m){case 1:return"I";case 2:return"II";case 3:return"III";case 4:return"IV";case 5:return"V"}return m.toString()}function Capitalize(m){return m[0].toUpperCase()+m.slice(1)}function arrayToMap(m,R){let C=new Map;return m.forEach(m=>{C.set(m[R].toString(),m)}),C}function getItemImage(m,R){let C={width:32,height:32,image:null==m?void 0:m.image,scale:3};if(m&&R){var T,$,B,V;if(null===(T=m.onUse)||void 0===T?void 0:T.placeObject){let R=L.Z.getGameObject(m.onUse.placeObject);(null==R?void 0:null===($=R.sprite)||void 0===$?void 0:$.image)&&(C.image=R.sprite.image,C.width=null===(B=R.sprite.size)||void 0===B?void 0:B.width,C.height=null===(V=R.sprite.size)||void 0===V?void 0:V.height,C.height<=40&&C.width<=40?C.scale=3:C.height<=90&&C.width<=90?C.scale=2:C.scale=1)}}return C.image=(0,U.b7)(C.image),C}let handleShare=(m,R)=>{navigator.share?navigator.share({...R?{title:R}:{},url:m}).then(()=>{}).catch(console.error):navigator.clipboard&&(navigator.clipboard.writeText(m),$.e.set(B.W_,[{source:"other",text:{id:"Link Copied to Clipboard"}}]))},getSpeckMapId=m=>null==m?void 0:m.find(m=>/rent/gi.test(m)),i18nKeyFromID=function(m){let R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name";return"".concat(null==m?void 0:m.replace(/\)|\(/g,"_"),"_").concat(R)}},42379:function(m,R,C){"use strict";C.d(R,{LB:function(){return U},Yx:function(){return L},oQ:function(){return T}});let T=!0,L=!1,U="".concat("https","://").concat("pixels-server.pixels.xyz")},71343:function(m,R,C){"use strict";var T,L;C.d(R,{m:function(){return T}}),(L=T||(T={})).timeSync="timeSync",L.joinRoom="joinRoom",L.sendMapLibrary="sendMapLibrary",L.moveSelfPlayer="mv",L.swapOrCombineInventorySlots="swapOrCombineInventorySlots",L.changeEquipmentBar="changeEquipmentBar",L.addMessageToChat="addMessageToChat",L.setTypingState="setTypingState",L.setTosAccepted="setTosAccepted",L.playerNotification="playerNotification",L.receiveMessageInChat="receiveMessageInChat",L.setAvatar="setAvatar",L.setPet="setPet",L.setPetName="setPetName",L.useItem="ui",L.useItemError="useItemError",L.talkToNPC="talkToNPC",L.clickEntity="clickEntity",L.closeDialog="closeDialog",L.collideWithObject="collideWithObject",L.teleportPlayer="teleportPlayer",L.timerCheck="timerCheck",L.collectMailboxItem="collectMailboxItem",L.fetchMailbox="fetchMailbox",L.subscribe="subscribe",L.rentFarm="rentFarm",L.buyStoreItem="buyStoreItem",L.sellStoreItem="sellStoreItem",L.updateMapMembers="updateMapMembers",L.updateRolesAndPermissions="updateRolesAndPermissions",L.updateRoomRestrictions="updateRoomRestrictions",L.updateMapListing="updateMapListing",L.claimNftMap="claimNftMap",L.updateRoomName="updateRoomName",L.updatePlayer="updatePlayer",L.bookmarkMap="bookmarkMap",L.buildObject="buildObject",L.buildTile="buildTile",L.buildEntity="buildEntity",L.upgradeFarm="upgradeFarm",L.presentUI="presentUI",L.clientCmd="clientCmd",L.playerAction="playerAction",L.clientTrigger="clientTrigger",L.trade="trade",L.marketplace="marketplace",L.reportPlayer="reportPlayer",L.mintUgc="mintUgc",L.findNFTs="findNFTs",L.sellOrders="sellOrders",L.sellOrderFill="sellOrderFill",L.sellOrderFetch="sellOrderFetch",L.sellOrderReset="sellOrderReset"},79274:function(m,R,C){"use strict";var T,L;C.d(R,{h3:function(){return U},nA:function(){return $},oi:function(){return B}}),(L=T||(T={})).forge="forge",L.cooking="cooking",L.woodwork="woodwork",L.windmill="windmill",L.textile_mill="textile_mill",L.kiln="kiln",L.quantum_recombinator="quantum_recombinator",L.winery="winery",L.industries="industries",L.gridcraftManufacturing="gridcraftManufacturing",L.gridcraftPacking="gridcraftPacking",L.pattyMaker="pattyMaker",L.foodProcessor="foodProcessor",L.grill="grill",L.assemblyTable="assemblyTable",L.deepFryer="deepFryer";let U=Object.keys(T),$=["farming","forestry","cooking","mining","woodwork","metalworking","stoneshaping","petcare","business","exploration","granger","ceramicist","beekeeping","textiler","aviculture","redifferentiator","slugger","winemaking","fishing"],B={forge:"ceramicist",cooking:"cooking",woodwork:"woodwork",windmill:"granger",textile_mill:"textiler",kiln:"ceramicist",quantum_recombinator:"redifferentiator",winery:"winemaking",industries:"redifferentiator",gridcraftManufacturing:"business",gridcraftPacking:"business",pattyMaker:"cooking",foodProcessor:"cooking",grill:"cooking",assemblyTable:"cooking",deepFryer:"cooking"}},51465:function(m,R,C){"use strict";var T,L;C.d(R,{m:function(){return T}}),(L=T||(T={}))[L.loop=1]="loop",L[L.click=2]="click",L[L.approach=4]="approach",L[L.approachloop=5]="approachloop"},64939:function(m,R,C){"use strict";C.d(R,{m3:function(){return T.m},vn:function(){return L},jK:function(){return U}});var T=C(51465);let L=3,U=1e3},16562:function(m,R,C){"use strict";let T;C.d(R,{l:function(){return GameStateManager}});var L,U,$=C(7767),B=C(34377),V=C(71343),H=C(70247),G=C(60604),q=C(23493),W=C.n(q);let UndoAction=class UndoAction{constructor(m,R){this.command=m,this.payload=R}};let EditorUndoList=class EditorUndoList{pushNewObject(m){for(let C=0;C{C.update[m]=R[m]});break;case"add":C.type="remove",C.remove={_id:""};break;case"remove":if(C.type="add",!m.remove||!(R=H.Z.getMapObject(m.remove._id)))return!1;C.add={...R}}this.queue.push(new UndoAction(V.m.buildObject,C))}pushEntity(m,R){let C;let T={action:"move"};switch(m.action){case"move":if(T.action="move",!m.move||!R||!(C=R.get(m.move._id)))return!1;T.move={_id:m.move._id,label:C.label,x:C.position.x,y:C.position.y};break;case"add":T.action="remove",T.remove={_id:""};break;case"remove":if(T.action="add",!m.remove||!R||!(C=R.get(m.remove._id)))return!1;T.add={_id:m.remove._id,x:C.position.x,y:C.position.y,entity:C.entity,label:C.label}}this.queue.push(new UndoAction(V.m.buildEntity,T))}pushTiles(m,R){let C={action:"update"};C.update=m.map(m=>{let C=null==R?void 0:R[m._id];return C?{_id:m._id,tileset:m.tileset,x:C.x,y:C.y,width:C.width,index:C.index,indexes:C.indexes?[...C.indexes]:void 0}:{_id:m._id,tileset:m.tileset,x:m.x,y:m.y,width:0,indexes:[]}}),this.queue.push(new UndoAction(V.m.buildTile,C))}constructor(){this.queue=[]}};var Z=C(95047);let calculateAllOnlinePlayers=m=>{let R=[],C=[];try{return null==m||m.forEach(m=>{var C,T,L;null!==(L=null===(T=m.metadata)||void 0===T?void 0:null===(C=T.worlds)||void 0===C?void 0:C.length)&&void 0!==L&&L&&m.metadata.worlds.forEach((m,C)=>{var T;null!==m&&(R[C]=(null!==(T=R[C])&&void 0!==T?T:0)+m)})}),chooseAvailableWorlds(R)}catch(m){return console.log("worlds lookup",m),{total:0,maxPlayersPerWorld:1e3,numberOfWorlds:C.length,worlds:C}}},chooseAvailableWorlds=m=>{let R=0,C=[],T=0,L=0;try{"function"==typeof(null==m?void 0:m.forEach)&&m.forEach((m,U)=>{0===U||null===m||99===U||U>500||(C.push({id:U,name:"World "+U,players:Math.max(0,m)}),m<1600&&T++,m<=0&&L++,R+=m)});for(let R=1;R<=4;R++)(void 0===m[R]||null===m[R])&&(C.push({id:R,name:"World "+R,players:0}),T++,L++);if(0===L&&T<2){C.sort((m,R)=>m.id-R.id);let m=0;for(;mm+1);m++);if(m+1<80){let R=(m+1).toString();C.push({id:R,name:"World "+R,players:0})}}return{total:R,numberOfWorlds:C.length,maxPlayersPerWorld:2e3,worlds:C}}catch(m){return console.log("worlds lookup",m),0===C.length&&C.push({id:9,name:"Wiggly World",players:100}),{total:R,maxPlayersPerWorld:2e3,numberOfWorlds:C.length,worlds:C}}};let WorldService=class WorldService{async fetchWorldData(){try{let m=await Z.Z.getWorldTotals(),R=chooseAvailableWorlds(null!=m?m:[]);return R}catch(m){console.log("worlds error",m)}return calculateAllOnlinePlayers([])}constructor(m){this.client=m}};var Y=C(80535),K=C(77497),J=C(6354);(L=U||(U={}))[L.ROOM_UNINITIALIZED=4008]="ROOM_UNINITIALIZED",L[L.DISCONNECTED=4009]="DISCONNECTED",L[L.INVALID_TELEPORT=4010]="INVALID_TELEPORT",L[L.INVALID_JOIN=4011]="INVALID_JOIN",L[L.JOIN_IN_PROGRESS=4013]="JOIN_IN_PROGRESS",L[L.DUPLICATE_ROOM=4242]="DUPLICATE_ROOM",L[L.PLAYER_NOT_FOUND=4501]="PLAYER_NOT_FOUND",L[L.INVALID_SESSION=4503]="INVALID_SESSION",L[L.ROOM_FULL=4504]="ROOM_FULL",L[L.INVALID_AVATAR=4505]="INVALID_AVATAR",L[L.INVALID_USERNAME=4506]="INVALID_USERNAME",L[L.AUTHENTICATION_FAILED=4507]="AUTHENTICATION_FAILED",L[L.INCORRECT_CLIENT_VERSION=4509]="INCORRECT_CLIENT_VERSION",L[L.NEED_RECAPTCHA=4511]="NEED_RECAPTCHA",L[L.AUTHENTICATION_EXPIRED=4512]="AUTHENTICATION_EXPIRED",L[L.PLAYER_BANNED=4521]="PLAYER_BANNED",L[L.BAD_RECAPTCHA=4567]="BAD_RECAPTCHA",L[L.ROOM_DISPOSING=4595]="ROOM_DISPOSING",L[L.VELOCITY_CONTROL=4596]="VELOCITY_CONTROL",L[L.SERVER_MAINTENANCE=4597]="SERVER_MAINTENANCE",L[L.INVALID_WORLD=4777]="INVALID_WORLD",L[L.INVALID_MAP=4978]="INVALID_MAP",L[L.LOGGING_OUT=4997]="LOGGING_OUT",L[L.ABANDONED=4998]="ABANDONED",L[L.LOGGED_IN=4999]="LOGGED_IN";let X="".concat("wss","://").concat("pixels-server.pixels.xyz"),Q=null,ee={[B.Yi.PLAYER_MOVING]:{command:V.m.moveSelfPlayer,throttle:!0,adapter:m=>{let R=-4&Math.floor(Date.now()/1e5),C=Math.round(m.position.x)*(R%1e3)+Math.round(m.position.y)*(R%23)+R%111;return[C,m.position.x,m.position.y,m.velocity.x,m.velocity.y]}},[B.qM.PLAYER_USED_ITEM]:{command:V.m.useItem,adapter:m=>{var R,C,T,L,U,$,B;return{id:null===(R=m.item)||void 0===R?void 0:R.id,type:null===(C=m.target)||void 0===C?void 0:C.type,slot:null===(T=m.item)||void 0===T?void 0:T.inventorySlot,mid:null===(L=m.target)||void 0===L?void 0:L.mid,x:null===(U=m.target)||void 0===U?void 0:U.x,y:null===($=m.target)||void 0===$?void 0:$.y,tiles:null===(B=m.target)||void 0===B?void 0:B.tiles}}},[V.m.clickEntity]:{command:V.m.clickEntity},[V.m.timerCheck]:{command:V.m.timerCheck,throttle:!0},[B.qM.PLAYER_CLICKED_NPC]:{command:V.m.talkToNPC,adapter:m=>m},[B.Yi.NPCDIALOG_CLOSE]:{command:V.m.closeDialog,adapter:m=>m},[B.Yi.TRIGGER_EVENT]:{command:V.m.collideWithObject,adapter:m=>({objectId:m.targetId,trigger:m.trigger})},[B.Yi.NFT_SELECTED]:{command:V.m.setAvatar,adapter:m=>m},[B.Yi.PET_SELECTED]:{command:V.m.setPet},[B.Yi.PET_RENAME]:{command:V.m.setPetName},[B.Yi.CHAT_MESSAGE_SEND]:{command:V.m.addMessageToChat},[B.Yi.SET_TYPING_STATE]:{command:V.m.setTypingState,throttle:!0},[B.fb.SET_TOS_ACCEPTED]:{command:V.m.setTosAccepted},[B.Yi.FARM_CLAIM]:{command:V.m.rentFarm},[B.Yi.FIND_NFT]:{command:V.m.findNFTs},[B.Yi.PUSH_SUBSCRIBE]:{command:V.m.subscribe},[B.Yi.BUY_STORE_ITEM]:{command:V.m.buyStoreItem},[B.Yi.SELL_STORE_ITEM]:{command:V.m.sellStoreItem},[B.fb.BOOKMARK_MAP]:{command:V.m.bookmarkMap},[B.qM.BUILD_OBJECT]:{command:V.m.buildObject,adapter:m=>(T||(T=new EditorUndoList),T.pushObject(m),m)},[B.qM.BUILD_TILE]:{command:V.m.buildTile,adapter:m=>(T||(T=new EditorUndoList),m)},[B.qM.BUILD_ENTITY]:{command:V.m.buildEntity,adapter:m=>(T||(T=new EditorUndoList),T.pushEntity(m,GameStateManager.getInstance().getMapEntities()),m)},[B.qM.UPGRADE_FARM]:{command:V.m.upgradeFarm},[B.qM.ROOM_RESTRICTIONS]:{command:V.m.updateRoomRestrictions},[B.qM.ROOM_PERMISSIONS]:{command:V.m.updateRolesAndPermissions},[B.qM.ROOM_OWNERSHIP]:{command:V.m.updateMapListing},[B.qM.CLAIM_NFTMAP]:{command:V.m.claimNftMap,adapter:m=>m},[B.qM.ROOM_MEMBERS]:{command:V.m.updateMapMembers},[B.qM.ROOM_NAME]:{command:V.m.updateRoomName,adapter:m=>({name:m})},[B.fb.TRADE_SEND]:{command:V.m.trade},[B.fb.MARKETPLACE_SEND]:{command:V.m.marketplace},[B.fb.REPORT_PLAYER]:{command:V.m.reportPlayer},[B.Yi.FETCH_MAIL]:{command:V.m.fetchMailbox},[B.Yi.COLLECT_MAIL_ITEM]:{command:V.m.collectMailboxItem},[B.Yi.MINT_UGC]:{command:V.m.mintUgc},[B.Yi.CLIENT_TRIGGER]:{command:V.m.clientTrigger,adapter:m=>({...m})}};let GameStateManager=class GameStateManager{get chatMessages(){var m;return null===(m=this.room)||void 0===m?void 0:m.state.chatMessages}get mapLabels(){var m,R;return null!==(R=null===(m=this.room)||void 0===m?void 0:m.state.labels)&&void 0!==R?R:[]}get mapType(){var m,R;return null!==(R=null===(m=this.room)||void 0===m?void 0:m.state.type)&&void 0!==R?R:"public"}get mapTraits(){var m,R,C;return null===(m=null===(C=this.room)||void 0===C?void 0:null===(R=C.state)||void 0===R?void 0:R.nft)||void 0===m?void 0:m.traits}get currentPlayer(){var m,R;return{core:null===(R=this.room)||void 0===R?void 0:R.state.players.get(null===(m=this.room)||void 0===m?void 0:m.sessionId),full:this.selfPlayer}}get mapId(){var m;return(null===(m=this.room)||void 0===m?void 0:m.state.id)||""}get mapStorageId(){var m;return(null===(m=this.room)||void 0===m?void 0:m.state.mid)||""}get marketPlaceSellLimit(){var m,R;return null!==(R=null===(m=this.room)||void 0===m?void 0:m.state.mpSell)&&void 0!==R?R:1500}get marketPlaceBuyLimit(){var m,R;return null!==(R=null===(m=this.room)||void 0===m?void 0:m.state.mpBuy)&&void 0!==R?R:700}static getInstance(){return GameStateManager.singleton||(GameStateManager.singleton=new GameStateManager),GameStateManager.singleton}getMapEntities(){var m,R;return null===(m=null===(R=this.room)||void 0===R?void 0:R.state)||void 0===m?void 0:m.entities}getEntityByUniqueId(m){var R,C;return(null===(R=this.getMapEntities())||void 0===R?void 0:R.get(m))||(null===(C=this.selfPlayer)||void 0===C?void 0:C.entities.get(m))}getPlayerSessionIdByMid(m){var R,C;if(!m)return;let T=null===(C=this.room)||void 0===C?void 0:null===(R=C.state)||void 0===R?void 0:R.players;if(T){for(let[R,C]of T.entries())if(C.mid===m)return R}}getPlayerCoreBySessionId(m){var R,C;if(this.isSelfPlayer(m))return this.currentPlayer.core;let T=null===(R=this.room)||void 0===R?void 0:R.state.players.get(m);if(T)return null===(C=this.players)||void 0===C?void 0:C.get(T.mid)}getSessionId(){var m;return null===(m=this.room)||void 0===m?void 0:m.sessionId}getMapStorage(){var m;return null===(m=this.room)||void 0===m?void 0:m.state.storage}addMapEntity(m){let R=this.getMapEntities();R&&R.set(m.mid,m)}getSoilEntity(m){return this.getEntityByUniqueId(m)}hasJoystick(){var m;return!!(null===(m=this.scene)||void 0===m?void 0:m.hasJoystick())}peekLeftMap(){let m=this.mapId,R=null==m?void 0:m.match(/NFT.*-(\d+)/),C=!!R&&!!R[1]&&parseInt(R[1]);if(C)1===C?C=5e3:C--;else{let m=(Date.now()-this.serverTimeDelta)/1e3%86400;C=1+Math.floor(m/17.28)%5e3}return"pixelsNFTFarm-".concat(C)}peekRightMap(){let m=this.mapId,R=null==m?void 0:m.match(/NFT.*-(\d+)/),C=!!R&&!!R[1]&&parseInt(R[1]);if(C)5e3===C?C=1:C++;else{let m=((Date.now()-this.serverTimeDelta)/1e3+43200)%86400;C=1+Math.floor(m/17.28)%5e3}return"pixelsNFTFarm-".concat(C)}registerEvents(){let sendCommand=(m,R,C)=>{if(!C||!this.room||this.room.sessionId!==C){console.log("message ignored because room not loaded",m);return}this.room.send(m,R)};Object.entries(ee).forEach(m=>{let[R,C]=m,T=C.throttle?W()(sendCommand,250):sendCommand;B.ZP.registerEventListener(R,m=>{var R;T(C.command,C.adapter?C.adapter(m):m,null===(R=this.room)||void 0===R?void 0:R.sessionId)})});let registerTypedEvent=(m,R)=>{let C=R.throttle?W()(sendCommand,250):sendCommand;m.subscribe(m=>{var T;let L=R.adapter?R.adapter(m):m;C(R.command,L,null===(T=this.room)||void 0===T?void 0:T.sessionId)})};registerTypedEvent(B.rV.inventory.swapItems,{command:V.m.swapOrCombineInventorySlots}),registerTypedEvent(B.rV.inventory.changeActiveRow,{command:V.m.changeEquipmentBar,throttle:!0}),registerTypedEvent(B.rV.sellOrders.fetch,{command:V.m.sellOrderFetch}),registerTypedEvent(B.rV.sellOrders.fill,{command:V.m.sellOrderFill}),registerTypedEvent(B.rV.sellOrders.reset,{command:V.m.sellOrderReset})}undoCommand(){if(T){console.log("undo list exists");let R=T.popObject();if(R){var m;console.log("sending undo",R.command,R.payload),null===(m=this.room)||void 0===m||m.send(R.command,R.payload)}}}checkParams(){let m=new URLSearchParams(window.location.search);m.has("mockEthAddress")&&m.get("mockEthAddress"),m.has("trigger")&&(Q=m.get("trigger"))}isSelfPlayer(m){var R;return m===(null===(R=this.room)||void 0===R?void 0:R.sessionId)}initPlayers(){var m,R,C;if(this.players=new Map,"private"===this.room.state.type||"tutorial"===this.room.state.type){let R=this.currentPlayer;R&&(null===(m=this.players)||void 0===m||m.set(R.core.mid,R.core))}else null===(C=this.room)||void 0===C||null===(R=C.state)||void 0===R||R.players.forEach((m,R)=>{var C;null===(C=this.players)||void 0===C||C.set(m.mid,m),this.isSelfPlayer(R)||this.setupOtherPlayer(m,R)})}handleDisconnect(){var m;null===(m=this.room)||void 0===m||m.onLeave(m=>{var R,C,T,L;if(null===(C=this.currentPlayer)||void 0===C?void 0:null===(R=C.core)||void 0===R?void 0:R.isGuest){console.log("disconnected, code=",m),null===(T=this.room)||void 0===T||T.removeAllListeners();return}if(B.ZP.sendEvent(B.fb.ROOM_LEAVE),this.room){if(console.log("disconnected, code=",m),this.room.removeAllListeners(),null===(L=this.playerSerializer)||void 0===L||L.teardown(),this.playerSerializer=void 0,this.selfPlayer=void 0,this.room=void 0,4999===m){B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["playerKicked","We offer our humble apologies. You have been disconnected from the game server as a result of joining from another device or browser window. Multiple connections are not permitted."]});return}B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:"lostConnection"})}})}handleRoomEvents(){var m;this.room&&(this.room.onMessage(V.m.timeSync,m=>{(null==m?void 0:m.ms)&&(this.serverTimeDelta=Date.now()-m.ms,console.log("time delta ".concat(this.serverTimeDelta,"ms")))}),this.room.state.listen("ownerAddress",m=>{B.ZP.sendEvent(B.fb.ROOM_OWNER_CHANGED,m)}),this.room.state.listen("name",()=>{this.room&&B.ZP.sendEvent(B.fb.ROOM_NAME_CHANGED,this.room.state.name)}),this.room.state.listen("guild",()=>{this.room&&B.ZP.sendEvent(B.fb.ROOM_GUILD_CHANGED,this.room.state.guild)}),this.room.state.permissions.onChange(()=>{if(!this.room)return;let m=JSON.parse(JSON.stringify(this.room.state.permissions));B.ZP.sendEvent(B.fb.ROOM_PERMISSIONS_CHANGED,m)}),this.room.state.restrictions.onChange(()=>{if(!this.room)return;let m=JSON.parse(JSON.stringify(this.room.state.restrictions));B.ZP.sendEvent(B.fb.ROOM_RESTRICTIONS_CHANGED,m)}),this.room.state.ownership&&this.room.state.ownership.onChange(()=>{if(!this.room)return;let m=JSON.parse(JSON.stringify(this.room.state.ownership));B.ZP.sendEvent(B.fb.ROOM_OWNERSHIP_CHANGED,m)}),this.room.state.members.onAdd(()=>{if(!this.room)return;let m=JSON.parse(JSON.stringify(this.room.state.members));B.ZP.sendEvent(B.fb.ROOM_MEMBERS_CHANGED,m)}),this.room.state.members.onRemove(()=>{if(!this.room)return;let m=JSON.parse(JSON.stringify(this.room.state.members));B.ZP.sendEvent(B.fb.ROOM_MEMBERS_CHANGED,m)}),null===(m=this.room)||void 0===m||m.onMessage("*",(m,R)=>{if(this.room)try{var C,L,U,$,G,q,W,Z,X,Q,ee,et,er,en,eo,ei,ea;switch(m){case V.m.updatePlayer:null===(C=this.playerSerializer)||void 0===C||C.patch(R),this.applyStateChanges();break;case V.m.talkToNPC:B.ZP.sendEvent(B.fb.NPC_SPEAKS,R);break;case V.m.receiveMessageInChat:B.ZP.sendEvent(B.fb.CHAT_MESSAGE_RCV,{...R,whisper:!0});break;case V.m.buildObject:T&&"add"===R.action&&T.pushNewObject(R._id),"add"===R.action||"update"===R.action?H.Z.addMapObject(R):"remove"===R.action&&H.Z.removeMapObject(R),B.ZP.sendEvent(B.fb.SERVER_BUILD_NODE,{...R,type:"object"});break;case V.m.buildTile:R.update&&(T&&"update"!==R.action&&T.pushTiles(R.update,H.Z.getMapTiles()),H.Z.updateMapTiles(R.update)),B.ZP.sendEvent(B.fb.SERVER_BUILD_NODE,{type:"tile",...R});break;case V.m.useItem:B.ZP.postEvent("CONFIRM_USEITEM",R),null===(L=this.scene)||void 0===L||L.playerUsedItem(R);break;case V.m.useItemError:if("cannot-overwater"===R.message)break;B.rV.playSound.emit("snd_ui_error");let es=R.item&&(null===(U=H.Z.getGameItem(R.item))||void 0===U?void 0:U.image),el={source:"item",icon:es,text:{id:R.message},deduplicationKey:R.message};Y.e.set(K.W_,[el]);break;case V.m.teleportPlayer:B.ZP.sendEvent(B.fb.ROOM_WARP,{mapId:R.mapId,spawn:R.spawn,source:R.source,abort:R.abort});break;case V.m.playerAction:"play"===R.action?(R.sound&&B.rV.playSound.emit(R.sound),(null===($=R.animation)||void 0===$?void 0:$.name)&&(R.target&&"self"!==R.target?null===(q=this.scene)||void 0===q||q.playNodeAnimation({mid:R.target,animation:R.animation.name,position:R.animation.position,emoji:R.emoji,pet:!1}):null===(G=this.scene)||void 0===G||G.playPlayerAnimation(R.animation.name))):"stop"===R.action?R.sound&&(console.log("stopping sound ".concat(R.sound)),B.ZP.postEvent("STOP_SOUND",R.sound)):"petplay"===R.action?R.emoji&&(null===(X=this.scene)||void 0===X||X.playNodeAnimation({mid:null!==(Q=R.target)&&void 0!==Q?Q:"",animation:null!==(ee=null===(W=R.animation)||void 0===W?void 0:W.name)&&void 0!==ee?ee:"",position:null===(Z=R.animation)||void 0===Z?void 0:Z.position,emoji:R.emoji,pet:!0})):"tween"===R.action&&R.tweenTo&&(null===(et=this.scene)||void 0===et||et.playNodeAnimation({mid:null!==(er=R.target)&&void 0!==er?er:"",animation:null!==(en=R.tweenTo.animation)&&void 0!==en?en:"",position:{x:R.tweenTo.x,y:R.tweenTo.y},tween:{duration:R.tweenTo.ms,easing:null!==(eo=R.tweenTo.ease)&&void 0!==eo?eo:"cubic"}}));break;case V.m.playerNotification:Y.e.set(K.W_,[R]),(null==R?void 0:R.source)==="item"&&(null===(ei=R.text)||void 0===ei?void 0:ei.count)>0&&(null===(ea=R.stacking)||void 0===ea?void 0:ea.key)&&B.ZP.sendEvent(B.fb.PLAYER_INVENTORY_NEW,{item:R.stacking.key});break;case V.m.sellOrders:Y.e.set(J.v,R);break;case V.m.clientCmd:B.ZP.sendEvent(B.fb.CLIENT_CMD,R);break;case V.m.presentUI:B.ZP.sendEvent(B.fb.PRESENT_UI,R);break;case V.m.trade:B.ZP.sendEvent(B.fb.TRADE_RECEIVE,R);break;case V.m.marketplace:B.ZP.sendEvent(B.fb.MARKETPLACE_RECEIVE,R);break;case V.m.setAvatar:B.ZP.sendEvent(B.fb.PLAYER_AVATAR,R);break;case V.m.bookmarkMap:B.ZP.sendEvent(B.fb.BOOKMARK_MAP,R);break;case V.m.fetchMailbox:console.log("received mailbox items"),B.ZP.sendEvent(B.fb.RECEIVE_MAIL,R);break;case V.m.collectMailboxItem:B.ZP.sendEvent(B.fb.COLLECT_MAIL_ITEM_RESPONSE,R);break;case V.m.findNFTs:B.ZP.sendEvent(B.Yi.FOUND_NFT,R);break;default:console.warn("Unhandled server message",m,R)}}catch(C){console.error("exception in message",C,"from message",m,R)}}),this.handleDisconnect())}applyStateChanges(){this.updatedEntities.forEach(m=>{this.entityUpdated(m)}),this.updatedEntities.clear(),this.updatedPet&&(this.selfPetupdate(),this.updatedPet=!1),this.updatedInventory&&(this.inventoryChanged(),this.updatedInventory=!1)}handleRoomUpdates(){if(!this.room)return;this.room.onStateChange(()=>{this.applyStateChanges()}),this.room.state.entities.forEach(m=>{this.monitorEntity(m)}),this.room.state.entities.onAdd(m=>{var R;null===(R=this.scene)||void 0===R||R.addEntityElement(void 0,m.toJSON()),T&&T.pushNewEntity(m.mid),this.monitorEntity(m),B.ZP.sendEvent(B.fb.SERVER_BUILD_NODE,{_id:m.mid,action:"add",type:"entity"})},!1),this.room.state.entities.onRemove(m=>{var R;let C=H.Z.getGameEntity(m.entity);null===(R=this.scene)||void 0===R||R.removeEntityElement(m.mid,null==C?void 0:C.type),B.ZP.sendEvent(B.fb.SERVER_BUILD_NODE,{_id:m.mid,action:"remove",type:"entity"})}),this.room.state.chatMessages.onAdd(m=>{var R;(null===(R=this.room)||void 0===R?void 0:R.state)&&"private"!==this.room.state.type&&"tutorial"!==this.room.state.type&&B.ZP.sendEvent(B.fb.CHAT_MESSAGE_RCV,{...m})},!1);let m=this.room.state.storage;(null==m?void 0:m.slots)&&(m.slots.onAdd(m=>{this.monitorSlot(m)}),m.slots.onRemove(()=>this.updatedInventory=!0)),this.room.state.levels.onAdd((m,R)=>{let C=JSON.parse(JSON.stringify(m));B.ZP.sendEvent(B.fb.ROOM_LEVEL_ADD,{key:R,level:C}),this.monitorLevel(R,m,"room")}),this.room.state.players.onAdd((m,R)=>{var C,T,L;this.room&&((null===(C=this.room.state)||void 0===C?void 0:C.type)==="private"||(null===(T=this.room.state)||void 0===T?void 0:T.type)==="tutorial"||(null===(L=this.players)||void 0===L||L.set(m.mid,m),B.ZP.sendEvent(B.fb.PLAYER_JOINED,{username:m.username,sessionId:R,id:m.mid}),this.isSelfPlayer(R)||setTimeout(()=>this.setupOtherPlayer(m,R),10)))},!1),this.room.state.players.onRemove((m,R)=>{var C,T,L,U;this.room&&(null===(C=this.room.state)||void 0===C?void 0:C.type)!=="private"&&(null===(T=this.room.state)||void 0===T?void 0:T.type)!=="tutorial"&&(null===(L=this.players)||void 0===L||L.delete(m.mid),B.ZP.sendEvent(B.fb.PLAYER_REMOVED,{username:m.username,id:m.mid}),null===(U=this.scene)||void 0===U||U.playerLeave(R,m.mid))})}async disconnect(){var m,R;if(!this.room)return Promise.resolve(-1);let{room:C}=this;this.room.removeAllListeners(),null===(m=this.playerSerializer)||void 0===m||m.teardown(),this.playerSerializer=void 0,this.selfPlayer=void 0,this.room=void 0;let T=C.leave(!0);return null===(R=this.players)||void 0===R||R.clear(),this.scene=void 0,B.ZP.sendEvent(B.fb.ROOM_LEAVE),T}doJoin(m){return new Promise((R,C)=>{let T=1,L="",retryJoin=async()=>{if("need-recaptcha"!==L||m.recaptcha)T>1&&B.ZP.postEvent(B.fb.SLOW_LOAD,{retry:T});else{let R=Z.Z.getStytchTelemetry().then(R=>{m.telemetryId=R}).catch();if(await Promise.all([R]),!m.telemetryId){C({message:"no-telemetryId-available"});return}}Z.Z.getRoomId(m.mapId,m.world).then(U=>{this.client.joinById(U,m).then(m=>R(m)).catch(m=>{console.error("error from colyseus",JSON.stringify(m)),L=null==m?void 0:m.message,GameStateManager.permanentErrors.includes(null==m?void 0:m.message)?C(m):GameStateManager.retryErrors.includes(null==m?void 0:m.message)&&T<8?(setTimeout(retryJoin,5e3),T+=1):T>=2?C(m):(setTimeout(retryJoin,3e3),T+=1)})}).catch(m=>{console.error("error from getRoomId",JSON.stringify(m)),L=null==m?void 0:m.message,GameStateManager.permanentErrors.includes(null==m?void 0:m.message)?C(m):T>=2?C(m):(setTimeout(retryJoin,3e3),T+=1)})};retryJoin()})}async connect(m,R,C,L,V,q,W,Z,Y){var K,J;this.scene=L,this.firstLoad&&(this.registerEvents(),this.firstLoad=!1);let X={};if(C){let m=C.split(",");X.label=m[0],m.length>=3&&(X.offset={x:parseInt(m[1],10),y:parseInt(m[2],10)})}T=void 0;try{this.room&&(console.log("double join happened!"),await this.disconnect()),console.log("joining map ".concat(m,": ").concat(Y)),window.globalRoom=this.room=await this.doJoin({mapId:m,token:V||"iamguest",isGuest:!V,cryptoWallet:{},username:W,playerId:Z,world:R,ver:G.WX,...X,avatar:V||!q?"":JSON.stringify(q),lastSavedAt:Y})}catch(m){if((null==m?void 0:m.code)===U.SERVER_MAINTENANCE)B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:null!==(K=m.message)&&void 0!==K?K:"server-maintenance"});else if((null==m?void 0:m.code)===U.PLAYER_BANNED){let R=m.message.split("+|=|+"),C="playerIsBanned",T="It's cool to be in a band. Not so cool to get BANNED. You can find the appeal form in our help center";R.length>1&&R[1]&&(C=R[1],T=R[1]),B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:[C,T]})}else(null==m?void 0:m.message)?"room-is-full"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:"roomFull"}):"join-in-progress"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["joinInProgress","Your account was in process of joining a room already. You cannot be connected until the prior attempt completes"]}):"user-logging-out"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["userLoggingOut","Sorry, it is taking longer than expected to save your progress from the previous location. You can try again in a few seconds"]}):"velocity-control"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["velocityControl","The room you tried to join has too many players. Try choosing a different world."]}):"invalid-token"===m.message||"player-not-found"===m.message||"could-not-authenticate"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["authenticationFailed","To say you are who you are may be contrary to fact. Your authentication was not so authenticated."]}):"authentication-expired"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["authenticationExpired","You were there, now you are here. My head is spinning. Just...try again, please."]}):"invalid-permissions"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["invalidPermissionsToJoinRoom","The room owner did not let you in. Did you remember to knock nicely? Permission denied!"]}):"user-already-logged-in"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:"alreadyLoggedIn"}):"transfer-in-progress"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["transferInProgress","There is a lot at stake, so you must take a break, and wait for your transfer to take"]}):"invalid-client-version"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["updateClient","No matter how hard you try to avoid it, things change. And so do you. Please refresh page for a new beginning."]}):"no-recaptcha-available"===m.message||"no-telemetryId-available"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["noRecaptcha","Dude, where's my server? Please disable ad blockers or other plugins"]}):"invalid-map"===m.message?B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["mapNotFound","I see you brought your ticket to the dance, but there is no dancehall here. invalid-map"]}):B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:[m.message,"Sorry, we couldn't enter you into the game. Care to try again? (".concat(m.message,")")]}):B.ZP.sendEvent(B.fb.SVR_CANNOTCONNECT,{message:["joinFailed","It appears likely your destination failed to exist. If you attempt to join again, who knows where you might land? Get it? L-A-N-D. Me, neither."]});return}this.playerSerializer=new $.mV;let ee=new Promise(m=>{var R;null===(R=this.room)||void 0===R||R.onMessage("joinRoom",R=>{H.Z.setMapLibrary(R.config),this.playerSerializer.handshake(R.handshake),this.playerSerializer.setState(R.serialPlayer);let C=this.playerSerializer.getState();m(C)})});this.handleRoomEvents();let et=new Promise(m=>{this.room.onStateChange.once(()=>{let R=this.room.state.players.get(this.room.sessionId);m(R)})});await Promise.all([et,ee]),this.selfPlayer=await ee;let er=await et;if(await H.Z.scanGameLibrary(this.room.state.entities),this.selfPlayer){let m=JSON.parse(JSON.stringify(this.currentPlayer));(null===(J=m.full.pet)||void 0===J?void 0:J.avatar)||delete m.full.pet,this.initPlayers(),this.setupSelfPlayerListeners(this.selfPlayer,er),this.scene.initSelfPlayerState(m),B.ZP.sendEvent(B.fb.ROOM_LOADED,{player:m,roomType:this.room.state.type,mapId:this.room.state.id,guild:this.room.state.guild,roomName:this.room.state.name,ownerAddress:this.room.state.ownerAddress,sessionId:this.room.sessionId,messages:JSON.parse(JSON.stringify(this.room.state.chatMessages)),templateName:this.room.state.templateName}),B.ZP.sendEvent(B.fb.ROOM_NAME_CHANGED,this.room.state.name),B.ZP.sendEvent(B.fb.PLAYER_ENERGY_CHANGE,{energy:JSON.parse(JSON.stringify(this.selfPlayer.energy))})}return this.handleRoomUpdates(),Q&&V&&(B.ZP.sendEvent(B.Yi.CLIENT_TRIGGER,{trigger:Q}),Q=null),V||this.room.leave(!0),this.currentPlayer}entityUpdated(m){let R=this.getEntityByUniqueId(m);if(R){var C;let m=R.toJSON();B.ZP.sendEvent(B.fb.ENTITY_UPDATE,m),null===(C=this.scene)||void 0===C||C.updateEntity(m)}else console.error("entity ".concat(m," changed but not found"))}monitorEntity(m){var R;let C=m.mid,T=H.Z.getGameEntity(m.entity);(null==T?void 0:T.type)&&m[T.type]&&m.storage&&m.storage.slots&&(m.storage.slots.onAdd(m=>{this.monitorSlot(m)}),m.storage.slots.onRemove(()=>this.updatedInventory=!0)),null===(R=m.position)||void 0===R||R.onChange(()=>{this.updatedEntities.add(C)}),m.onChange(()=>{this.updatedEntities.add(C)}),m.generic&&(m.generic.onChange(()=>{this.updatedEntities.add(C)}),m.generic.displayInfo.onChange(()=>{this.updatedEntities.add(C)}),m.generic.statics&&(m.generic.statics.onChange(()=>{this.updatedEntities.add(C)}),m.generic.statics.onAdd(()=>{this.updatedEntities.add(C)},!1),m.generic.statics.onRemove(()=>{this.updatedEntities.add(C)})),m.generic.trackers&&(m.generic.trackers.onChange(()=>{this.updatedEntities.add(C)}),m.generic.trackers.onAdd(()=>{this.updatedEntities.add(C)},!1),m.generic.trackers.onRemove(()=>{this.updatedEntities.add(C)})))}monitorAchievements(m){let R=m.achievementId;m.onChange(()=>{let m=JSON.parse(JSON.stringify(this.selfPlayer.achievements.get(R)));B.ZP.sendEvent(B.fb.PLAYER_ACHIEVEMENT_CHANGED,{achievement:m})})}monitorLevel(m,R){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"player";R.onChange(()=>{var R,T,L;if("player"===C){if(this.selfPlayer){let R=JSON.parse(JSON.stringify(this.selfPlayer.levels.get(m)));B.ZP.sendEvent(B.fb.PLAYER_LEVEL_CHANGED,{key:m,level:R})}}else if(null===(T=this.room)||void 0===T?void 0:null===(R=T.state)||void 0===R?void 0:R.levels){let R=JSON.parse(JSON.stringify(null===(L=this.room)||void 0===L?void 0:L.state.levels.get(m)));B.ZP.sendEvent(B.fb.ROOM_LEVEL_CHANGED,{key:m,level:R})}})}inventoryChanged(){if(this.selfPlayer){let m=JSON.parse(JSON.stringify(this.selfPlayer.inventory));B.ZP.sendEvent("PLAYER_INVENTORY_CHANGE",{inventory:m})}}monitorSlot(m){this.updatedInventory=!0,m.onChange(()=>{this.updatedInventory=!0})}monitorCoinSlot(m){m.onChange(m=>{let R=m.find(m=>"balance"===m.field&&m.value>m.previousValue),C=JSON.parse(JSON.stringify(this.selfPlayer.coinInventory));B.ZP.sendEvent("PLAYER_COIN_INVENTORY_CHANGE",{coinInventory:C,added:R?R.value-R.previousValue:0})})}selfPetupdate(){var m;let R=null===(m=this.selfPlayer)||void 0===m?void 0:m.pet;if(R){let m=JSON.parse(JSON.stringify(R));B.ZP.sendEvent(B.fb.PLAYER_PET_UPDATE,{full:{pet:m}})}}monitorPet(m){m.inventory&&(m.inventory.slots.onAdd(m=>this.monitorSlot(m)),m.inventory.slots.onRemove(()=>this.updatedInventory=!0)),m.scriptInstance&&m.scriptInstance.onChange(()=>this.updatedPet=!0),m.avatar&&(m.avatar.listen("name",()=>this.updatedPet=!0),m.avatar.listen("fade",()=>this.updatedPet=!0))}petChange(){let m=this.currentPlayer,R=null==m?void 0:m.full.pet;if(null==R?void 0:R.avatar){let C=JSON.parse(JSON.stringify(R));B.ZP.sendEvent(B.fb.PLAYER_PET_CHANGE,{core:{petAvatar:C.avatar,position:{x:m.core.position.x,y:m.core.position.y}},full:{pet:C}}),this.monitorPet(R)}else B.ZP.sendEvent(B.fb.PLAYER_PET_CHANGE,{core:{petAvatar:void 0},full:{pet:void 0}})}setupSelfPlayerListeners(m,R){var C,T;m.inventory.onChange(()=>{let m=JSON.parse(JSON.stringify(this.selfPlayer.inventory));B.ZP.sendEvent("PLAYER_INVENTORY_CHANGE",{inventory:m})}),(null===(C=m.pet)||void 0===C?void 0:C.avatar)&&this.monitorPet(m.pet),m.listen("pet",()=>this.petChange()),m.energy.onChange(()=>{let m=JSON.parse(JSON.stringify(this.selfPlayer.energy));B.ZP.sendEvent("PLAYER_ENERGY_CHANGE",{energy:m})}),R.currentAvatar.onChange(()=>{let m=R.currentAvatar.toJSON();B.ZP.sendEvent("PLAYER_CURRENTAVATAR_CHANGE",{currentAvatar:m})});let membershipChange=()=>{let m=R.memberships.toJSON();B.ZP.sendEvent("PLAYER_MEMBERSHIPS_CHANGE",{memberships:m})};R.memberships.onChange(membershipChange),R.memberships.onAdd(membershipChange,!1),R.memberships.onRemove(membershipChange);let moidifierChange=()=>{let m=R.modifiers.toJSON();B.ZP.sendEvent("PLAYER_MODIFIERS_CHANGE",{modifiers:m})};R.modifiers.onChange(moidifierChange),R.modifiers.onRemove(moidifierChange),R.modifiers.onAdd(moidifierChange,!1),R.listen("username",m=>{"mute"!==R.status&&"restrict"!==R.status&&"block"!==R.status&&B.ZP.sendEvent("PLAYER_USERNAME_CHANGE",{username:m})}),R.listen("status",m=>{B.ZP.sendEvent("PLAYER_USERNAME_CHANGE",{username:"mute"===m||"restrict"===m||"block"===m?"(muted)":R.username})}),m.listen("messages",m=>{B.ZP.sendEvent(B.fb.MAIL_UPDATE,{messages:m})}),m.achievements.onAdd(m=>{let R=JSON.parse(JSON.stringify(m));B.ZP.sendEvent(B.fb.PLAYER_ACHIEVEMENT_ADD,{achievement:R}),this.monitorAchievements(m)}),m.achievements.onRemove(m=>{let R=JSON.parse(JSON.stringify(m));B.ZP.sendEvent(B.fb.PLAYER_ACHIEVEMENT_REMOVED,{achievement:R})}),m.levels.onAdd((m,R)=>{let C=JSON.parse(JSON.stringify(m));B.ZP.sendEvent(B.fb.PLAYER_LEVEL_ADD,{key:R,level:C}),this.monitorLevel(R,m)}),null===(T=m.entities)||void 0===T||T.forEach(m=>{this.monitorEntity(m)}),m.entities.onAdd(m=>{var R;let C=m.toJSON();this.monitorEntity(m),B.ZP.sendEvent(B.fb.ENTITY_ADD,C),null===(R=this.scene)||void 0===R||R.addPlayerEntityNodes(C)},!1),m.entities.onRemove(m=>{var R;null===(R=this.scene)||void 0===R||R.removeEntity(m)}),m.farms.onAdd(()=>{var m;let R=JSON.parse(JSON.stringify(null===(m=this.selfPlayer)||void 0===m?void 0:m.farms));B.ZP.sendEvent("PLAYER_FARMS_CHANGE",{farms:R})},!1),m.farms.onRemove(()=>{var m;let R=JSON.parse(JSON.stringify(null===(m=this.selfPlayer)||void 0===m?void 0:m.farms));B.ZP.sendEvent("PLAYER_FARMS_CHANGE",{farms:R})}),m.inventory.slots.onAdd(m=>{this.monitorSlot(m)},!1),m.inventory.slots.forEach(m=>{this.monitorSlot(m)}),m.inventory.slots.onRemove(()=>this.updatedInventory=!0),m.coinInventory.onAdd(m=>{this.monitorCoinSlot(m)}),m.levels.onChange(()=>{let m=JSON.parse(JSON.stringify(this.selfPlayer.levels));B.ZP.sendEvent("PLAYER_EXP_CHANGE",{levels:m})}),this.questsUpdated(),m.quests.forEach(m=>{m.onChange(()=>this.questsUpdated())}),m.quests.onAdd(m=>{m.onChange(()=>this.questsUpdated()),this.questsUpdated()},!1)}questsUpdated(){if(this.selfPlayer){let m=JSON.parse(JSON.stringify(this.selfPlayer.quests));B.ZP.sendEvent("PLAYER_QUESTPROGRESS_ADDED",{quests:m})}}transformPlayerCore(m){var R;let C=JSON.parse(JSON.stringify(m));return(null===(R=C.petAvatar)||void 0===R?void 0:R.id)||delete C.petAvatar,C}setupOtherPlayer(m,R){var C;let T=this.transformPlayerCore(m),L=null===(C=this.scene)||void 0===C?void 0:C.playerJoin(T,R),updatePlayer=()=>{if(!this.room)return;let m=this.getPlayerCoreBySessionId(R);if(m){var C;T=this.transformPlayerCore(m),null===(C=this.scene)||void 0===C||C.playerJoin(T,R),m.petAvatar&&m.petAvatar.onChange(updatePlayer)}};L&&(m.velocity.onChange(()=>{let m=this.getPlayerCoreBySessionId(R);m&&L.move(m.velocity,m.position)}),m.currentAvatar.onChange(updatePlayer),m.modifiers.onChange(updatePlayer),m.listen("petAvatar",updatePlayer),m.listen("username",m=>{m!==T.username&&updatePlayer()}),m.listen("status",m=>{m!==T.status&&updatePlayer()}),m.listen("typingTimestamp",m=>{m&&L.showChatTyping()}),m.petAvatar&&m.petAvatar.onChange(updatePlayer))}constructor(){this.client=new $.KU(X),this.updateMap=!1,this.firstLoad=!0,this.serverTimeDelta=0,this.worldService=new WorldService(this.client),this.updatedEntities=new Set,this.updatedPet=!1,this.updatedInventory=!1,this.checkParams()}};GameStateManager.unwantedFarmNumbers=[0],GameStateManager.permanentErrors=["room-is-full","invalid-token","could-not-authenticate","player-not-found","invalid-permissions","bad-recaptca","bad-telemetry-data","invalid-map","invalid-client-version","player-is-banned","authentication-expired","invalid-world","server-maintenance","transfer-in-progress","teleport-unauthorized","join-in-progress"],GameStateManager.retryErrors=["user-logging-out","velocity-control"]},60604:function(m,R,C){"use strict";C.d(R,{A$:function(){return Y},BA:function(){return ee},B_:function(){return q},D9:function(){return J},DY:function(){return G},Kp:function(){return en},LI:function(){return B},Oe:function(){return el},WS:function(){return et},WX:function(){return T},XX:function(){return X},Y:function(){return eo},Z6:function(){return ea},ZD:function(){return Q},aU:function(){return H},fX:function(){return es},fd:function(){return ed},je:function(){return ec},ji:function(){return W},m6:function(){return er},p$:function(){return ei},pZ:function(){return eu},qO:function(){return U},rq:function(){return Z},sD:function(){return K},sV:function(){return L},tU:function(){return $},uT:function(){return V}});let T=6.81,L=1676498533e3,U="game-container",$="players",B=144,V=188,H=1,G=2,q=3e3,W=1250,Z=2e3,Y=1,K=30,J=32,X=21,Q=90,ee={top:0,left:0,right:6e3,bottom:6e3},et={width:ee.right-ee.left,height:ee.bottom-ee.top},er=2,en=.05,eo=100,ei=.4,ea=2,es=3/eo,el=["https://pixels.xyz","https://pixels.online"],eu="https://d31ss916pli4td.cloudfront.net",ec="https://mesh-online-assets.s3.us-east-2.amazonaws.com",ed="".concat(eu,"/game/ui/skills/skills_icon_")},34377:function(m,R,C){"use strict";C.d(R,{Vh:function(){return $},fb:function(){return B},Yi:function(){return H},qM:function(){return V},ZP:function(){return Y},rV:function(){return Z},d6:function(){return sendEnhancedControlEvent},lY:function(){return sendJoystickControlEvent},D9:function(){return sendSoundControlEvent}});var T,L,U,$,B,V,H,G=C(80535);($||($={})).RESIZE="RESIZE",(T=B||(B={})).INIT_GAME="INIT_GAME",T.GAME_OBJECT_CLICKED="GAME_OBJECT_CLICKED",T.GAME_INITIATED="GAME_INITIATED",T.GAME_CONNECTED="GAME_CONNECTED",T.ROOM_LOADED="ROOM_LOADED",T.ROOM_LEAVE="ROOM_LEAVE",T.PLAYER_JOINED="PLAYER_JOINED",T.PLAYER_CLICKED="PLAYER_CLICKED",T.PLAYER_DRAGGING="PLAYER_DRAGGING",T.PLAYER_REMOVED="PLAYER_REMOVED",T.PLAYER_ENERGY_CHANGE="PLAYER_ENERGY_CHANGE",T.PLAYER_QUESTS_ADDED="PLAYER_QUESTS_ADDED",T.PLAYER_ENTITIES_ADDED="PLAYER_ENTITIES_ADDED",T.PLAYER_QUESTS_REMOVED="PLAYER_QUESTS_REMOVED",T.PLAYER_ENTITIES_REMOVED="PLAYER_ENTITIES_REMOVED",T.PLAYER_AVATAR="PLAYER_AVATAR",T.PLAYER_PET_CHANGE="PLAYER_PET_CHANGE",T.PLAYER_PET_UPDATE="PLAYER_PET_UPDATE",T.PLAYER_COLLIDED_WITH_OBJECT="PLAYER_COLLIDED_WITH_OBJECT",T.PLAYER_UNCOLLIDED_WITH_OBJECT="PLAYER_UNCOLLIDED_WITH_OBJECT",T.NPC_SPEAKS="NPC_SPEAKS",T.PLAYER_INVENTORY_CHANGE="PLAYER_INVENTORY_CHANGE",T.PLAYER_INVENTORY_NEW="PLAYER_INVENTORY_NEW",T.PLAYER_COIN_INVENTORY_CHANGE="PLAYER_COIN_INVENTORY_CHANGE",T.PLAYER_QUESTPROGRESS_ADDED="PLAYER_QUESTPROGRESS_ADDED",T.PLAYER_EXP_CHANGE="PLAYER_EXP_CHANGE",T.PLAYER_OPEN_STORAGE="PLAYER_OPEN_STORAGE",T.CHAT_MESSAGE_RCV="CHAT_MESSAGE_RCV",T.SERVICE_COMMAND="SERVICE_COMMAND",T.SET_TOS_ACCEPTED="SET_TOS_ACCEPTED",T.REPORT_PLAYER="REPORT_PLAYER",T.SVR_CANNOTCONNECT="SVR_CANNOTCONNECT",T.GAME_OBJECT_MOUSEOVER="GAME_OBJECT_MOUSEOVER",T.GAME_OBJECT_MOUSEOUT="GAME_OBJECT_MOUSEOUT",T.LINK_OPEN="LINK_OPEN",T.ROOM_WARP="ROOM_WARP",T.LIBRARY="LIBRARY",T.BOOKMARK_MAP="BOOKMARK_MAP",T.SLOW_LOAD="SLOW_LOAD",T.ENTITY_UPDATE="ENTITY_UPDATE",T.ENTITY_REMOVE="ENTITY_REMOVE",T.ENTITY_ADD="ENTITY_ADD",T.ROOM_PERMISSIONS_CHANGED="ROOM_PERMISSIONS_CHANGED",T.ROOM_RESTRICTIONS_CHANGED="ROOM_RESTRICTIONS_CHANGED",T.ROOM_OWNERSHIP_CHANGED="ROOM_OWNERSHIP_CHANGED",T.ROOM_MEMBERS_CHANGED="ROOM_MEMBERS_CHANGED",T.ROOM_OWNER_CHANGED="ROOM_OWNER_CHANGED",T.ROOM_NAME_CHANGED="ROOM_NAME_CHANGED",T.ROOM_GUILD_CHANGED="ROOM_GUILD_CHANGED",T.ROOM_LEVEL_CHANGED="ROOM_LEVEL_CHANGED",T.ROOM_LEVEL_ADD="ROOM_LEVEL_ADD",T.PLAYER_ACHIEVEMENT_ADD="PLAYER_ACHIEVEMENT_ADD",T.PLAYER_ACHIEVEMENT_CHANGED="PLAYER_ACHIEVEMENT_CHANGED",T.PLAYER_ACHIEVEMENT_REMOVED="PLAYER_ACHIEVEMENT_REMOVED",T.PLAYER_LEVEL_CHANGED="PLAYER_LEVEL_CHANGED",T.PLAYER_LEVEL_ADD="PLAYER_LEVEL_ADD",T.PRESENT_FARM_DETAILS="PRESENT_FARM_DETAILS",T.DISMISS_FARM_DETAILS="DISMISS_FARM_DETAILS",T.PRESENT_UI="PRESENT_UI",T.CLIENT_CMD="CLIENT_CMD",T.TRADE_SEND="TRADE_SEND",T.TRADE_RECEIVE="TRADE_RECEIVE",T.MARKETPLACE_SEND="MARKETPLACE_SEND",T.MARKETPLACE_RECEIVE="MARKETPLACE_RECEIVE",T.SERVER_BUILD_NODE="SERVER_BUILD_NODE",T.RECEIVE_MAIL="RECEIVE_MAIL",T.COLLECT_MAIL_ITEM_RESPONSE="COLLECT_MAIL_ITEM_RESPONSE",T.MAIL_UPDATE="MAIL_UPDATE",(L=V||(V={})).BUILD_OBJECT="BUILD_OBJECT",L.SET_CATEGORY="SET_CATEGORY",L.SET_MODE="SET_MODE",L.SELECT_ENTITY="SELECT_ENTITY",L.ROOM_RESTRICTIONS="ROOM_RESTRICTIONS",L.ROOM_PERMISSIONS="ROOM_PERMISSIONS",L.ROOM_OWNERSHIP="ROOM_OWNERSHIP",L.ROOM_MEMBERS="ROOM_MEMBERS",L.CLAIM_NFTMAP="CLAIM_NFTMAP",L.BUILD_TILE="BUILD_TILE",L.BUILD_ENTITY="BUILD_ENTITY",L.UPGRADE_FARM="UPGRADE_FARM",L.ROOM_NAME="ROOM_NAME",L.RELEASE_FROM_CURSOR="RELEASE_FROM_CURSOR",L.PLAYER_CLICKED_NPC="PLAYER_CLICKED_NPC",L.PLAYER_USED_ITEM="PLAYER_USED_ITEM",(U=H||(H={})).TRIGGER_EVENT="TRIGGER_EVENT",U.FETCH_MAIL="FETCH_MAIL",U.COLLECT_MAIL_ITEM="COLLECT_MAIL_ITEM",U.NFT_SELECTED="NFT_SELECTED",U.PET_SELECTED="PET_SELECTED",U.PET_RENAME="PET_RENAME",U.SET_TYPING_STATE="SET_TYPING_STATE",U.CHAT_MESSAGE_SEND="CHAT_MESSAGE_SEND",U.PLAYER_MOVING="PLAYER_MOVING",U.FARM_CLAIM="FARM_CLAIM",U.BUY_STORE_ITEM="BUY_STORE_ITEM",U.SELL_STORE_ITEM="SELL_STORE_ITEM",U.MINT_UGC="MINT_UGC",U.FIND_NFT="FIND_NFT",U.FOUND_NFT="FOUND_NFT",U.PUSH_SUBSCRIBE="PUSH_SUBSCRIBE",U.NPCDIALOG_CLOSE="NPCDIALOG_CLOSE",U.CLIENT_TRIGGER="CLIENT_TRIGGER";let q=new class{get intialized(){return!!this.phaserEventEmitter}async init(){let m=await C.e(989).then(C.t.bind(C,82260,23));this.phaserEventEmitter||(this.phaserEventEmitter=new m.Events.EventEmitter,Object.values(B).forEach(m=>{this.registerEventListener(m,R=>{G.h.dispatch({type:"game/".concat(m),payload:R})})}))}registerEventListener(m,R){var C;null===(C=this.phaserEventEmitter)||void 0===C||C.on(m,R)}removeEventListerner(m,R){var C;null===(C=this.phaserEventEmitter)||void 0===C||C.removeListener(m,R)}sendEvent(m,R){var C;null===(C=this.phaserEventEmitter)||void 0===C||C.emit(m,R)}postEvent(m,R){setTimeout(()=>{this.sendEvent(m,R)})}},W=0;function createEvent(){let m,R,{debugName:C,emitterAtom:T}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},L=[],unsubscribe=R=>{let T=L.indexOf(R);if(T<0)throw Error("Subscriber not found for '".concat(null!=C?C:U.id,"'. Did you already remove it?"));L.splice(T,1),m&&!L.length&&m()},U={id:"event_".concat(++W),emit:m=>L.forEach(R=>R(m)),emitDeferred:m=>setTimeout(()=>U.emit(m)),subscribe:R=>(T&&!m&&(m=G.e.sub(T,()=>U.emit(G.e.get(T)))),L.push(R),()=>unsubscribe(R)),subscribeAtom:m=>U.subscribe(R=>G.e.set(m,R)),subscribeScene:(m,R)=>{let C=U.subscribe(R);return m.events.once("destroy",C),()=>{m.events.off("destroy",C),C()}},addReduxCase:(m,C)=>{R||(R=U.subscribe(m=>G.h.dispatch({type:U.id,payload:m}))),m.addCase(U.id,C)}};return U}let Z={playSound:createEvent(),soundControl:createEvent(),enhancedControl:createEvent(),joystickControl:createEvent(),blur:createEvent(),attachToCursor:createEvent(),editor:{on:createEvent(),off:createEvent()},inventory:{swapItems:createEvent(),changeActiveRow:createEvent()},sellOrders:{fetch:createEvent(),fill:createEvent(),reset:createEvent()}};function sendSoundControlEvent(m){Z.soundControl.emitDeferred(m)}function sendEnhancedControlEvent(m){Z.enhancedControl.emitDeferred(m)}function sendJoystickControlEvent(m){Z.joystickControl.emitDeferred(m)}var Y=q},82485:function(m,R,C){"use strict";C.d(R,{ML:function(){return IsRemoveOrMoveItem},N8:function(){return CropStageGrowTime},SB:function(){return CropRemainingGrowTime},ZZ:function(){return CanUseItem},q7:function(){return CropNeedsWater},yC:function(){return HasEnergy}});var T=C(96486),L=C.n(T),U=C(70247);function HasEnergy(m,R){var C,T,L;return R.full.energy.level>=-(null!==(L=null===(T=m.onUse)||void 0===T?void 0:null===(C=T.energy)||void 0===C?void 0:C.value)&&void 0!==L?L:0)}function CropNeedsWater(m,R){var C;let T=null===(C=m.crop)||void 0===C?void 0:C.states;if(!T||R.canHarvest)return!1;let L=T[R.state];return(null==L?void 0:L.onGrow)&&R.waterLevel<50}function CropRemainingGrowTime(m,R){var C,T;let L=null===(C=m.crop)||void 0===C?void 0:C.states;if(!L||R.canHarvest)return 0;let U=-R.ageMinutes,$=L[R.state];for(;(null==$?void 0:$.onGrow)&&(null==$?void 0:null===(T=$.onGrow[0])||void 0===T?void 0:T.state)&&"ripe"!==$.state;)U+=$.minutesRequired,$=L[$.onGrow[0].state];return U}function CropStageGrowTime(m,R){var C,T,L;let U=null===(C=m.crop)||void 0===C?void 0:C.states;return!U||R.canHarvest?0:-R.ageMinutes+(null!==(L=null===(T=U[R.state])||void 0===T?void 0:T.minutesRequired)&&void 0!==L?L:0)}function CanUseItem(m,R,C,T){var $;let B;if("string"==typeof m){let R=U.Z.getGameItem(m);if(!R)return!1;m=R}let V=null==m?void 0:m.useTargets;if(!V)return!1;let H=null===($=m.onUse)||void 0===$?void 0:$.types.every(m=>{var L,$,V;switch(m){case"harvest":if(B=U.Z.getGameEntity(R),!T||!(null==B?void 0:null===(L=B.crop)||void 0===L?void 0:L.states))return!1;{let m=B.crop;if(!m.states[T]||!m.states[T].onHarvest)return!1}break;case"fertilize":if(B=U.Z.getGameEntity(R),!T||!(null==B?void 0:null===($=B.crop)||void 0===$?void 0:$.states))return!1;{let m=B.crop;if(!m.states[T]||!m.states[T].onGrow||0===m.states[T].onGrow.length)return console.log("cannot fertilize ".concat(R)),!1}break;case"removeEntity":let H=U.Z.getGameEntity(R);if(H&&!(null==H?void 0:H.onRemove))return!1;break;case"removeObject":let G=U.Z.getGameObject(R);if(G&&!(null==G?void 0:G.onRemove))return!1;break;case"move":if("crop"===C)return!1;let q=null!==(V=U.Z.getGameEntity(R))&&void 0!==V?V:U.Z.getGameObject(R);if(null==q?void 0:q.immovable)return!1}return!0});return!!H&&(null==V?void 0:V.types.some(m=>{var T,$,B,H,G;if("entities"===m)return null===(T=V.entities)||void 0===T?void 0:T.includes(R);if("entityTypes"===m)return!!C&&(null===($=V.entityTypes)||void 0===$?void 0:$.includes(C));if("entityLabels"===m){let m=U.Z.getGameEntity(R);if(null==m?void 0:m.labels)return L().isEmpty(L().xor(V.entityLabels,m.labels))}else if("playerEntityTypes"===m)return!!C&&(null===(B=V.playerEntityTypes)||void 0===B?void 0:B.includes(C));else if("ground"===m)return"ground"===C;else if("pet"===m)return"pet"===R;else if("objects"===m)return null===(H=V.objects)||void 0===H?void 0:H.includes(R);else if("objectTypes"===m){let m=U.Z.getGameObject(R);return null==m?void 0:null===(G=m.types)||void 0===G?void 0:G.every(m=>{var R;return null===(R=V.objectTypes)||void 0===R?void 0:R.includes(m)})}else if("self"===m)return"self"===R;return!1}))}function IsRemoveOrMoveItem(m,R,C,T){if("string"==typeof m){let R=U.Z.getGameItem(m);if(!R)return!1;m=R}return!!(m.onUse&&CanUseItem(m,R,C,T))&&(m.onUse.types.includes("removeEntity")||m.onUse.types.includes("removeObject")||m.onUse.types.includes("move"))}R.ZP=CanUseItem},79750:function(m,R,C){"use strict";C.d(R,{F5:function(){return getTenantID},GU:function(){return getTenantInfo},lf:function(){return getDefaultMap},q4:function(){return switchTenant}});var T=C(70247);let L={id:"pixels",name:"pixels",map:"terravilla",mapPrefix:"pixelsNFTFarm-",twitter:"",defaultCurrency:"cur_coins"};function getTenantID(){try{let m=window.location.pathname.split("/")[1];if("nucyber"===m&&(m="gridcraft"),!m||"map"===m)return L.id;return m.toLowerCase().trim()}catch(m){return L.id}}function switchTenant(m){let R=T.Z.getTenants();if(!R)return!1;let C=Object.values(R).find(R=>R.name===m);if(!C||(null==C?void 0:C.id)===getTenantID())return!1;let L="".concat(window.location.origin,"/").concat(C.id);return window.history.replaceState(null,"",L),!0}function getDefaultMap(){let m=getTenantInfo();return m.map}function getTenantInfo(){var m,R;let C=getTenantID(),U=T.Z.getTenants();return null!==(R=null!==(m=null==U?void 0:U[C])&&void 0!==m?m:null==U?void 0:U.pixels)&&void 0!==R?R:L}},83928:function(m,R,C){"use strict";C.d(R,{Uk:function(){return assetCDN},KG:function(){return ceilCurrency},Ky:function(){return checkLinkRedirect},Ye:function(){return checkVersion},r$:function(){return clearWagmiLocalState},Fp:function(){return convertDashboardURL},zB:function(){return dirtyWordies},Ir:function(){return favIconPath},FL:function(){return filterDirtyWordies},TP:function(){return findProvider},aR:function(){return floorCurrency},xG:function(){return formatCurrency},uf:function(){return formatNumber},_O:function(){return getAngle},fI:function(){return isExternalURL},T1:function(){return isRelativeURL},Ul:function(){return localState},r5:function(){return mapDisplayName},Sj:function(){return maxCurrencyDecimals},DJ:function(){return pointDistanceSquared},pt:function(){return preloadImage},pp:function(){return radiusSquared},En:function(){return sanitizeMapId},b7:function(){return stripURLSchema}});var T,L,U=C(60604);/*! js-cookie v3.0.5 | MIT */function js_cookie_assign(m){for(var R=1;R{var m;switch(null!==(m="production".toString())&&void 0!==m?m:"local"){case"production":return"/favicon";case"staging":return"/favicon_staging";case"preview":return"/favicon_preview";default:return"/favicon_development"}},isExternalURL=m=>!(!m||isRelativeURL(m))&&!U.Oe.reduce((R,C)=>R||m.startsWith(C),!1),isRelativeURL=m=>(null==m?void 0:m.startsWith("/"))&&!(null==m?void 0:m.startsWith("//")),convertDashboardURL=m=>{if(null==m?void 0:m.includes("dashboard.pixels")){let R=window.location.hostname;if("dev.pixels.xyz"===R)return m.replace("dashboard.pixels","dashboard-dev.pixels");if("preview.pixels.xyz"===R)return m.replace("dashboard.pixels","dashboard-preview.pixels");if("staging.pixels.xyz"===R)return m.replace("dashboard.pixels","dashboard-staging.pixels")}else if((null==m?void 0:m.startsWith("/dashboard/"))||"/dashboard"===m){let R=window.location.hostname,C=m.replace("/dashboard","");return"dev.pixels.xyz"===R?"//dashboard-dev.pixels.xyz".concat(C):R.includes("localhost")?"//localhost:3001/".concat(C):"preview.pixels.xyz"===R?"//dashboard-preview.pixels.xyz".concat(C):"staging.pixels.xyz"===R?"//dashboard-staging.pixels.xyz".concat(C):"//dashboard.pixels.xyz".concat(C)}return m},findProvider=m=>{switch(m){case"metamask":return findWallet("isMetaMask");case"coinbase":return findWallet("isCoinbaseWallet")||window.coinbaseWalletExtension;case"okx":return window.okxwallet;case"trust":return window.trustwallet;case"ronin":var R;return null===(R=window.ronin)||void 0===R?void 0:R.provider}},findWallet=m=>{var R;if(window.ethereum){if(!window.ethereum.isOkxWallet&&window.ethereum[m]&&!window.ethereum.providers)return window.ethereum;if(null===(R=window.ethereum.providers)||void 0===R?void 0:R.length){let R=window.ethereum.providers.find(R=>null==R?void 0:R[m]);if(R)return R}if(window[m])return window[m];console.log("Couldn't find wallet provider for ".concat(m))}},B={},localState=(m,R)=>{if("pixels-session"===m){let m="pixels-session";if(void 0===R)return $.get(m);if(null===R)$.remove(m,{domain:"pixels.xyz"});else{let C=new Date;C.setFullYear(C.getFullYear()+10),$.set(m,R,{expires:C,secure:!0,sameSite:"strict",domain:"pixels.xyz"})}return}if(void 0===R)return B[m]?B[m]:window.localStorage.getItem(m);if(null===R)delete B[m],window.localStorage.removeItem(m);else{B[m]=R;try{window.localStorage.setItem(m,R)}catch(m){}}},clearWagmiLocalState=()=>{Object.keys(localStorage).filter(m=>m.startsWith("wc@2:")||m.startsWith("wagmi.")||m.startsWith("-walletlink:")).forEach(m=>localStorage.removeItem(m))},formatNumber=function(m){let R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(null!=m?m:0).toLocaleString(void 0,{maximumFractionDigits:R})},formatCurrency=(m,R)=>{var C,T;let L=null!==(T=null==R?void 0:R.roundDecimalPlaces)&&void 0!==T?T:Math.floor(Math.log10(2**(null!==(C=null==R?void 0:R.roundBinaryPlaces)&&void 0!==C?C:0)));return formatNumber(m,L)},maxCurrencyDecimals=m=>{var R;return(null==m?void 0:m.roundDecimalPlaces)?null==m?void 0:m.roundDecimalPlaces:Math.floor(Math.log10(2**(null!==(R=null==m?void 0:m.roundBinaryPlaces)&&void 0!==R?R:0)))},ceilCurrency=(m,R)=>{var C;let T=(null==R?void 0:R.roundDecimalPlaces)?10**R.roundDecimalPlaces:2**(null!==(C=null==R?void 0:R.roundBinaryPlaces)&&void 0!==C?C:0);return Math.ceil(m*T)/T},floorCurrency=(m,R)=>{var C;let T=(null==R?void 0:R.roundDecimalPlaces)?10**R.roundDecimalPlaces:2**(null!==(C=null==R?void 0:R.roundBinaryPlaces)&&void 0!==C?C:0);return Math.floor(m*T)/T},getAngle=(m,R)=>Math.atan2(R.y-m.y,R.x-m.x),pointDistanceSquared=(m,R)=>(R.x-m.x)**2+(R.y-m.y)**2,radiusSquared=m=>{let{selfPlayer:R,world:C,object:T,useType:L}=m;if(!R)return 1e4;if("self"===L||"pet"===L)return 0;if(T){let m=Math.max(0,Math.abs(R.y-T.y)-T.height/2)**2+Math.max(0,Math.abs(R.x-T.x)-T.width/2)**2;return m}return(R.y-C.y)*(R.y-C.y)+(R.x-C.x)*(R.x-C.x)},preloadImage=m=>window.fetch(m,{mode:"cors",credentials:"omit"}),checkVersion=async()=>{try{return await window.fetch("/api/ver").then(m=>m.json())}catch(m){return{error:m,version:-1}}},V={},checkLinkRedirect=async m=>{try{if(V[m])return V[m];let R=encodeURIComponent(m),C=await window.fetch("/api/expand?url="+R).then(m=>m.json());if(null==C?void 0:C.url)return V[m]=C.url,C.url}catch(m){console.error("error looking up redirect",m)}return m},H=/fuck|shit|cunt|cock|fcuk|nigger|5hit/i,G=/\b(4r5e|5h1t|5hit|a55|hitler|anal|anus|ar5e|arrse|arse|ass|asshole|asswhole|a_s_s|b!tch|b00bs|b17ch|b1tch|ballbag|balls|ballsack|bastard|beastial|beastiality|bellend|bestial|bestiality|bi\+ch|biatch|bitch|bitcher|bitchers|bitches|bitchin|bitching|bloody|blow job|blowjob|boiolas|bollock|bollok|boner|boob|booob|boooob|booooob|booooooob|breasts|buceta|bugger|bum|butthole|buttmunch|buttplug|c0ck|c0cksucker|carpet muncher|cawk|chink|cipa|cl1t|clit|clitoris|cnut|cock|cok|coon|cox|crap|cum|cummer|cumming|cums|cumshot|cunilingus|cunillingus|cunnilingus|cunt|cyalis|cyberfuc|d1ck|damn|dick|dickhead|dildo|dink|dinks|dirsa|dlck|doggin|dogging|donkeyribber|doosh|duche|dyke|ejaculat|ejakulate|f u c k|f u c k e r|f4nny|fag|fanny|fannyflaps|fanyy|fatass|fcuk|fcuker|fcuking|feck|fecker|felching|fellate|fellatio|flange|fook|fooker|fudge packer|fudgepacker|fuk|fuker|fukker|fukkin|fuks|fukwhit|fukwit|fux|fux0r|f_u_c_k|gangbang|gangbanged|gangbangs|gaylord|gaysex|goatse|God|god-dam|god-damned|goddamn|goddamned|hardcoresex|heshe|hoare|hoer|homo|hore|horniest|horny|hotsex|jack-off|jackoff|jap|jerk-off|jism|jiz|jizm|jizz|kawk|knob|knobead|knobed|knobend|knobhead|knobjocky|knobjokey|kock|kondum|kondums|kum|kummer|kumming|kums|kunilingus|l3i\+ch|l3itch|labia|lust|lusting|m0f0|m0fo|m45terbate|ma5terb8|ma5terbate|masochist|master-bate|masterb8|masterbat*|masterbat3|masterbat|masturbate|mo-fo|mof0|mofo|mothafuck|mother fuck|motherfuck|muff|mutha|muthafeck|muthafuckk|muther|n1gga|n1gger|nazi|nigg3r|nigg4h|nigga|niggah|niggas|niggaz|nigger|niggers|nob|nob jokey|nobhead|nobjocky|nobjokey|numbnuts|nutsack|orgasim|orgasims|orgasm|orgasms|p0rn|pawn|pecker|penis|penisfucker|phonesex|phuck|phuk|phuked|phuking|phukked|phukking|phuks|phuq|pigfucker|pimpis|piss|poop|porn|prick|pron|pube|pusse|pussi|pussy|rectum|retard|rimjaw|rimming|s hit|s.o.b.|sadist|schlong|screwing|scroat|scrote|scrotum|semen|sex|sh!\+|sh!t|sh1t|shag|shagger|shaggin|shagging|shemale|shi\+|skank|slut|sluts|smegma|smut|snatch|son-of-a-bitch|spunk|s_h_i_t|t1tt1e|teets|teez|testical|testicle|titfuck|tits|titt|titwank|tosser|turd|tw4t|twat|twathead|twatty|v14gra|v1gra|vagina|viagra|vulva|w00se|wang|wank|wanker|wanky|whoar|whore|xrated|xxx|kkk)/gi,q=(null===(L=window.navigator)||void 0===L?void 0:null===(T=L.languages)||void 0===T?void 0:T.some(m=>null==m?void 0:m.startsWith("tl")))?/fuck|shit|cunt|cock|fcuk|hitler|[-._+,;:'`#^/\\]+[A-Za-z]+[-._+,;:'`#^/\\]|putang|asshole|asswhole|gago|bastard|beastial|punyeta|ulol|tae|hayop|bi\+ch|biatch|bitch|bitcher|bitchers|bitches|lintik|pakshet|bloody|blowjob|boiolas|bollock|bollok|boo+b|bogo|breasts|buceta|bugger|butthole|buttmunch|buttplug|c0ck|c0cksucker|carpet muncher|bobo|chink|cl1t|clit|clitoris|cnut|cock|cok|cox|cummer|cumming|cumshot|cunilingus|cunillingus|cunnilingus|cunt|cyalis|cyberfuc|d1ck|dickhead|dildo|dinks|dirsa|dlck|donkeyribber|doosh|duche|dyke|ejaculat|ejakulate|f u c k|f u c k e r|f4nny|fanny|fanyy|fatass|fcuk|fcuker|fcuking|fecker|felching|fellate|fellatio|flange|fudge packer|fudgepacker|fuk|fuker|fukker|fukkin|fuks|fukwhit|fukwit|fux0r|gangbang|gangbanged|gangbangs|gaylord|gaysex|god-dam|god-damned|goddamn|goddamned|hardcoresex|hoare|horniest|horny|hotsex|jack-off|jackoff|jerk-off|jism|jizm|jizz|kawk|puta|knobed|knobend|knobhead|knobjocky|knobjokey|kondum|kondums|kummer|kumming|kunilingus|l3i\+ch|l3itch|labia|m0f0|m0fo|m45terbate|ma5terb8|ma5terbate|masochist|master-bate|masterb8|masterbat|mo-fo|mof0|mothafuck|mother fucker|motherfuck|muthafeck|muthafuck|n1gga|n1gger|nazi|nigg3r|nigg4h|nigga|niggah|niggas|niggaz|nigger|niggers|numbnuts|nutsack|orgasim|orgasims|orgasm|orgasms|p0rn|penis|penisfucker|phonesex|phuck|phuked|phuking|phukked|phukking|phuks|pigfucker|pimpis|pissflaps|pissin|pissing|pissoff|porno|pricks|pube|pusse|pussi|pussy|rectum|retard|rimjaw|schlong|scrote|scrotum|shagger|shaggin|shagging|shemale|skank|smegma|snatch|spunk|t1tt1e5|t1tties|teez|testical|testicle|titfuck|titties|tittyfuck|tittywank|titwank|tw4t|twat|twathead|twatty|twunt|twunter|tranny|trannie|vagina|viagra|vulva|wang|wank|wanker|wanky|whoar|whore|xxx/gi:/fuck|shit|cunt|cock|fcuk|hitler|[-._+,;:'`#^/\\]+[A-Za-z]+[-._+,;:'`#^/\\]|arrse|asshole|asswhole|ballbag|bastard|beastial|beastiality|bellend|bestiality|bi\+ch|biatch|bloody|blowjob|boiolas|bollock|bollok|boo+b|breasts|buceta|bugger|butthole|buttmunch|buttplug|c0ck|c0cksucker|carpet muncher|cawk|chink|cl1t|clit|clitoris|cnut|cock|cok|cox|cummer|cumming|cumshot|cunilingus|cunillingus|cunnilingus|cunt|cyalis|cyberfuc|d1ck|dickhead|dildo|dinks|dirsa|dlck|donkeyribber|doosh|duche|dyke|ejaculat|ejakulate|f u c k|f u c k e r|f4nny|fanny|fanyy|fatass|fcuk|fcuker|fcuking|fecker|felching|fellate|fellatio|flange|fudge packer|fudgepacker|fuk|fuker|fukker|fukkin|fuks|fukwhit|fukwit|fux0r|gangbang|gangbanged|gangbangs|gaylord|gaysex|god-dam|god-damned|goddamn|goddamned|hardcoresex|hoare|horniest|horny|hotsex|jack-off|jackoff|jerk-off|jism|jizm|jizz|kawk|knobead|knobed|knobend|knobhead|knobjocky|knobjokey|kondum|kondums|kummer|kumming|kunilingus|l3i\+ch|l3itch|labia|m0f0|m0fo|m45terbate|ma5terb8|ma5terbate|masochist|master-bate|masterb8|masterbat*|masterbat|mo-fo|mof0|mothafuck|mother fuck|motherfuck|muthafecker|muthafuck|n1gga|n1gger|nazi|nigg3r|nigg4h|nigga|niggah|niggas|niggaz|nigger|niggers|numbnuts|nutsack|orgasim|orgasims|orgasm|orgasms|p0rn|penis|penisfucker|phonesex|phuck|phuked|phuking|phukked|phukking|phuks|pigfucker|pimpis|pissflaps|pissin|pissing|pissoff|porno|pornography|pornos|pricks|pube|pusse|pussi|pussy|rectum|retard|rimjaw|schlong|scrote|scrotum|shagger|shaggin|shagging|shemale|skank|smegma|snatch|spunk|t1tt1e5|t1tties|teez|testical|testicle|titfuck|titties|tittyfuck|tittywank|titwank|tw4t|twat|twathead|twatty|twunt|twunter|tranny|trannie|vagina|viagra|vulva|wang|wank|wanker|wanky|whoar|whore|xxx/gi,dirtyWordies=m=>(G.lastIndex=0,q.lastIndex=0,H.lastIndex=0,H.test(m)||G.test(m)||q.test(m.replace(/[^a-zA-Z1350]/,""))),filterDirtyWordies=m=>m.replaceAll(q,"@#$%").replaceAll(G,"!*^+"),stripURLSchema=function(m){let R=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!m)return"";if(m.startsWith("blob:")||m.startsWith("data:"))return m;m.startsWith("ipfs:")&&(m=m.replace("ipfs://","//ipfs.io/ipfs/")),m.startsWith(U.je)&&(m=m.replace(U.je,U.pZ));let C=m.indexOf(":"),T=-1===C?m:m.substring(C+1);return R&&-1===m.indexOf("?")&&-1===m.indexOf("#")?"".concat(T,"?v2"):T},assetCDN=m=>m?m.startsWith("/assets/ui")?m.replace("/assets/ui/","".concat(U.pZ,"/game/ui/")):m.startsWith("/game")?"".concat(U.pZ).concat(m):m.startsWith("/assets/")?m.replace("/assets/","".concat(U.pZ,"/game/assets/")):m.startsWith("/")&&!m.startsWith("//")?"".concat(U.pZ).concat(m):m:"",sanitizeMapId=m=>{let R=(null==m?void 0:m.toLowerCase())||"",C=m;try{if("terravilla"===R)C="terravilla";else if(R.includes("pixelsnftfarm-")){let m=R.replace("pixelsnftfarm-","");m&&(C="pixelsNFTFarm-".concat(m))}else if(R.includes("pixelsnftfarm")){let m=R.replace("pixelsnftfarm","");m&&(C="pixelsNFTFarm".concat(m))}else if(/farm\d+/.test(R)){let m=R.replace("farm","");m&&(C="pixelsNFTFarm-".concat(m))}return C}catch(R){return m}};function mapDisplayName(m){let R=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return m.startsWith("pixelsNFTFarm-")?"".concat(m.replace("pixelsNFTFarm-",R?"#":"")):/terravilla/i.test(m)?"TV":m}},89733:function(m,R,C){"use strict";var T=C(34377),L=C(70247);let PhaserGame=class PhaserGame{get isInitialized(){return!!PhaserGame.phaserGame}async loadLibraries(m){return L.Z.loadLibraries(m)}registerEvents(){T.ZP.registerEventListener(T.Vh.RESIZE,m=>{var R;null===(R=this.roomScene)||void 0===R||R.resize(m.width,m.height)})}async initGame(){let m=await C.e(989).then(C.t.bind(C,82260,23)),R=await Promise.all([C.e(989),C.e(983)]).then(C.bind(C,39983)),{phaserConfig:L}=await Promise.all([C.e(989),C.e(967)]).then(C.bind(C,2967));return await T.ZP.init(),PhaserGame.phaserGame||(this.audioScene=new R.default,L.scene=this.audioScene,PhaserGame.phaserGame=new m.Game(L),this.registerEvents()),PhaserGame.phaserGame}async freezeRoom(m){let R=PhaserGame.phaserGame.scene.getScenes(!0);R.forEach(R=>{R.events.emit("TRANSITION_OUT",m)}),await new Promise(R=>{setTimeout(R,"quick"!==m?1500:1e3)})}unfreezeRoom(m){let R=PhaserGame.phaserGame.scene.getScenes(!0);R.forEach(R=>{R.events.emit("TRANSITION_IN",m)})}pauseRoom(){let m=PhaserGame.phaserGame.scene.getScenes(!0);m.forEach(m=>{m!==this.audioScene&&m.scene.pause()})}async killScene(){if(PhaserGame.phaserGame){let m=PhaserGame.phaserGame.scene.getScenes();m.forEach(m=>{m!==this.audioScene&&m.scene.remove()}),this.currentScene="loader"}this.roomScene=void 0}static get reentrancyCheck(){var m;return null===(m=window)||void 0===m?void 0:m.pixelsRentrancy}static set reentrancyCheck(m){console.log("setting re-entrancy",m),window&&(window.pixelsRentrancy=m)}async initRoom(m){var R;PhaserGame.phaserGame||await this.initGame(),null===(R=this.audioScene)||void 0===R||R.clearPositional();let L=await Promise.all([C.e(989),C.e(676),C.e(983),C.e(314)]).then(C.bind(C,4314));if(PhaserGame.reentrancyCheck){console.error("wtf are we doing? We cannot run this twice.");return}PhaserGame.reentrancyCheck=!0;let U="room".concat(m.mapId);U===this.currentScene&&(U="".concat(U,"2"));let $=new L.default(U,m.mapId,m.worldId,m.spawn,m.transition),B=setTimeout(()=>{console.log("Have not loaded after 5 seconds!!!!"),T.ZP.postEvent(T.fb.SLOW_LOAD)},5e3),onConnected=()=>{let m=this.currentScene&&PhaserGame.phaserGame.scene.getScene(this.currentScene);m||console.log("no scene to destroy"),clearTimeout(B),PhaserGame.phaserGame.scene.add(U,$),$.scene.start(),this.currentScene=U,this.roomScene=$,null==m||m.scene.remove(),null==$||$.events.once("create",()=>{T.ZP.sendEvent(T.fb.GAME_INITIATED)}),T.ZP.removeEventListerner(T.fb.GAME_CONNECTED,onConnected),T.ZP.removeEventListerner(T.fb.SVR_CANNOTCONNECT,onNotConnected),PhaserGame.reentrancyCheck=!1},onNotConnected=()=>{clearTimeout(B),T.ZP.removeEventListerner(T.fb.GAME_CONNECTED,onConnected),T.ZP.removeEventListerner(T.fb.SVR_CANNOTCONNECT,onNotConnected),PhaserGame.reentrancyCheck=!1};T.ZP.registerEventListener(T.fb.GAME_CONNECTED,onConnected),T.ZP.registerEventListener(T.fb.SVR_CANNOTCONNECT,onNotConnected)}destroyGame(){var m;null===(m=PhaserGame.phaserGame)||void 0===m||m.destroy(!0),PhaserGame.phaserGame=null}constructor(){this.currentScene="loader"}};R.Z=new PhaserGame},95047:function(m,R,C){"use strict";C.d(R,{Z:function(){return eW}});var T,L,U,$={};function bind(m,R){return function(){return m.apply(R,arguments)}}C.r($),C.d($,{hasBrowserEnv:function(){return eS},hasStandardBrowserEnv:function(){return eO},hasStandardBrowserWebWorkerEnv:function(){return eA}});let{toString:B}=Object.prototype,{getPrototypeOf:V}=Object,H=(T=Object.create(null),m=>{let R=B.call(m);return T[R]||(T[R]=R.slice(8,-1).toLowerCase())}),kindOfTest=m=>(m=m.toLowerCase(),R=>H(R)===m),typeOfTest=m=>R=>typeof R===m,{isArray:G}=Array,q=typeOfTest("undefined"),W=kindOfTest("ArrayBuffer"),Z=typeOfTest("string"),Y=typeOfTest("function"),K=typeOfTest("number"),isObject=m=>null!==m&&"object"==typeof m,isPlainObject=m=>{if("object"!==H(m))return!1;let R=V(m);return(null===R||R===Object.prototype||null===Object.getPrototypeOf(R))&&!(Symbol.toStringTag in m)&&!(Symbol.iterator in m)},J=kindOfTest("Date"),X=kindOfTest("File"),Q=kindOfTest("Blob"),ee=kindOfTest("FileList"),et=kindOfTest("URLSearchParams");function forEach(m,R,{allOwnKeys:C=!1}={}){let T,L;if(null!=m){if("object"!=typeof m&&(m=[m]),G(m))for(T=0,L=m.length;T0;)if(R===(C=T[L]).toLowerCase())return C;return null}let er="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,isContextDefined=m=>!q(m)&&m!==er,en=(L="undefined"!=typeof Uint8Array&&V(Uint8Array),m=>L&&m instanceof L),eo=kindOfTest("HTMLFormElement"),ei=(({hasOwnProperty:m})=>(R,C)=>m.call(R,C))(Object.prototype),ea=kindOfTest("RegExp"),reduceDescriptors=(m,R)=>{let C=Object.getOwnPropertyDescriptors(m),T={};forEach(C,(C,L)=>{let U;!1!==(U=R(C,L,m))&&(T[L]=U||C)}),Object.defineProperties(m,T)},es="abcdefghijklmnopqrstuvwxyz",el="0123456789",eu={DIGIT:el,ALPHA:es,ALPHA_DIGIT:es+es.toUpperCase()+el},ec=kindOfTest("AsyncFunction");var ed={isArray:G,isArrayBuffer:W,isBuffer:function(m){return null!==m&&!q(m)&&null!==m.constructor&&!q(m.constructor)&&Y(m.constructor.isBuffer)&&m.constructor.isBuffer(m)},isFormData:m=>{let R;return m&&("function"==typeof FormData&&m instanceof FormData||Y(m.append)&&("formdata"===(R=H(m))||"object"===R&&Y(m.toString)&&"[object FormData]"===m.toString()))},isArrayBufferView:function(m){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(m):m&&m.buffer&&W(m.buffer)},isString:Z,isNumber:K,isBoolean:m=>!0===m||!1===m,isObject,isPlainObject,isUndefined:q,isDate:J,isFile:X,isBlob:Q,isRegExp:ea,isFunction:Y,isStream:m=>isObject(m)&&Y(m.pipe),isURLSearchParams:et,isTypedArray:en,isFileList:ee,forEach,merge:function merge(){let{caseless:m}=isContextDefined(this)&&this||{},R={},assignValue=(C,T)=>{let L=m&&findKey(R,T)||T;isPlainObject(R[L])&&isPlainObject(C)?R[L]=merge(R[L],C):isPlainObject(C)?R[L]=merge({},C):G(C)?R[L]=C.slice():R[L]=C};for(let m=0,R=arguments.length;m(forEach(R,(R,T)=>{C&&Y(R)?m[T]=bind(R,C):m[T]=R},{allOwnKeys:T}),m),trim:m=>m.trim?m.trim():m.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:m=>(65279===m.charCodeAt(0)&&(m=m.slice(1)),m),inherits:(m,R,C,T)=>{m.prototype=Object.create(R.prototype,T),m.prototype.constructor=m,Object.defineProperty(m,"super",{value:R.prototype}),C&&Object.assign(m.prototype,C)},toFlatObject:(m,R,C,T)=>{let L,U,$;let B={};if(R=R||{},null==m)return R;do{for(U=(L=Object.getOwnPropertyNames(m)).length;U-- >0;)$=L[U],(!T||T($,m,R))&&!B[$]&&(R[$]=m[$],B[$]=!0);m=!1!==C&&V(m)}while(m&&(!C||C(m,R))&&m!==Object.prototype);return R},kindOf:H,kindOfTest,endsWith:(m,R,C)=>{m=String(m),(void 0===C||C>m.length)&&(C=m.length),C-=R.length;let T=m.indexOf(R,C);return -1!==T&&T===C},toArray:m=>{if(!m)return null;if(G(m))return m;let R=m.length;if(!K(R))return null;let C=Array(R);for(;R-- >0;)C[R]=m[R];return C},forEachEntry:(m,R)=>{let C;let T=m&&m[Symbol.iterator],L=T.call(m);for(;(C=L.next())&&!C.done;){let T=C.value;R.call(m,T[0],T[1])}},matchAll:(m,R)=>{let C;let T=[];for(;null!==(C=m.exec(R));)T.push(C);return T},isHTMLForm:eo,hasOwnProperty:ei,hasOwnProp:ei,reduceDescriptors,freezeMethods:m=>{reduceDescriptors(m,(R,C)=>{if(Y(m)&&-1!==["arguments","caller","callee"].indexOf(C))return!1;let T=m[C];if(Y(T)){if(R.enumerable=!1,"writable"in R){R.writable=!1;return}R.set||(R.set=()=>{throw Error("Can not rewrite read-only method '"+C+"'")})}})},toObjectSet:(m,R)=>{let C={};return(m=>{m.forEach(m=>{C[m]=!0})})(G(m)?m:String(m).split(R)),C},toCamelCase:m=>m.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(m,R,C){return R.toUpperCase()+C}),noop:()=>{},toFiniteNumber:(m,R)=>Number.isFinite(m=+m)?m:R,findKey,global:er,isContextDefined,ALPHABET:eu,generateString:(m=16,R=eu.ALPHA_DIGIT)=>{let C="",{length:T}=R;for(;m--;)C+=R[Math.random()*T|0];return C},isSpecCompliantForm:function(m){return!!(m&&Y(m.append)&&"FormData"===m[Symbol.toStringTag]&&m[Symbol.iterator])},toJSONObject:m=>{let R=Array(10),visit=(m,C)=>{if(isObject(m)){if(R.indexOf(m)>=0)return;if(!("toJSON"in m)){R[C]=m;let T=G(m)?[]:{};return forEach(m,(m,R)=>{let L=visit(m,C+1);q(L)||(T[R]=L)}),R[C]=void 0,T}}return m};return visit(m,0)},isAsyncFn:ec,isThenable:m=>m&&(isObject(m)||Y(m))&&Y(m.then)&&Y(m.catch)};function AxiosError(m,R,C,T,L){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=Error().stack,this.message=m,this.name="AxiosError",R&&(this.code=R),C&&(this.config=C),T&&(this.request=T),L&&(this.response=L)}ed.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ed.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});let ef=AxiosError.prototype,ep={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(m=>{ep[m]={value:m}}),Object.defineProperties(AxiosError,ep),Object.defineProperty(ef,"isAxiosError",{value:!0}),AxiosError.from=(m,R,C,T,L,U)=>{let $=Object.create(ef);return ed.toFlatObject(m,$,function(m){return m!==Error.prototype},m=>"isAxiosError"!==m),AxiosError.call($,m.message,R,C,T,L),$.cause=m,$.name=m.name,U&&Object.assign($,U),$};var eh=C(21876).Buffer;function isVisitable(m){return ed.isPlainObject(m)||ed.isArray(m)}function removeBrackets(m){return ed.endsWith(m,"[]")?m.slice(0,-2):m}function renderKey(m,R,C){return m?m.concat(R).map(function(m,R){return m=removeBrackets(m),!C&&R?"["+m+"]":m}).join(C?".":""):R}let eg=ed.toFlatObject(ed,{},null,function(m){return/^is[A-Z]/.test(m)});var helpers_toFormData=function(m,R,C){if(!ed.isObject(m))throw TypeError("target must be an object");R=R||new FormData,C=ed.toFlatObject(C,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,R){return!ed.isUndefined(R[m])});let T=C.metaTokens,L=C.visitor||defaultVisitor,U=C.dots,$=C.indexes,B=C.Blob||"undefined"!=typeof Blob&&Blob,V=B&&ed.isSpecCompliantForm(R);if(!ed.isFunction(L))throw TypeError("visitor must be a function");function convertValue(m){if(null===m)return"";if(ed.isDate(m))return m.toISOString();if(!V&&ed.isBlob(m))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return ed.isArrayBuffer(m)||ed.isTypedArray(m)?V&&"function"==typeof Blob?new Blob([m]):eh.from(m):m}function defaultVisitor(m,C,L){let B=m;if(m&&!L&&"object"==typeof m){if(ed.endsWith(C,"{}"))C=T?C:C.slice(0,-2),m=JSON.stringify(m);else{var V;if(ed.isArray(m)&&(V=m,ed.isArray(V)&&!V.some(isVisitable))||(ed.isFileList(m)||ed.endsWith(C,"[]"))&&(B=ed.toArray(m)))return C=removeBrackets(C),B.forEach(function(m,T){ed.isUndefined(m)||null===m||R.append(!0===$?renderKey([C],T,U):null===$?C:C+"[]",convertValue(m))}),!1}}return!!isVisitable(m)||(R.append(renderKey(L,C,U),convertValue(m)),!1)}let H=[],G=Object.assign(eg,{defaultVisitor,convertValue,isVisitable});if(!ed.isObject(m))throw TypeError("data must be an object");return!function build(m,C){if(!ed.isUndefined(m)){if(-1!==H.indexOf(m))throw Error("Circular reference detected in "+C.join("."));H.push(m),ed.forEach(m,function(m,T){let U=!(ed.isUndefined(m)||null===m)&&L.call(R,m,ed.isString(T)?T.trim():T,C,G);!0===U&&build(m,C?C.concat(T):[T])}),H.pop()}}(m),R};function encode(m){let R={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\x00"};return encodeURIComponent(m).replace(/[!'()~]|%20|%00/g,function(m){return R[m]})}function AxiosURLSearchParams(m,R){this._pairs=[],m&&helpers_toFormData(m,this,R)}let em=AxiosURLSearchParams.prototype;function buildURL_encode(m){return encodeURIComponent(m).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(m,R,C){let T;if(!R)return m;let L=C&&C.encode||buildURL_encode,U=C&&C.serialize;if(T=U?U(R,C):ed.isURLSearchParams(R)?R.toString():new AxiosURLSearchParams(R,C).toString(L)){let R=m.indexOf("#");-1!==R&&(m=m.slice(0,R)),m+=(-1===m.indexOf("?")?"?":"&")+T}return m}em.append=function(m,R){this._pairs.push([m,R])},em.toString=function(m){let R=m?function(R){return m.call(this,R,encode)}:encode;return this._pairs.map(function(m){return R(m[0])+"="+R(m[1])},"").join("&")};var ey=class{constructor(){this.handlers=[]}use(m,R,C){return this.handlers.push({fulfilled:m,rejected:R,synchronous:!!C&&C.synchronous,runWhen:C?C.runWhen:null}),this.handlers.length-1}eject(m){this.handlers[m]&&(this.handlers[m]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(m){ed.forEach(this.handlers,function(R){null!==R&&m(R)})}},ev={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},eb="undefined"!=typeof URLSearchParams?URLSearchParams:AxiosURLSearchParams,eE="undefined"!=typeof FormData?FormData:null,e_="undefined"!=typeof Blob?Blob:null;let eS="undefined"!=typeof window&&"undefined"!=typeof document,eO=(U="undefined"!=typeof navigator&&navigator.product,eS&&0>["ReactNative","NativeScript","NS"].indexOf(U)),eA="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts;var ew={...$,isBrowser:!0,classes:{URLSearchParams:eb,FormData:eE,Blob:e_},protocols:["http","https","file","blob","url","data"]},helpers_formDataToJSON=function(m){if(ed.isFormData(m)&&ed.isFunction(m.entries)){let R={};return ed.forEachEntry(m,(m,C)=>{!function buildPath(m,R,C,T){let L=m[T++];if("__proto__"===L)return!0;let U=Number.isFinite(+L),$=T>=m.length;if(L=!L&&ed.isArray(C)?C.length:L,$)return ed.hasOwnProp(C,L)?C[L]=[C[L],R]:C[L]=R,!U;C[L]&&ed.isObject(C[L])||(C[L]=[]);let B=buildPath(m,R,C[L],T);return B&&ed.isArray(C[L])&&(C[L]=function(m){let R,C;let T={},L=Object.keys(m),U=L.length;for(R=0;R"[]"===m[0]?"":m[1]||m[0]),C,R,0)}),R}return null};let eI={transitional:ev,adapter:["xhr","http"],transformRequest:[function(m,R){let C;let T=R.getContentType()||"",L=T.indexOf("application/json")>-1,U=ed.isObject(m);U&&ed.isHTMLForm(m)&&(m=new FormData(m));let $=ed.isFormData(m);if($)return L?JSON.stringify(helpers_formDataToJSON(m)):m;if(ed.isArrayBuffer(m)||ed.isBuffer(m)||ed.isStream(m)||ed.isFile(m)||ed.isBlob(m))return m;if(ed.isArrayBufferView(m))return m.buffer;if(ed.isURLSearchParams(m))return R.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),m.toString();if(U){if(T.indexOf("application/x-www-form-urlencoded")>-1){var B,V;return(B=m,V=this.formSerializer,helpers_toFormData(B,new ew.classes.URLSearchParams,Object.assign({visitor:function(m,R,C,T){return ew.isNode&&ed.isBuffer(m)?(this.append(R,m.toString("base64")),!1):T.defaultVisitor.apply(this,arguments)}},V))).toString()}if((C=ed.isFileList(m))||T.indexOf("multipart/form-data")>-1){let R=this.env&&this.env.FormData;return helpers_toFormData(C?{"files[]":m}:m,R&&new R,this.formSerializer)}}return U||L?(R.setContentType("application/json",!1),function(m,R,C){if(ed.isString(m))try{return(0,JSON.parse)(m),ed.trim(m)}catch(m){if("SyntaxError"!==m.name)throw m}return(0,JSON.stringify)(m)}(m)):m}],transformResponse:[function(m){let R=this.transitional||eI.transitional,C=R&&R.forcedJSONParsing,T="json"===this.responseType;if(m&&ed.isString(m)&&(C&&!this.responseType||T)){let C=R&&R.silentJSONParsing;try{return JSON.parse(m)}catch(m){if(!C&&T){if("SyntaxError"===m.name)throw AxiosError.from(m,AxiosError.ERR_BAD_RESPONSE,this,null,this.response);throw m}}}return m}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ew.classes.FormData,Blob:ew.classes.Blob},validateStatus:function(m){return m>=200&&m<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ed.forEach(["delete","get","head","post","put","patch"],m=>{eI.headers[m]={}});let eP=ed.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var parseHeaders=m=>{let R,C,T;let L={};return m&&m.split("\n").forEach(function(m){T=m.indexOf(":"),R=m.substring(0,T).trim().toLowerCase(),C=m.substring(T+1).trim(),!R||L[R]&&eP[R]||("set-cookie"===R?L[R]?L[R].push(C):L[R]=[C]:L[R]=L[R]?L[R]+", "+C:C)}),L};let eR=Symbol("internals");function normalizeHeader(m){return m&&String(m).trim().toLowerCase()}function normalizeValue(m){return!1===m||null==m?m:ed.isArray(m)?m.map(normalizeValue):String(m)}let isValidHeaderName=m=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(m.trim());function matchHeaderValue(m,R,C,T,L){if(ed.isFunction(T))return T.call(this,R,C);if(L&&(R=C),ed.isString(R)){if(ed.isString(T))return -1!==R.indexOf(T);if(ed.isRegExp(T))return T.test(R)}}let AxiosHeaders=class AxiosHeaders{constructor(m){m&&this.set(m)}set(m,R,C){let T=this;function setHeader(m,R,C){let L=normalizeHeader(R);if(!L)throw Error("header name must be a non-empty string");let U=ed.findKey(T,L);U&&void 0!==T[U]&&!0!==C&&(void 0!==C||!1===T[U])||(T[U||R]=normalizeValue(m))}let setHeaders=(m,R)=>ed.forEach(m,(m,C)=>setHeader(m,C,R));return ed.isPlainObject(m)||m instanceof this.constructor?setHeaders(m,R):ed.isString(m)&&(m=m.trim())&&!isValidHeaderName(m)?setHeaders(parseHeaders(m),R):null!=m&&setHeader(R,m,C),this}get(m,R){if(m=normalizeHeader(m)){let C=ed.findKey(this,m);if(C){let m=this[C];if(!R)return m;if(!0===R)return function(m){let R;let C=Object.create(null),T=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;for(;R=T.exec(m);)C[R[1]]=R[2];return C}(m);if(ed.isFunction(R))return R.call(this,m,C);if(ed.isRegExp(R))return R.exec(m);throw TypeError("parser must be boolean|regexp|function")}}}has(m,R){if(m=normalizeHeader(m)){let C=ed.findKey(this,m);return!!(C&&void 0!==this[C]&&(!R||matchHeaderValue(this,this[C],C,R)))}return!1}delete(m,R){let C=this,T=!1;function deleteHeader(m){if(m=normalizeHeader(m)){let L=ed.findKey(C,m);L&&(!R||matchHeaderValue(C,C[L],L,R))&&(delete C[L],T=!0)}}return ed.isArray(m)?m.forEach(deleteHeader):deleteHeader(m),T}clear(m){let R=Object.keys(this),C=R.length,T=!1;for(;C--;){let L=R[C];(!m||matchHeaderValue(this,this[L],L,m,!0))&&(delete this[L],T=!0)}return T}normalize(m){let R=this,C={};return ed.forEach(this,(T,L)=>{let U=ed.findKey(C,L);if(U){R[U]=normalizeValue(T),delete R[L];return}let $=m?L.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(m,R,C)=>R.toUpperCase()+C):String(L).trim();$!==L&&delete R[L],R[$]=normalizeValue(T),C[$]=!0}),this}concat(...m){return this.constructor.concat(this,...m)}toJSON(m){let R=Object.create(null);return ed.forEach(this,(C,T)=>{null!=C&&!1!==C&&(R[T]=m&&ed.isArray(C)?C.join(", "):C)}),R}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([m,R])=>m+": "+R).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(m){return m instanceof this?m:new this(m)}static concat(m,...R){let C=new this(m);return R.forEach(m=>C.set(m)),C}static accessor(m){let R=this[eR]=this[eR]={accessors:{}},C=R.accessors,T=this.prototype;function defineAccessor(m){let R=normalizeHeader(m);C[R]||(!function(m,R){let C=ed.toCamelCase(" "+R);["get","set","has"].forEach(T=>{Object.defineProperty(m,T+C,{value:function(m,C,L){return this[T].call(this,R,m,C,L)},configurable:!0})})}(T,m),C[R]=!0)}return ed.isArray(m)?m.forEach(defineAccessor):defineAccessor(m),this}};function transformData(m,R){let C=this||eI,T=R||C,L=AxiosHeaders.from(T.headers),U=T.data;return ed.forEach(m,function(m){U=m.call(C,U,L.normalize(),R?R.status:void 0)}),L.normalize(),U}function isCancel(m){return!!(m&&m.__CANCEL__)}function CanceledError(m,R,C){AxiosError.call(this,null==m?"canceled":m,AxiosError.ERR_CANCELED,R,C),this.name="CanceledError"}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),ed.reduceDescriptors(AxiosHeaders.prototype,({value:m},R)=>{let C=R[0].toUpperCase()+R.slice(1);return{get:()=>m,set(m){this[C]=m}}}),ed.freezeMethods(AxiosHeaders),ed.inherits(CanceledError,AxiosError,{__CANCEL__:!0});var ek=ew.hasStandardBrowserEnv?{write(m,R,C,T,L,U){let $=[m+"="+encodeURIComponent(R)];ed.isNumber(C)&&$.push("expires="+new Date(C).toGMTString()),ed.isString(T)&&$.push("path="+T),ed.isString(L)&&$.push("domain="+L),!0===U&&$.push("secure"),document.cookie=$.join("; ")},read(m){let R=document.cookie.match(RegExp("(^|;\\s*)("+m+")=([^;]*)"));return R?decodeURIComponent(R[3]):null},remove(m){this.write(m,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function buildFullPath(m,R){return m&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(R)?R?m.replace(/\/?\/$/,"")+"/"+R.replace(/^\/+/,""):m:R}var eC=ew.hasStandardBrowserEnv?function(){let m;let R=/(msie|trident)/i.test(navigator.userAgent),C=document.createElement("a");function resolveURL(m){let T=m;return R&&(C.setAttribute("href",T),T=C.href),C.setAttribute("href",T),{href:C.href,protocol:C.protocol?C.protocol.replace(/:$/,""):"",host:C.host,search:C.search?C.search.replace(/^\?/,""):"",hash:C.hash?C.hash.replace(/^#/,""):"",hostname:C.hostname,port:C.port,pathname:"/"===C.pathname.charAt(0)?C.pathname:"/"+C.pathname}}return m=resolveURL(window.location.href),function(R){let C=ed.isString(R)?resolveURL(R):R;return C.protocol===m.protocol&&C.host===m.host}}():function(){return!0},helpers_speedometer=function(m,R){let C;m=m||10;let T=Array(m),L=Array(m),U=0,$=0;return R=void 0!==R?R:1e3,function(B){let V=Date.now(),H=L[$];C||(C=V),T[U]=B,L[U]=V;let G=$,q=0;for(;G!==U;)q+=T[G++],G%=m;if((U=(U+1)%m)===$&&($=($+1)%m),V-C{let U=L.loaded,$=L.lengthComputable?L.total:void 0,B=U-C,V=T(B),H=U<=$;C=U;let G={loaded:U,total:$,progress:$?U/$:void 0,bytes:B,rate:V||void 0,estimated:V&&$&&H?($-U)/V:void 0,event:L};G[R?"download":"upload"]=!0,m(G)}}let eT="undefined"!=typeof XMLHttpRequest;var ex=eT&&function(m){return new Promise(function(R,C){let T,L,U=m.data,$=AxiosHeaders.from(m.headers).normalize(),{responseType:B,withXSRFToken:V}=m;function done(){m.cancelToken&&m.cancelToken.unsubscribe(T),m.signal&&m.signal.removeEventListener("abort",T)}if(ed.isFormData(U)){if(ew.hasStandardBrowserEnv||ew.hasStandardBrowserWebWorkerEnv)$.setContentType(!1);else if(!1!==(L=$.getContentType())){let[m,...R]=L?L.split(";").map(m=>m.trim()).filter(Boolean):[];$.setContentType([m||"multipart/form-data",...R].join("; "))}}let H=new XMLHttpRequest;if(m.auth){let R=m.auth.username||"",C=m.auth.password?unescape(encodeURIComponent(m.auth.password)):"";$.set("Authorization","Basic "+btoa(R+":"+C))}let G=buildFullPath(m.baseURL,m.url);function onloadend(){if(!H)return;let T=AxiosHeaders.from("getAllResponseHeaders"in H&&H.getAllResponseHeaders()),L=B&&"text"!==B&&"json"!==B?H.response:H.responseText,U={data:L,status:H.status,statusText:H.statusText,headers:T,config:m,request:H};!function(m,R,C){let T=C.config.validateStatus;!C.status||!T||T(C.status)?m(C):R(new AxiosError("Request failed with status code "+C.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(C.status/100)-4],C.config,C.request,C))}(function(m){R(m),done()},function(m){C(m),done()},U),H=null}if(H.open(m.method.toUpperCase(),buildURL(G,m.params,m.paramsSerializer),!0),H.timeout=m.timeout,"onloadend"in H?H.onloadend=onloadend:H.onreadystatechange=function(){H&&4===H.readyState&&(0!==H.status||H.responseURL&&0===H.responseURL.indexOf("file:"))&&setTimeout(onloadend)},H.onabort=function(){H&&(C(new AxiosError("Request aborted",AxiosError.ECONNABORTED,m,H)),H=null)},H.onerror=function(){C(new AxiosError("Network Error",AxiosError.ERR_NETWORK,m,H)),H=null},H.ontimeout=function(){let R=m.timeout?"timeout of "+m.timeout+"ms exceeded":"timeout exceeded",T=m.transitional||ev;m.timeoutErrorMessage&&(R=m.timeoutErrorMessage),C(new AxiosError(R,T.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,m,H)),H=null},ew.hasStandardBrowserEnv&&(V&&ed.isFunction(V)&&(V=V(m)),V||!1!==V&&eC(G))){let R=m.xsrfHeaderName&&m.xsrfCookieName&&ek.read(m.xsrfCookieName);R&&$.set(m.xsrfHeaderName,R)}void 0===U&&$.setContentType(null),"setRequestHeader"in H&&ed.forEach($.toJSON(),function(m,R){H.setRequestHeader(R,m)}),ed.isUndefined(m.withCredentials)||(H.withCredentials=!!m.withCredentials),B&&"json"!==B&&(H.responseType=m.responseType),"function"==typeof m.onDownloadProgress&&H.addEventListener("progress",progressEventReducer(m.onDownloadProgress,!0)),"function"==typeof m.onUploadProgress&&H.upload&&H.upload.addEventListener("progress",progressEventReducer(m.onUploadProgress)),(m.cancelToken||m.signal)&&(T=R=>{H&&(C(!R||R.type?new CanceledError(null,m,H):R),H.abort(),H=null)},m.cancelToken&&m.cancelToken.subscribe(T),m.signal&&(m.signal.aborted?T():m.signal.addEventListener("abort",T)));let q=function(m){let R=/^([-+\w]{1,25})(:?\/\/|:)/.exec(m);return R&&R[1]||""}(G);if(q&&-1===ew.protocols.indexOf(q)){C(new AxiosError("Unsupported protocol "+q+":",AxiosError.ERR_BAD_REQUEST,m));return}H.send(U||null)})};let eL={http:null,xhr:ex};ed.forEach(eL,(m,R)=>{if(m){try{Object.defineProperty(m,"name",{value:R})}catch(m){}Object.defineProperty(m,"adapterName",{value:R})}});let renderReason=m=>`- ${m}`,isResolvedHandle=m=>ed.isFunction(m)||null===m||!1===m;var eN={getAdapter:m=>{let R,C;m=ed.isArray(m)?m:[m];let{length:T}=m,L={};for(let U=0;U`adapter ${m} `+(!1===R?"is not supported by the environment":"is not available in the build")),R=T?m.length>1?"since :\n"+m.map(renderReason).join("\n"):" "+renderReason(m[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+R,"ERR_NOT_SUPPORT")}return C},adapters:eL};function throwIfCancellationRequested(m){if(m.cancelToken&&m.cancelToken.throwIfRequested(),m.signal&&m.signal.aborted)throw new CanceledError(null,m)}function dispatchRequest(m){throwIfCancellationRequested(m),m.headers=AxiosHeaders.from(m.headers),m.data=transformData.call(m,m.transformRequest),-1!==["post","put","patch"].indexOf(m.method)&&m.headers.setContentType("application/x-www-form-urlencoded",!1);let R=eN.getAdapter(m.adapter||eI.adapter);return R(m).then(function(R){return throwIfCancellationRequested(m),R.data=transformData.call(m,m.transformResponse,R),R.headers=AxiosHeaders.from(R.headers),R},function(R){return!isCancel(R)&&(throwIfCancellationRequested(m),R&&R.response&&(R.response.data=transformData.call(m,m.transformResponse,R.response),R.response.headers=AxiosHeaders.from(R.response.headers))),Promise.reject(R)})}let headersToObject=m=>m instanceof AxiosHeaders?m.toJSON():m;function mergeConfig(m,R){R=R||{};let C={};function getMergedValue(m,R,C){return ed.isPlainObject(m)&&ed.isPlainObject(R)?ed.merge.call({caseless:C},m,R):ed.isPlainObject(R)?ed.merge({},R):ed.isArray(R)?R.slice():R}function mergeDeepProperties(m,R,C){return ed.isUndefined(R)?ed.isUndefined(m)?void 0:getMergedValue(void 0,m,C):getMergedValue(m,R,C)}function valueFromConfig2(m,R){if(!ed.isUndefined(R))return getMergedValue(void 0,R)}function defaultToConfig2(m,R){return ed.isUndefined(R)?ed.isUndefined(m)?void 0:getMergedValue(void 0,m):getMergedValue(void 0,R)}function mergeDirectKeys(C,T,L){return L in R?getMergedValue(C,T):L in m?getMergedValue(void 0,C):void 0}let T={url:valueFromConfig2,method:valueFromConfig2,data:valueFromConfig2,baseURL:defaultToConfig2,transformRequest:defaultToConfig2,transformResponse:defaultToConfig2,paramsSerializer:defaultToConfig2,timeout:defaultToConfig2,timeoutMessage:defaultToConfig2,withCredentials:defaultToConfig2,withXSRFToken:defaultToConfig2,adapter:defaultToConfig2,responseType:defaultToConfig2,xsrfCookieName:defaultToConfig2,xsrfHeaderName:defaultToConfig2,onUploadProgress:defaultToConfig2,onDownloadProgress:defaultToConfig2,decompress:defaultToConfig2,maxContentLength:defaultToConfig2,maxBodyLength:defaultToConfig2,beforeRedirect:defaultToConfig2,transport:defaultToConfig2,httpAgent:defaultToConfig2,httpsAgent:defaultToConfig2,cancelToken:defaultToConfig2,socketPath:defaultToConfig2,responseEncoding:defaultToConfig2,validateStatus:mergeDirectKeys,headers:(m,R)=>mergeDeepProperties(headersToObject(m),headersToObject(R),!0)};return ed.forEach(Object.keys(Object.assign({},m,R)),function(L){let U=T[L]||mergeDeepProperties,$=U(m[L],R[L],L);ed.isUndefined($)&&U!==mergeDirectKeys||(C[L]=$)}),C}let eM="1.6.7",ej={};["object","boolean","number","function","string","symbol"].forEach((m,R)=>{ej[m]=function(C){return typeof C===m||"a"+(R<1?"n ":" ")+m}});let eD={};ej.transitional=function(m,R,C){function formatMessage(m,R){return"[Axios v"+eM+"] Transitional option '"+m+"'"+R+(C?". "+C:"")}return(C,T,L)=>{if(!1===m)throw new AxiosError(formatMessage(T," has been removed"+(R?" in "+R:"")),AxiosError.ERR_DEPRECATED);return R&&!eD[T]&&(eD[T]=!0,console.warn(formatMessage(T," has been deprecated since v"+R+" and will be removed in the near future"))),!m||m(C,T,L)}};var eU={assertOptions:function(m,R,C){if("object"!=typeof m)throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);let T=Object.keys(m),L=T.length;for(;L-- >0;){let U=T[L],$=R[U];if($){let R=m[U],C=void 0===R||$(R,U,m);if(!0!==C)throw new AxiosError("option "+U+" must be "+C,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(!0!==C)throw new AxiosError("Unknown option "+U,AxiosError.ERR_BAD_OPTION)}},validators:ej};let e$=eU.validators;let Axios=class Axios{constructor(m){this.defaults=m,this.interceptors={request:new ey,response:new ey}}async request(m,R){try{return await this._request(m,R)}catch(m){if(m instanceof Error){let R;Error.captureStackTrace?Error.captureStackTrace(R={}):R=Error();let C=R.stack?R.stack.replace(/^.+\n/,""):"";m.stack?C&&!String(m.stack).endsWith(C.replace(/^.+\n.+\n/,""))&&(m.stack+="\n"+C):m.stack=C}throw m}}_request(m,R){let C,T;"string"==typeof m?(R=R||{}).url=m:R=m||{},R=mergeConfig(this.defaults,R);let{transitional:L,paramsSerializer:U,headers:$}=R;void 0!==L&&eU.assertOptions(L,{silentJSONParsing:e$.transitional(e$.boolean),forcedJSONParsing:e$.transitional(e$.boolean),clarifyTimeoutError:e$.transitional(e$.boolean)},!1),null!=U&&(ed.isFunction(U)?R.paramsSerializer={serialize:U}:eU.assertOptions(U,{encode:e$.function,serialize:e$.function},!0)),R.method=(R.method||this.defaults.method||"get").toLowerCase();let B=$&&ed.merge($.common,$[R.method]);$&&ed.forEach(["delete","get","head","post","put","patch","common"],m=>{delete $[m]}),R.headers=AxiosHeaders.concat(B,$);let V=[],H=!0;this.interceptors.request.forEach(function(m){("function"!=typeof m.runWhen||!1!==m.runWhen(R))&&(H=H&&m.synchronous,V.unshift(m.fulfilled,m.rejected))});let G=[];this.interceptors.response.forEach(function(m){G.push(m.fulfilled,m.rejected)});let q=0;if(!H){let m=[dispatchRequest.bind(this),void 0];for(m.unshift.apply(m,V),m.push.apply(m,G),T=m.length,C=Promise.resolve(R);q{if(!C._listeners)return;let R=C._listeners.length;for(;R-- >0;)C._listeners[R](m);C._listeners=null}),this.promise.then=m=>{let R;let T=new Promise(m=>{C.subscribe(m),R=m}).then(m);return T.cancel=function(){C.unsubscribe(R)},T},m(function(m,T,L){C.reason||(C.reason=new CanceledError(m,T,L),R(C.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(m){if(this.reason){m(this.reason);return}this._listeners?this._listeners.push(m):this._listeners=[m]}unsubscribe(m){if(!this._listeners)return;let R=this._listeners.indexOf(m);-1!==R&&this._listeners.splice(R,1)}static source(){let m;let R=new CancelToken(function(R){m=R});return{token:R,cancel:m}}};let eB={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(eB).forEach(([m,R])=>{eB[R]=m});let eF=function createInstance(m){let R=new Axios(m),C=bind(Axios.prototype.request,R);return ed.extend(C,Axios.prototype,R,{allOwnKeys:!0}),ed.extend(C,R,null,{allOwnKeys:!0}),C.create=function(R){return createInstance(mergeConfig(m,R))},C}(eI);eF.Axios=Axios,eF.CanceledError=CanceledError,eF.CancelToken=CancelToken,eF.isCancel=isCancel,eF.VERSION=eM,eF.toFormData=helpers_toFormData,eF.AxiosError=AxiosError,eF.Cancel=eF.CanceledError,eF.all=function(m){return Promise.all(m)},eF.spread=function(m){return function(R){return m.apply(null,R)}},eF.isAxiosError=function(m){return ed.isObject(m)&&!0===m.isAxiosError},eF.mergeConfig=mergeConfig,eF.AxiosHeaders=AxiosHeaders,eF.formToJSON=m=>helpers_formDataToJSON(ed.isHTMLForm(m)?new FormData(m):m),eF.getAdapter=eN.getAdapter,eF.HttpStatusCode=eB,eF.default=eF;var eV=C(60604),ez=C(79750),eH=C(83928),eG=C(42379);let API=class API{async logAction(m){eF.get("".concat(this.baseAPIURL,"/log?message=")+encodeURIComponent(m))}static webAssemblySupported(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){let m=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(m instanceof WebAssembly.Module)return new WebAssembly.Instance(m) instanceof WebAssembly.Instance}}catch(m){}return!1}getStytchTelemetry(){if(!API.webAssemblySupported())throw{message:"wasm-required"};return new Promise((m,R)=>{setTimeout(()=>{R("no-telemetryId-available")},3e4),window.GetTelemetryID?window.GetTelemetryID("public-token-live-e4dbf337-9f27-447f-908f-17038ec8d940").then(C=>{C||(console.log("GetTelemetryID returned nothing"),R({message:"no-telemetryId-available"})),m(C)}):(console.log("GetTelemetryID not on window"),R({message:"no-telemetryId-available"}))})}async captchaOptions(m){let R={};return R.telemetryId=await this.getStytchTelemetry(),console.log("got telemetry",R),R}async completeEmailAuthentication(m,R,C,T){let L={email:m,password:R,create:C,mapId:T,...await this.captchaOptions("start_email_authentication")};try{let{data:m}=await eF.post("".concat(this.baseAPIURL,"/auth/email_authentication"),L);return this.sessionToken=m.sessionToken,this.walletProvider="email",(0,eH.Ul)("pixels-session",this.sessionToken),(0,eH.Ul)("wallet-provider","email"),m}catch(m){var U;if(null===(U=m.response)||void 0===U?void 0:U.data)throw m.response.data;throw{error:"server-unreachable",message:"No response from server. Please try again later."}}}async startCryptoAuthentication(m){try{let{data:R}=await eF.post("".concat(this.baseAPIURL,"/auth/start_crypto_authentication"),{walletAddress:m,...await this.captchaOptions("start_crypto_authentication")},{headers:{"Content-Type":"application/json"}});if(!R.challenge&&R.message)throw R;return R.challenge}catch(m){var R;if(null===(R=m.response)||void 0===R?void 0:R.data)throw m.response.data;throw{error:"server-unreachable",message:"No response from server. Please try again later."}}}async completeCryptoAuthentication(m,R,C,T){try{let{data:L}=await eF.post("".concat(this.baseAPIURL,"/auth/complete_crypto_authentication"),{walletAddress:m,signature:R,mapId:T,tenant:(0,ez.F5)(),walletProvider:C});return this.sessionToken=L.sessionToken,this.walletProvider=C,(0,eH.Ul)("pixels-session",this.sessionToken),(0,eH.Ul)("wallet-provider",C),L}catch(m){var L;if(null===(L=m.response)||void 0===L?void 0:L.data)throw m.response.data;throw{error:"server-unreachable",message:"No response from server. Please try again later."}}}async startOneTimeAuthentication(m,R,C){try{let{data:T}=await eF.post("".concat(this.baseAPIURL,"/auth/start_onetime_authentication"),{otpckind:m,identifier:"email"===m?C:R,...await this.captchaOptions("start_onetime_authentication")});return T.method_id}catch(m){var T;if(null===(T=m.response)||void 0===T?void 0:T.data)throw m.response.data;throw{error:"server-unreachable",message:"No response from server. Please try again later."}}}async completeOneTimeAuthentication(m,R,C){try{let{data:T}=await eF.post("".concat(this.baseAPIURL,"/auth/complete_onetime_authentication"),{id:m,code:R,mapId:C,tenant:(0,ez.F5)()});return this.sessionToken=T.sessionToken,this.walletProvider="otpc",(0,eH.Ul)("pixels-session",this.sessionToken),(0,eH.Ul)("wallet-provider","otpc"),T}catch(m){var T;if(null===(T=m.response)||void 0===T?void 0:T.data)throw m.response.data;throw{error:"server-unreachable",message:"No response from server. Please try again later."}}}async initialize(m,R){let C;try{let T=(0,ez.F5)(),L=(0,eH.Ul)("pixels-session");if(!L)return null;let U=(0,eH.Ul)("wallet-provider")||R||"metamask",$=await eF.post("".concat(this.baseAPIURL,"/auth/initialize"),{authToken:L,mapId:m,tenant:T,walletProvider:U,ver:eV.WX,...await this.captchaOptions("validateSession")});C=$.data,this.sessionToken=C.sessionToken,this.walletProvider=U}catch(m){if(m.response&&m.response.data&&m.response.data.error)throw m.response.data;if(!m.response)throw{error:"server-unreachable",message:"No response from server when authenticating. Check Internet Connection."};return null}if(!C.sessionToken&&C.error)throw C;return C}async createPlayer(m,R){let{data:C}=await eF.post("".concat(this.baseAPIURL,"/auth/player/upsert"),{username:m,avatarPieces:R,authToken:this.sessionToken,walletProvider:this.walletProvider,...await this.captchaOptions("create_player"),tenant:(0,ez.F5)()});return C}async rateLimitedGet(m,R){for(;this.limiter;)await this.limiter;return this.limiter=(async()=>{var C;let T=Date.now(),L=1e3-(T-(null!==(C=this.lastcall)&&void 0!==C?C:0));L>0&&await new Promise(m=>setTimeout(m,L));let{data:U}=await eF.get(R,m);return this.lastcall=Date.now(),U})(),this.limiter.then(m=>(this.limiter=void 0,m))}async fetchPlayerDetails(m){let R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,C={headers:{Authorization:this.sessionToken}};return this.rateLimitedGet(C,"".concat(this.baseAPIURL,"/player?mid=").concat(m,"&detail=").concat(R))}async fetchPlayersUsernames(m){if(!(null==m?void 0:m.length))return{};let R={headers:{Authorization:this.sessionToken}},C=m.map(m=>"mid=".concat(m)).join("&");try{let{data:m}=await eF.get("".concat(this.baseAPIURL,"/player/usernames?").concat(C),R);return m}catch(m){return{}}}async signOut(){let m=(0,eH.Ul)("pixels-session");if(this.sessionToken=void 0,(0,eH.Ul)("pixels-session",null),(0,eH.Ul)("wallet-provider",null),(0,eH.Ul)("player-nfts",null),this.sessionToken=void 0,m){let{data:R}=await eF.post("".concat(this.baseAPIURL,"/auth/sign_out"),{authToken:m});return R}}hashVersion(m){let R={"6.122":"87bbbwei20","6.209":"--78DEVO+spins"};if(R[m])return R[m];let C=0;for(let R=0,T=m.length;R0)return m.data}return B||{}}async getTopFarms(){let{data:m}=await eF.get("".concat(this.baseCacheUrl,"/discoverability/top_farms"));return m}async getTopNFTFarms(){let{data:m}=await eF.get("".concat(this.baseCacheUrl,"/discoverability/nft/top_farms"));return m}async getTopFreeFarms(){let{data:m}=await eF.get("".concat(this.baseCacheUrl,"/discoverability/free/top_farms"));return m}async fetchPlayerFarms(m){let{data:R}=await eF.get("".concat(this.baseAPIURL,"/player/farms?player_id=").concat(m));return R}async searchFarms(m){let{data:R}=await eF.get("".concat(this.baseAPIURL,"/player/search?input=").concat(encodeURIComponent(m)));return R}async farmDetails(m){let{data:R}=await eF.get("".concat(this.baseAPIURL,"/infiniportal/farm_details/").concat(m));return R}async hatchPet(m){try{let{data:R}=await eF.post("".concat(this.baseAPIURL,"/pets/hatch"),{entity:m},{headers:{Authorization:this.sessionToken}});return R}catch(m){return console.log(null==m?void 0:m.message),!1}}async getRoomId(m,R){let{data:C}=await this.axiosget("".concat(this.baseColyeusURL,"/game/findroom/").concat(encodeURIComponent(m),"/").concat(R));if(!(null==C?void 0:C.roomId))throw Error("please-reload-app");return"".concat(null==C?void 0:C.roomId,"/").concat(null==C?void 0:C.server)}async getWorldTotals(){let{data:m}=await this.axiosget("".concat(this.baseAPIURL,"/game/worlds"));return m}async fetchMarketplaceListingCounts(){let{data:m}=await this.axiosget("".concat(this.baseCacheUrl,"/marketplace/listings/count"));return m}async fetchMarketplaceListingsForItem(m,R){let C=Date.now();if(this.marketTime&&C-this.marketTime<2e3){let m=this.marketTime+2e3-C;await new Promise(R=>setTimeout(R,m))}let T={headers:{Authorization:this.sessionToken}},{data:L}=await this.axiosget("".concat(this.baseAPIURL,"/marketplace/item/").concat(m,"?pid=").concat(R),T);return this.marketTime=Date.now(),L}async fetchMarketplaceListingsForPlayer(m){let{data:R}=await this.axiosget("".concat(this.baseAPIURL,"/marketplace/player/").concat(m));return R}async fetchPlayerUGC(){let{data:m}=await eF.post("".concat(this.baseAPIURL,"/game/ugc/player"),{token:this.sessionToken});return m}async checkForStytchAccount(m){let{email:R,phone:C,eth:T,kind:L}=m,U={headers:{"x-client-version":this.hashVersion(eV.WX.toString())}},{data:$}=await this.axiosget("".concat(this.baseAPIURL,"/auth/check/stytch_user"),{params:{email:"email"===L?R:void 0,phone:"sms"===L||"whatsapp"===L?C:void 0,eth:"eth"===L?T:void 0,ver:eV.WX},...U});return $}constructor(m,R){this.baseURL=m,this.version=R,this.baseAPIURL="".concat(m,"/").concat(R),this.baseCacheUrl="".concat(m,"/cache"),this.baseColyeusURL=m}};var eW=new API(eG.LB,"v1")},18496:function(m,R,C){"use strict";var T=C(95047);R.Z=new class{get sessionToken(){return this.api.sessionToken}get walletProvider(){return this.api.walletProvider}async startCryptoAuthentication(m){return this.api.startCryptoAuthentication(m)}async completeAuthentication(m,R,C,T){return this.api.completeCryptoAuthentication(m,R,C,T)}async completeEmailAuthentication(m,R,C,T){return this.api.completeEmailAuthentication(m,R,C,T)}async startOneTimeAuthentication(m,R,C){return this.api.startOneTimeAuthentication(m,R,C)}async completeOneTimeAuthentication(m,R,C){return this.api.completeOneTimeAuthentication(m,R,C)}async initialize(m,R){return this.api.initialize(m,R)}async signOut(){return this.api.signOut()}async createPlayer(m,R){return this.api.createPlayer(m,R)}async fetchPlayer(m){let R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.api.fetchPlayerDetails(m,R)}async checkForStytchAccount(m){let{email:R,phone:C,eth:T,kind:L}=m;return this.api.checkForStytchAccount({email:R,phone:C,eth:T,kind:L})}constructor(m){this.api=m}}(T.Z)},39135:function(m,R,C){"use strict";C.d(R,{Z:function(){return em},W:function(){return reloadi18n}});var T,L,U,$=C(34853),B=C(57715);function _typeof(m){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(m){return typeof m}:function(m){return m&&"function"==typeof Symbol&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(m)}var V=[],H=V.forEach,G=V.slice;function defaults(m){return H.call(G.call(arguments,1),function(R){if(R)for(var C in R)void 0===m[C]&&(m[C]=R[C])}),m}function hasXMLHttpRequest(){return"function"==typeof XMLHttpRequest||("undefined"==typeof XMLHttpRequest?"undefined":_typeof(XMLHttpRequest))==="object"}var q=C(83154),W=C.t(q,2);function request_typeof(m){return(request_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(m){return typeof m}:function(m){return m&&"function"==typeof Symbol&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(m)}"function"==typeof fetch&&(T="undefined"!=typeof global&&global.fetch?global.fetch:"undefined"!=typeof window&&window.fetch?window.fetch:fetch),hasXMLHttpRequest()&&("undefined"!=typeof global&&global.XMLHttpRequest?L=global.XMLHttpRequest:"undefined"!=typeof window&&window.XMLHttpRequest&&(L=window.XMLHttpRequest)),"function"==typeof ActiveXObject&&("undefined"!=typeof global&&global.ActiveXObject?U=global.ActiveXObject:"undefined"!=typeof window&&window.ActiveXObject&&(U=window.ActiveXObject)),T||!W||L||U||(T=q||W),"function"!=typeof T&&(T=void 0);var addQueryString=function(m,R){if(R&&"object"===request_typeof(R)){var C="";for(var T in R)C+="&"+encodeURIComponent(T)+"="+encodeURIComponent(R[T]);if(!C)return m;m=m+(-1!==m.indexOf("?")?"&":"?")+C.slice(1)}return m},fetchIt=function(m,R,C){T(m,R).then(function(m){if(!m.ok)return C(m.statusText||"Error",{status:m.status});m.text().then(function(R){C(null,{status:m.status,data:R})}).catch(C)}).catch(C)},Z=!1,requestWithFetch=function(m,R,C,T){m.queryStringParams&&(R=addQueryString(R,m.queryStringParams));var L=defaults({},"function"==typeof m.customHeaders?m.customHeaders():m.customHeaders);C&&(L["Content-Type"]="application/json");var U="function"==typeof m.requestOptions?m.requestOptions(C):m.requestOptions,$=defaults({method:C?"POST":"GET",body:C?m.stringify(C):void 0,headers:L},Z?{}:U);try{fetchIt(R,$,T)}catch(m){if(!U||0===Object.keys(U).length||!m.message||0>m.message.indexOf("not implemented"))return T(m);try{Object.keys(U).forEach(function(m){delete $[m]}),fetchIt(R,$,T),Z=!0}catch(m){T(m)}}},requestWithXmlHttpRequest=function(m,R,C,T){C&&"object"===request_typeof(C)&&(C=addQueryString("",C).slice(1)),m.queryStringParams&&(R=addQueryString(R,m.queryStringParams));try{($=L?new L:new U("MSXML2.XMLHTTP.3.0")).open(C?"POST":"GET",R,1),m.crossDomain||$.setRequestHeader("X-Requested-With","XMLHttpRequest"),$.withCredentials=!!m.withCredentials,C&&$.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),$.overrideMimeType&&$.overrideMimeType("application/json");var $,B=m.customHeaders;if(B="function"==typeof B?B():B)for(var V in B)$.setRequestHeader(V,B[V]);$.onreadystatechange=function(){$.readyState>3&&T($.status>=400?$.statusText:null,{status:$.status,data:$.responseText})},$.send(C)}catch(m){console&&console.log(m)}},esm_request=function(m,R,C,L){return("function"==typeof C&&(L=C,C=void 0),L=L||function(){},T)?requestWithFetch(m,R,C,L):hasXMLHttpRequest()||"function"==typeof ActiveXObject?requestWithXmlHttpRequest(m,R,C,L):void L(Error("No fetch and no xhr implementation found!"))};function _defineProperties(m,R){for(var C=0;C1&&void 0!==arguments[1]?arguments[1]:{},C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(m,R){if(!(m instanceof R))throw TypeError("Cannot call a class as a function")}(this,Backend),this.services=m,this.options=R,this.allOptions=C,this.type="backend",this.init(m,R,C)}return m=[{key:"init",value:function(m){var R=this,C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=m,this.options=defaults(C,this.options||{},{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",allowMultiLoading:!1,parse:function(m){return JSON.parse(m)},stringify:JSON.stringify,parsePayload:function(m,R,C){var T,L;return T={},L=C||"",R in T?Object.defineProperty(T,R,{value:L,enumerable:!0,configurable:!0,writable:!0}):T[R]=L,T},request:esm_request,reloadInterval:"undefined"==typeof window&&36e5,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}),this.allOptions=T,this.services&&this.options.reloadInterval&&setInterval(function(){return R.reload()},this.options.reloadInterval)}},{key:"readMulti",value:function(m,R,C){this._readAny(m,m,R,R,C)}},{key:"read",value:function(m,R,C){this._readAny([m],m,[R],R,C)}},{key:"_readAny",value:function(m,R,C,T,L){var U,$,B=this,V=this.options.loadPath;"function"==typeof this.options.loadPath&&(V=this.options.loadPath(m,C)),(V=($=U=V)&&"function"==typeof $.then?U:Promise.resolve(U)).then(function(U){if(!U)return L(null,{});var $=B.services.interpolator.interpolate(U,{lng:m.join("+"),ns:C.join("+")});B.loadUrl($,L,R,T)})}},{key:"loadUrl",value:function(m,R,C,T){var L=this;this.options.request(this.options,m,void 0,function(U,$){var B,V;if($&&($.status>=500&&$.status<600||!$.status))return R("failed loading "+m+"; status code: "+$.status,!0);if($&&$.status>=400&&$.status<500)return R("failed loading "+m+"; status code: "+$.status,!1);if(!$&&U&&U.message&&U.message.indexOf("Failed to fetch")>-1)return R("failed loading "+m+": "+U.message,!0);if(U)return R(U,!1);try{B="string"==typeof $.data?L.options.parse($.data,C,T):$.data}catch(R){V="failed parsing "+m+" to json"}if(V)return R(V,!1);R(null,B)})}},{key:"create",value:function(m,R,C,T,L){var U=this;if(this.options.addPath){"string"==typeof m&&(m=[m]);var $=this.options.parsePayload(R,C,T),B=0,V=[],H=[];m.forEach(function(C){var T=U.options.addPath;"function"==typeof U.options.addPath&&(T=U.options.addPath(C,R));var G=U.services.interpolator.interpolate(T,{lng:C,ns:R});U.options.request(U.options,G,$,function(R,C){B+=1,V.push(R),H.push(C),B===m.length&&L&&L(V,H)})})}}},{key:"reload",value:function(){var m=this,R=this.services,C=R.backendConnector,T=R.languageUtils,L=R.logger,U=C.language;if(!U||"cimode"!==U.toLowerCase()){var $=[],append=function(m){T.toResolveHierarchy(m).forEach(function(m){0>$.indexOf(m)&&$.push(m)})};append(U),this.allOptions.preload&&this.allOptions.preload.forEach(function(m){return append(m)}),$.forEach(function(R){m.allOptions.ns.forEach(function(m){C.read(R,m,"read",null,null,function(T,U){T&&L.warn("loading namespace ".concat(m," for language ").concat(R," failed"),T),!T&&U&&L.log("loaded namespace ".concat(m," for language ").concat(R),U),C.loaded("".concat(R,"|").concat(m),T,U)})})})}}}],_defineProperties(Backend.prototype,m),R&&_defineProperties(Backend,R),Object.defineProperty(Backend,"prototype",{writable:!1}),Backend}();Y.type="backend";var K=C(15671),J=C(43144),X=[],Q=X.forEach,ee=X.slice,et=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,serializeCookie=function(m,R,C){var T=C||{};T.path=T.path||"/";var L=encodeURIComponent(R),U="".concat(m,"=").concat(L);if(T.maxAge>0){var $=T.maxAge-0;if(Number.isNaN($))throw Error("maxAge should be a Number");U+="; Max-Age=".concat(Math.floor($))}if(T.domain){if(!et.test(T.domain))throw TypeError("option domain is invalid");U+="; Domain=".concat(T.domain)}if(T.path){if(!et.test(T.path))throw TypeError("option path is invalid");U+="; Path=".concat(T.path)}if(T.expires){if("function"!=typeof T.expires.toUTCString)throw TypeError("option expires is invalid");U+="; Expires=".concat(T.expires.toUTCString())}if(T.httpOnly&&(U+="; HttpOnly"),T.secure&&(U+="; Secure"),T.sameSite)switch("string"==typeof T.sameSite?T.sameSite.toLowerCase():T.sameSite){case!0:case"strict":U+="; SameSite=Strict";break;case"lax":U+="; SameSite=Lax";break;case"none":U+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return U},er={create:function(m,R,C,T){var L=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};C&&(L.expires=new Date,L.expires.setTime(L.expires.getTime()+6e4*C)),T&&(L.domain=T),document.cookie=serializeCookie(m,encodeURIComponent(R),L)},read:function(m){for(var R="".concat(m,"="),C=document.cookie.split(";"),T=0;T-1&&(C=window.location.hash.substring(window.location.hash.indexOf("?")));for(var T=C.substring(1).split("&"),L=0;L0&&T[L].substring(0,U)===m.lookupQuerystring&&(R=T[L].substring(U+1))}}return R}},ei=null,localStorageAvailable=function(){if(null!==ei)return ei;try{ei="undefined"!==window&&null!==window.localStorage;var m="i18next.translate.boo";window.localStorage.setItem(m,"foo"),window.localStorage.removeItem(m)}catch(m){ei=!1}return ei},ea={name:"localStorage",lookup:function(m){var R;if(m.lookupLocalStorage&&localStorageAvailable()){var C=window.localStorage.getItem(m.lookupLocalStorage);C&&(R=C)}return R},cacheUserLanguage:function(m,R){R.lookupLocalStorage&&localStorageAvailable()&&window.localStorage.setItem(R.lookupLocalStorage,m)}},es=null,sessionStorageAvailable=function(){if(null!==es)return es;try{es="undefined"!==window&&null!==window.sessionStorage;var m="i18next.translate.boo";window.sessionStorage.setItem(m,"foo"),window.sessionStorage.removeItem(m)}catch(m){es=!1}return es},el={name:"sessionStorage",lookup:function(m){var R;if(m.lookupSessionStorage&&sessionStorageAvailable()){var C=window.sessionStorage.getItem(m.lookupSessionStorage);C&&(R=C)}return R},cacheUserLanguage:function(m,R){R.lookupSessionStorage&&sessionStorageAvailable()&&window.sessionStorage.setItem(R.lookupSessionStorage,m)}},eu={name:"navigator",lookup:function(m){var R=[];if("undefined"!=typeof navigator){if(navigator.languages)for(var C=0;C0?R:void 0}},ec={name:"htmlTag",lookup:function(m){var R,C=m.htmlTag||("undefined"!=typeof document?document.documentElement:null);return C&&"function"==typeof C.getAttribute&&(R=C.getAttribute("lang")),R}},ed={name:"path",lookup:function(m){var R;if("undefined"!=typeof window){var C=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(C instanceof Array){if("number"==typeof m.lookupFromPathIndex){if("string"!=typeof C[m.lookupFromPathIndex])return;R=C[m.lookupFromPathIndex].replace("/","")}else R=C[0].replace("/","")}}return R}},ef={name:"subdomain",lookup:function(m){var R="number"==typeof m.lookupFromSubdomainIndex?m.lookupFromSubdomainIndex+1:1,C="undefined"!=typeof window&&window.location&&window.location.hostname&&window.location.hostname.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(C)return C[R]}},ep=function(){function Browser(m){var R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,K.Z)(this,Browser),this.type="languageDetector",this.detectors={},this.init(m,R)}return(0,J.Z)(Browser,[{key:"init",value:function(m){var R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=m,this.options=function(m){return Q.call(ee.call(arguments,1),function(R){if(R)for(var C in R)void 0===m[C]&&(m[C]=R[C])}),m}(R,this.options||{},{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=C,this.addDetector(en),this.addDetector(eo),this.addDetector(ea),this.addDetector(el),this.addDetector(eu),this.addDetector(ec),this.addDetector(ed),this.addDetector(ef)}},{key:"addDetector",value:function(m){this.detectors[m.name]=m}},{key:"detect",value:function(m){var R=this;m||(m=this.options.order);var C=[];return(m.forEach(function(m){if(R.detectors[m]){var T=R.detectors[m].lookup(R.options);T&&"string"==typeof T&&(T=[T]),T&&(C=C.concat(T))}}),this.services.languageUtils.getBestMatchFromCodes)?C:C.length>0?C[0]:null}},{key:"cacheUserLanguage",value:function(m,R){var C=this;R||(R=this.options.caches),R&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(m)>-1||R.forEach(function(R){C.detectors[R]&&C.detectors[R].cacheUserLanguage(m,C.options)}))}}]),Browser}();ep.type="languageDetector";var eh=C(79750);let eg=!1;$.ZP.on("onLoaded",()=>{console.log("loading i18n"),eg=!0}),$.ZP.use(Y).use(ep).use(B.Db).init({debug:!1,fallbackLng:"en",load:"languageOnly",preload:["en"],ns:["ui","game","quest"],defaultNS:"ui",react:{useSuspense:!1},interpolation:{escapeValue:!1},backend:{crossDomain:!0,loadPath:function(){let m=(0,eh.F5)();return"//pixels-server.pixels.xyz/v1/i18n/{{ns}}/{{lng}}"+"?tenant=".concat(m)}}},m=>{eg=!m});let reloadi18n=function(){let m=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(m||!eg)return $.ZP.reloadResources()};var em=$.ZP},70247:function(m,R,C){"use strict";C.d(R,{Z:function(){return L}});var T=C(95047);function union(m){let{keyField:R,first:C,second:T,mergefields:L}=m,U=[].concat(null!=C?C:[]);if(!T||0===T.length)return U;let $={};return U.forEach((m,C)=>{R in m&&($[m[R]]=C)}),T.forEach(m=>{let C=m[R];if(C in $){if(L){let R=$[C];U[R]={...U[R],...m}}}else U.push(m)}),U}let prepareEntity=(m,R)=>{var C,T,L,U;let $=R.entities[m];if(!$||"generic"!==$.type||!(null===(C=$.generic)||void 0===C?void 0:C.inherits))return $;let B=$.generic,V=prepareEntity(B.inherits,R);if(!(null==V?void 0:V.generic))return $;let H=V.generic;return $.generic.defaultState=B.defaultState||H.defaultState,$.generic.states=(null===(T=B.states)||void 0===T?void 0:T.length)?union({keyField:"name",second:B.states,first:H.states,mergefields:!0}):H.states,$.generic.layers=(null===(L=B.layers)||void 0===L?void 0:L.length)?union({keyField:"depth",second:B.layers,first:H.layers,mergefields:!0}):H.layers,$.generic.transitions=(null===(U=B.transitions)||void 0===U?void 0:U.length)?union({keyField:"from_to",second:B.transitions,first:H.transitions,mergefields:!1}):H.transitions,delete $.generic.inherits,$};var L=new class{async loadMap(m){return this.api.fetchMap(m)}clearGameLibrary(){this.gameLibraryPromise=void 0}async loadLibraries(m){try{this.gameLibraryPromise||(this.gameLibraryPromise=this.api.fetchGameLibrary(),this.gameLibraryPromise.then(m=>{this.transformGameLibrary(m)}).catch(()=>{this.gameLibraryPromise=void 0}));let R=[this.gameLibraryPromise];m&&this.mapId!==m&&(this.mapInfoPromise=this.api.fetchMap(m),this.mapLibrary=void 0,this.mapId=m),this.mapInfoPromise&&R.push(this.mapInfoPromise);try{await Promise.all(R)}catch(m){this.gameLibraryPromise=void 0,this.mapInfoPromise=void 0}if(this.mapInfoPromise){let m=await this.mapInfoPromise;m&&(this.mapLibrary={id:m.id,labels:m.labels,type:m.type,config:{}})}return this.gameLibrary}catch(m){console.log("could not load game library",m),this.gameLibraryPromise=void 0,this.mapInfoPromise=void 0;return}}transformGameLibrary(m){m.sounds&&(m.sounds=new Map(m.sounds.map(m=>[m.id,m]))),m.entities&&Object.keys(m.entities).forEach(R=>{prepareEntity(R,m)}),this.gameLibrary=m}transformGameLibraryUpdate(m){let R={sounds:m.sounds};return Object.entries(m).forEach(m=>{let[C,T]=m;"sounds"!==C&&(R[C]={},T.forEach(m=>{R[C][m.id]=m}))}),R}isValid(){return this.gameLibrary&&!!this.gameLibrary.objects&&!!this.gameLibrary.avatars}async reloadOne(m){let R=arguments.length>1&&void 0!==arguments[1]&&arguments[1],C="".concat(m.kind,"s");if(!this.gameLibrary&&!R)return null;try{let R=await this.api.fetchGameLibraryExtras({[C]:[m.id]});if(R){var T;if(this.updateGameLibrary(this.transformGameLibraryUpdate(R)),"sounds"===C)return this.gameLibrary.sounds.get(m.id);return null===(T=this.gameLibrary[C])||void 0===T?void 0:T[m.id]}}catch(m){return null}}updateGameLibrary(m){if(!this.gameLibrary){var R;console.log("got library with ".concat(Object.values(null!==(R=m.tilesets)&&void 0!==R?R:{}).length," tilesets")),this.gameLibrary=m;return}m.objects&&Object.assign(this.gameLibrary.objects,m.objects),m.stores&&Object.assign(this.gameLibrary.stores,m.stores),m.entities&&(Object.assign(this.gameLibrary.entities,m.entities),Object.keys(m.entities).forEach(m=>{prepareEntity(m,this.gameLibrary)})),m.sounds&&m.sounds.forEach(m=>{this.gameLibrary.sounds.set(m.id,m)}),m.tilesets&&Object.assign(this.gameLibrary.tilesets,m.tilesets),m.quests&&Object.assign(this.gameLibrary.quests,m.quests)}getGameObject(m){var R;let C=null===(R=this.gameLibrary)||void 0===R?void 0:R.objects[m];return C}getGameNonWallObjects(){if(!this.nonWallObjects){var m;this.nonWallObjects=(null===(m=this.gameLibrary)||void 0===m?void 0:m.objects)?Object.values(this.gameLibrary.objects).filter(m=>!m.wall):void 0}return this.nonWallObjects}getGameWallObjects(){if(!this.wallObjects){var m;this.wallObjects=(null===(m=this.gameLibrary)||void 0===m?void 0:m.objects)?Object.values(this.gameLibrary.objects).filter(m=>!!m.wall):void 0}return this.wallObjects}getGameWallCategories(){if(!this.wallCategories){let m=this.getGameWallObjects();this.wallCategories=null==m?void 0:m.reduce((m,R)=>({...m,[R.wall.type]:[...m[R.wall.type]||[],R]}),{})}return this.wallCategories}getGameTilesObjects(){var m;return(null===(m=this.gameLibrary)||void 0===m?void 0:m.tilesets)?Object.values(this.gameLibrary.tilesets):void 0}getGameItems(){var m;let R=null===(m=this.gameLibrary)||void 0===m?void 0:m.items;return R}getGameItem(m){var R;let C=null===(R=this.gameLibrary)||void 0===R?void 0:R.items[m];return C}getGameEntities(){if(this.gameLibrary){var m;return Object.values(null===(m=this.gameLibrary)||void 0===m?void 0:m.entities)}}getGameEntity(m){var R;return null===(R=this.gameLibrary)||void 0===R?void 0:R.entities[m]}getGameAvatar(m){var R;return null===(R=this.gameLibrary)||void 0===R?void 0:R.avatars[m]}getGameAvatars(){var m;return null===(m=this.gameLibrary)||void 0===m?void 0:m.avatars}getTenants(){var m;return null===(m=this.gameLibrary)||void 0===m?void 0:m.tenants}getTraitVariations(m,R){let C,T=[],L=R;if(R.includes(".")){let[m,T]=R.split(".");C=T,L=m}if(m&&(T=Object.values(m).filter(m=>m.type===L)),C){let m=T[0],R=[m];return T.forEach(m=>{R.map(m=>m[C]).includes(m[C])||R.push(m)}),R}return T}getGameAvatarTypesOfTraits(m){let R=new Set,C=this.getGameAvatar(m);return C&&C.defaults&&("function"==typeof C.defaults.forEach?C.defaults.forEach(m=>{"item"!==m.type&&("hair"!==m.type?R.add(m.type):(R.add("".concat(m.type,".style")),R.add("".concat(m.type,".color"))))}):"object"==typeof C.defaults&&Object.keys(C.defaults).forEach(m=>{R.add(m)})),Array.from(R.values())}getGameAvatarTraitsOfType(m,R){let C,T=[],L=this.getGameAvatar(m),U=R;if(R.includes(".")){let[m,T]=R.split(".");C=T,U=m}if(L&&L.defaults&&(T=Object.values(L.defaults).filter(m=>m.type===U)),C){let m=T[0],R=[m];return T.forEach(m=>{R.map(m=>m[C]).includes(m[C])||R.push(m)}),R}return T}getGameAvatarWithRandomTraits(m){let R=this.getGameAvatarTypesOfTraits(m),C=R.map(R=>this.getGameAvatarTraitsOfType(m,R)),T=C.map(m=>m[Math.floor(Math.random()*m.length)]);return T.reduce((m,R)=>({...m,[R.type]:R}),{})}getGameTiles(){var m;return null===(m=this.gameLibrary)||void 0===m?void 0:m.tilesets}getGameSoils(){var m,R;if(null===(m=this.gameLibrary)||void 0===m?void 0:m.entities)return Object.values(null===(R=this.gameLibrary)||void 0===R?void 0:R.entities)}getGameSound(m){var R;return(null===(R=this.gameLibrary)||void 0===R?void 0:R.sounds)&&this.gameLibrary.sounds.get(m)}getGameCurrency(m){var R;return null===(R=this.gameLibrary)||void 0===R?void 0:R.currencies[m]}getGameCurrencies(){var m;return null===(m=this.gameLibrary)||void 0===m?void 0:m.currencies}setMapLibrary(m){(null==m?void 0:m.config)&&(this.mapLibrary=m)}async updateLibraryItems(m){var R;if(this.gameLibrary&&(null===(R=this.mapLibrary)||void 0===R?void 0:R.config)&&(null==m?void 0:m.length))try{let R=await this.api.fetchGameLibraryExtras({items:m});this.updateGameLibrary(this.transformGameLibraryUpdate(R))}catch(m){console.error("failure getting supplemental objects")}}async scanGameLibrary(m){var R;if(!this.gameLibrary||!(null===(R=this.mapLibrary)||void 0===R?void 0:R.config))return;let C={objects:new Set,entities:new Set,tilesets:new Set,sounds:new Set};this.mapLibrary.config.objects&&Object.entries(this.mapLibrary.config.objects).forEach(m=>{let[,R]=m;this.gameLibrary.objects&&Object.hasOwn(this.gameLibrary.objects,R.object)||C.objects.add(R.object)}),this.mapLibrary.config.tiles&&Object.entries(this.mapLibrary.config.tiles).forEach(m=>{let[,R]=m;this.gameLibrary.tilesets&&Object.hasOwn(this.gameLibrary.tilesets,R.tileset)||C.tilesets.add(R.tileset)}),this.mapLibrary.config.sounds&&this.mapLibrary.config.sounds.forEach(m=>{this.gameLibrary.sounds&&this.gameLibrary.sounds.has(m)||C.sounds.add(m)}),m.forEach(m=>{this.gameLibrary.entities&&Object.hasOwn(this.gameLibrary.entities,m.entity)||C.entities.add(m.entity)});let T=!0,L={};if(Object.entries(C).filter(m=>{let[,R]=m;return R.size>0}).forEach(m=>{let[R,C]=m;T=!1,L[R]=Array.from(C)}),!T){console.log("waiting to retrieve missing elements",L);try{let m=await this.api.fetchGameLibraryExtras(L);this.updateGameLibrary(this.transformGameLibraryUpdate(m))}catch(m){console.error("failure getting supplemental objects")}}}async getUgcDecorations(m){let{onlyFetchPending:R}=m,C=await this.api.fetchingUgcDecorations({onlyFetchPending:R});return this.updateGameLibrary(this.transformGameLibraryUpdate({objects:C.objects})),C}async approveUgcDecoration(m){let{itemId:R,objectId:C}=m,T=await this.api.approveUgcDecoration({itemId:R,objectId:C});return T}async rejectUgcDecoration(m){let{itemId:R,objectId:C,reason:T}=m,L=await this.api.rejectUgcDecoration({itemId:R,objectId:C,reason:T});return L}getDefaultCurrency(){var m;return(null===(m=this.mapLibrary)||void 0===m?void 0:m.defaultCurrency)||"cur_berry"}getMapType(){var m;return(null===(m=this.mapLibrary)||void 0===m?void 0:m.type)||"public"}getMapObjects(){var m;return null===(m=this.mapLibrary)||void 0===m?void 0:m.config.objects}getMapObject(m){var R;return null===(R=this.getMapObjects())||void 0===R?void 0:R[m]}getMapBackground(){var m,R,C;let T=null===(m=this.mapLibrary)||void 0===m?void 0:m.config.background;if(!T)return;let L=null===(C=this.gameLibrary)||void 0===C?void 0:null===(R=C.objects)||void 0===R?void 0:R[T];if(L)return L}addMapObject(m){let R=this.getMapObjects();if(R){let C=R[m._id];C?Object.assign(C,m):R[m._id]=m}}updateMapTiles(m){let R=this.getMapTiles();m&&R&&m.forEach(m=>{R[m._id]=m})}removeMapObject(m){let R=this.getMapObjects();R&&delete R[m._id]}getMapTiles(){var m;return null===(m=this.mapLibrary)||void 0===m?void 0:m.config.tiles}getNPCProperties(m){return{npcType:m}}getMapSounds(){var m,R;return null===(R=this.mapLibrary)||void 0===R?void 0:null===(m=R.config)||void 0===m?void 0:m.sounds}getMapLabels(){var m;return null===(m=this.mapLibrary)||void 0===m?void 0:m.labels}getStoreData(){var m;return null===(m=this.gameLibrary)||void 0===m?void 0:m.stores}getStore(m){var R,C;return null===(C=this.gameLibrary)||void 0===C?void 0:null===(R=C.stores)||void 0===R?void 0:R[m]}getMapTilesAt(m){let R;return this.mapLibrary&&(R=Object.values(this.mapLibrary.config.tiles).filter(R=>R.x===m.x&&R.y===m.y)),R}getGameQuests(){var m;let R=null===(m=this.gameLibrary)||void 0===m?void 0:m.quests;return R}getMapTile(m){var R;return null===(R=this.mapLibrary)||void 0===R?void 0:R.config.tiles[m]}getGameAchievement(m){var R,C;return null===(C=this.gameLibrary)||void 0===C?void 0:null===(R=C.achievements)||void 0===R?void 0:R[m]}getGameAchievements(){var m;return(null===(m=this.gameLibrary)||void 0===m?void 0:m.achievements)?Object.values(this.gameLibrary.achievements):void 0}constructor(m){this.api=m}}(T.Z)},10333:function(m,R,C){"use strict";C.r(R),C.d(R,{default:function(){return _app}});var T=C(85893),L=C(67294),U=C(11163),$=C(25617),B=C(48583);C(39135),C(993),C(46305),C(17591);var V=C(80535);let pageview=m=>{var R,C;(null===(R=window)||void 0===R?void 0:R.gtag)&&(null===(C=window)||void 0===C||C.gtag("config","G-QGP383C71B",{page_path:m}))};var _app=m=>{let{Component:R,pageProps:C}=m,H=(0,U.useRouter)();return(0,L.useEffect)(()=>{let handleRouteChange=m=>{pageview(m)};return H.events.on("routeChangeComplete",handleRouteChange),()=>{H.events.off("routeChangeComplete",handleRouteChange)}},[H.events]),(0,T.jsx)(T.Fragment,{children:(0,T.jsx)($.zt,{store:V.h,children:(0,T.jsx)(B.zt,{store:V.e,children:(0,T.jsx)(R,{...C})})})})}},86731:function(m,R,C){"use strict";C.d(R,{H:function(){return addHandler},q:function(){return T}});let T={};function addHandler(m,R){if(m in T){let C=T[m];T[m]=(m,T)=>{C(m,T),R(m,T)}}else T[m]=R}},86193:function(m,R,C){"use strict";C.d(R,{U:function(){return sendTradeEvent},V:function(){return getSlotItem}});var T=C(86731),L=C(46787),U=C(34377),$=C(16562),B=C(19445),V=C(80535);function sendTradeEvent(m){U.ZP.sendEvent(U.fb.TRADE_SEND,m)}function getSlotItem(m,R){var C,T;let L=$.l.getInstance(),U=m?null===(T=L.getEntityByUniqueId(m))||void 0===T?void 0:null===(C=T.storage)||void 0===C?void 0:C.slots:L.currentPlayer.full.inventory.slots;if(!U)return;let B="get"in U?U.get(R.toString()):U[R];return B}function getTrade(m){return V.e.get(L.eH)?void 0:(0,L.sG)(m.getState())}let adjustTradeItems=(m,R)=>{var C;let{slot:T,item:U,adjustment:B,sourceSlot:V}=m,H=R.getState(),G=(0,L.KU)(H),q=getTrade(R);if(!q||!G)return;let W=$.l.getInstance(),Z=W.getSessionId();if(!Z)return;let Y=null===(C=q.players[Z])||void 0===C?void 0:C.items;if(!Y)return;let K=Y.map(m=>m),J=K.find(m=>m.slot===T);if(J&&!U){let m=J.quantity+B;K=K.filter(m=>m.slot!==T),m>0&&K.push({...J,quantity:m})}else{if(!U)return;K=K.filter(m=>m.slot!==T&&m.originalSlot!==V),B>0&&K.push({item:U,quantity:B,originalSlot:null!=V?V:0,originalSource:void 0,slot:T})}sendTradeEvent({subcommand:"update",tradeId:G,trade:{items:K}})};(0,T.H)("game/PLAYER_INVENTORY_CHANGE",(m,R)=>{var C;let T=R.getState(),U=(0,L.KU)(T),B=getTrade(R);if(!B||!U)return;let{inventory:V}=m,H=$.l.getInstance(),G=H.getSessionId(),q=null===(C=B.players[G])||void 0===C?void 0:C.items;if(!q)return;let W=!1,Z=q.filter(m=>{var R;let C=null===(R=V.slots)||void 0===R?void 0:R[m.originalSlot.toString()];return!!C&&C.item===m.item&&!(C.quantity{var C;let{slot:T,mouseButton:U}=m,V=R.getState(),H=(0,L.KU)(V),G=getTrade(R);if(!G||!H)return;let q=$.l.getInstance(),W=q.getSessionId();if(!W)return;let Z=null===(C=G.players[W])||void 0===C?void 0:C.items;if(!Z)return;let Y=(0,B.B6)(V),K=(0,B.xM)(V),J=Z.find(m=>m.slot===T);0===U?Y?adjustTradeItems({slot:T,item:Y.id,sourceSlot:K.slot,adjustment:Math.min(1,K.quantity)},R):J&&!Y&&adjustTradeItems({slot:T,adjustment:-J.quantity},R):2===U&&!Y&&J&&adjustTradeItems({slot:T,adjustment:-Math.ceil(J.quantity/2)},R)})},22181:function(m,R,C){"use strict";C.d(R,{R:function(){return U}});var T=C(7406),L=C(70247);let U=(0,T.hg)("game/authenticatedWallet",async(m,R)=>{try{let C=await L.Z.loadLibraries(m.mapId);if(!L.Z.isValid())throw"invalid-game-library";R.dispatch({type:"game/LIBRARY",payload:!!C})}catch(m){R.dispatch({type:"game/SVR_CANNOTCONNECT",payload:{message:["serverOffline","Server Offline"]}})}return m})},92217:function(m,R,C){"use strict";C.d(R,{$O:function(){return en},DH:function(){return authOnetimeSelector},Ec:function(){return usernameSelector},Gq:function(){return isAuthenticatedSelector},H2:function(){return authLoadingSelector},Kx:function(){return q},MD:function(){return K},RT:function(){return J},Ti:function(){return authProviderSelector},WS:function(){return authEmailSelector},YR:function(){return X},ZP:function(){return authErrorSelector},cQ:function(){return noticeDialogSelector},cm:function(){return et},cn:function(){return Y},cu:function(){return defaultAvatarSelector},eW:function(){return W},fq:function(){return cryptoWalletsSelector},gz:function(){return ei},iM:function(){return Q},k4:function(){return er},vU:function(){return eo},z1:function(){return ee}});var T=C(7406),L=C(79750),U=C(16562),$=C(89733),B=C(70247),V=C(60604),H=C(39135);let G=(0,T.oM)({name:"auth",initialState:{connected:!1,isAccountDirty:!1,showWalletNotFoundWarning:!1,authenticated:!1,loading:!0,noticeDialog:{visible:!1,allowClose:!1,allowReload:!0,msgKey:""}},reducers:{checkAuthentication:(m,R)=>{m.loading=!0,m.mapId=R.payload.mapId},walletRequired:(m,R)=>{m.showWalletNotFoundWarning=!1!==R.payload},setConnected:(m,R)=>{m.errorMessage="",m.connected=R.payload.connected,m.provider=R.payload.provider,m.eth=R.payload.eth,m.email=R.payload.email,m.newuser=R.payload.newuser,m.methodid=R.payload.methodid,m.code=R.payload.code,m.password=R.payload.password,m.isAccountDirty=!1,R.payload.connected&&(m.errorMessage=void 0)},continueAsGuest:(m,R)=>{var C;m.errorMessage=void 0,m.authenticated=!0,m.mapId=(null===(C=R.payload)||void 0===C?void 0:C.mapId)||(0,L.lf)(),m.loading=!1,m.sessionToken=null},createPlayer:(m,R)=>{if(m.errorMessage=void 0,m.sessionToken)console.log("waiting for middleware to createplayer"),m.loading=!0;else{console.log("continuing as guest");let C=R.payload.username;/^Guest-/i.test(null!=C?C:"")||(C="Guest-".concat(C)),m.username=C,m.playerAvatar=R.payload.avatarPieces}},loadingDone:m=>{m.loading=!1},authenticate:(m,R)=>{m.errorMessage=void 0,m.mapId=R.payload.mapId,m.loading=!0},updatedPlayer:(m,R)=>{R.payload.username&&(m.username=R.payload.username),R.payload.playerId&&(m.playerId=R.payload.playerId),R.payload.playerAvatar&&(m.playerAvatar=R.payload.playerAvatar),R.payload.mapId&&(m.mapId=R.payload.mapId),R.payload.cryptoWallets&&(m.cryptoWallets=R.payload.cryptoWallets)},authenticatedPlayer:(m,R)=>{m.loading=!1,m.username=R.payload.username,m.playerId=R.payload.playerId,R.payload.playerAvatar?m.playerAvatar=R.payload.playerAvatar:m.playerAvatar=B.Z.getGameAvatarWithRandomTraits(V.tU),R.payload.mapId&&(m.mapId=R.payload.mapId),m.authenticated=!0,m.sessionToken=R.payload.sessionToken,m.provider=R.payload.provider,m.cryptoWallets=R.payload.cryptoWallets,m.currentAvatar=R.payload.currentAvatar,m.errorMessage=void 0},authenticateError:(m,R)=>{var C;m.errorMessage=null===(C=R.payload)||void 0===C?void 0:C.message,m.loading=!1,m.connected=!1,m.provider=void 0,m.errorMessage&&console.log("set error message",JSON.stringify(m.errorMessage))},serviceNotification:(m,R)=>{var C,T;m.noticeDialog.visible=!0,m.noticeDialog.msgKey=R.payload.message,m.noticeDialog.allowClose=null===(C=R.payload.allowClose)||void 0===C||C,m.noticeDialog.allowReload=null===(T=R.payload.allowReload)||void 0===T||T},closeNotification:m=>{m.noticeDialog.allowClose&&(m.noticeDialog.visible=!1)},loggedOut:m=>{m.loading=!1,m.errorMessage=void 0,m.provider=void 0,m.authenticated=!1,m.connected=!1,m.playerId=void 0,m.username=void 0,m.sessionToken=null,m.playerAvatar=void 0,m.currentAvatar=void 0,m.isAccountDirty=!1,m.cryptoWallets=void 0},setIsAccountDirty:(m,R)=>{m.isAccountDirty=R.payload}},extraReducers:m=>{m.addCase("game/ROOM_LOADED",m=>{m.noticeDialog.visible=!1}),m.addCase("game/SVR_CANNOTCONNECT",(m,R)=>{var C;m.loading=!0,m.authenticated=!1,m.connected=!1,m.mapId=void 0,m.username=void 0,m.sessionToken=null,m.playerAvatar=void 0,m.currentAvatar=void 0,m.cryptoWallets=void 0,m.errorMessage=null===(C=R.payload)||void 0===C?void 0:C.message}),m.addCase("game/PLAYER_AVATAR",(m,R)=>{R.payload.success?(R.payload.username&&(m.username=R.payload.username),R.payload.playerAvatar&&(m.playerAvatar=R.payload.playerAvatar)):"username-already-exists"===R.payload.message?m.errorMessage=["nameInUse","Name in use"]:m.errorMessage=["internalServerError","Task Failed Successfully. msg: UpdateAvatar"]}),m.addCase("game/SERVICE_COMMAND",(m,R)=>{var C,T,L,V,G,q;let W=null==R?void 0:null===(T=R.payload)||void 0===T?void 0:null===(C=T.command)||void 0===C?void 0:C.toLowerCase();"notice"===W?(m.noticeDialog.visible=!0,m.noticeDialog.msgKey=R.payload.message,m.noticeDialog.allowClose=null===(L=R.payload.allowClose)||void 0===L||L,m.noticeDialog.allowReload=null===(V=R.payload.allowReload)||void 0===V||V,!1===R.payload.allowClose&&($.Z.killScene(),U.l.getInstance().disconnect())):"reload"!==W||!R.payload.id||(null===(G=m.reloadIds)||void 0===G?void 0:G.includes(R.payload.id))||(m.reloadIds||(m.reloadIds=[]),null===(q=(0,H.W)(!0))||void 0===q||q.catch(console.error),B.Z.clearGameLibrary(),B.Z.loadLibraries().catch(console.error),m.reloadIds.push(R.payload.id))})}}),defaultAvatarSelector=m=>m.auth.playerAvatar,isAuthenticatedSelector=m=>m.auth.authenticated,usernameSelector=m=>m.auth.username,authEmailSelector=m=>({email:m.auth.email,password:m.auth.password,newuser:m.auth.newuser}),authOnetimeSelector=m=>({method_id:m.auth.methodid,code:m.auth.code}),authProviderSelector=m=>m.auth.connected&&m.auth.provider,authLoadingSelector=m=>m.auth.loading,authErrorSelector=m=>m.auth.errorMessage,cryptoWalletsSelector=m=>m.auth.cryptoWallets,noticeDialogSelector=m=>m.auth.noticeDialog,{checkAuthentication:q,setConnected:W,walletRequired:Z,continueAsGuest:Y,createPlayer:K,loadingDone:J,authenticate:X,authenticatedPlayer:Q,updatedPlayer:ee,authenticateError:et,loggedOut:er,setIsAccountDirty:en,closeNotification:eo,serviceNotification:ei}=G.actions;R.Co=G.reducer},77341:function(m,R,C){"use strict";C.d(R,{F0:function(){return Z},Gp:function(){return missingToolsSelector},U1:function(){return selectedCraftableSelector},Uf:function(){return Y},Up:function(){return hasOngoingCraftSelector},XU:function(){return showCraftingUISelector},_r:function(){return K},hL:function(){return selectedCraftingTypeSelector},ki:function(){return tableSelector},og:function(){return allCraftablesSelector},sY:function(){return W},yq:function(){return J}});var T=C(7406),L=C(68697),U=C(70247),$=C(83171),B=C(34377),V=C(71343),H=C(16562);let entitySendEvent=(m,R,C,T)=>{if(m&&!R){let C=H.l.getInstance().getEntityByUniqueId(m);R=null==C?void 0:C.entity}R&&m&&B.ZP.postEvent(V.m.clickEntity,{mid:m,impact:C,entity:R,inputs:T})},G={achievements:{},showCrafting:!1,ui:{craftType:"cooking",tableTier:1,selectedCraftable:void 0}},q=(0,T.oM)({name:"craftingSlice",initialState:G,reducers:{selectCraftable:(m,R)=>{m.ui={...m.ui,selectedCraftable:R.payload.id}},closeCraftingDialog:m=>{m.showCrafting&&entitySendEvent(m.ui.table_mid,m.ui.table_entity,"uiclose"),m.showCrafting=!1},showCraftingWindow:(m,R)=>{let{craftType:C,source:T,achievement:L,state:U,quantity:$,finish:B,tableTier:V}=R.payload,H=null==U?void 0:U.startsWith("update:");(!H||m.showCrafting&&m.ui.table_mid===T)&&(m.showCrafting&&m.ui.table_mid&&m.ui.table_entity&&m.ui.craftType!==C&&entitySendEvent(m.ui.table_mid,m.ui.table_entity,"uiclose"),L?m.ui.selectedCraftable=L:T!==m.ui.table_mid&&(m.ui.selectedCraftable=void 0),m.ui.craftType=C,m.ui.tableTier=V,m.ui.table_mid=T,m.ui.quantity=$,m.ui.completionTime=B,m.ui.entityState=H?U.substring(7):U,m.ui.updated=Date.now(),m.showCrafting=!0)}},extraReducers:m=>{m.addCase("game/ROOM_LEAVE",m=>{m.achievements={},m.showCrafting=!1,m.ui={...G.ui}}),m.addCase("game/PLAYER_ACHIEVEMENT_ADD",(m,R)=>{m.achievements[R.payload.achievement.achievementId]=R.payload.achievement}),m.addCase("game/PLAYER_ACHIEVEMENT_CHANGED",(m,R)=>{m.achievements[R.payload.achievement.achievementId]=R.payload.achievement}),m.addCase("game/PLAYER_ACHIEVEMENT_REMOVED",(m,R)=>{delete m.achievements[R.payload.achievement.achievementId]})}}),{selectCraftable:W,closeCraftingDialog:Z,showCraftingWindow:Y}=q.actions;R.ZP=q.reducer;let showCraftingUISelector=m=>m.crafting.showCrafting,allCraftablesSelector=m=>Object.values(m.crafting.achievements),tableSelector=m=>m.crafting.ui,selectedCraftableSelector=m=>m.crafting.ui.selectedCraftable?m.crafting.achievements[m.crafting.ui.selectedCraftable]||{achievementId:m.crafting.ui.selectedCraftable}:null,K=(0,L.P1)([selectedCraftableSelector,$.RQ,m=>m.crafting.ui.entityState],(m,R,C)=>T=>{if(!m||"busy"===C)return!1;let L=U.Z.getGameAchievement(m.achievementId);return!!L&&!!L.craftable&&L.craftable.requiredItems.every(m=>{let C=R(m.id);return C>=m.quantity*T})}),J=(0,L.P1)([selectedCraftableSelector,$.xK],(m,R)=>C=>{let T=Object.values(R.slots);if(m){var L;let R=U.Z.getGameAchievement(m.achievementId);if(!R)return!1;let C=null===(L=R.craftable)||void 0===L?void 0:L.requiredItems.some(m=>T.filter(R=>R.item===m.id).some(R=>R.quantity===m.quantity));if(C)return!0}if(R.size>T.length)return!0;let $=U.Z.getGameItem(C);if(!$)return!1;let B=T.filter(m=>m.item===C).reduce((m,R)=>m+R.quantity,0);if(!B)return!1;if(!$.inventory.maxQuantity)return!0;let V=$.inventory.maxQuantity-B%$.inventory.maxQuantity;return V>0}),missingToolsSelector=m=>{let R=selectedCraftableSelector(m);if(!R)return[];let C=U.Z.getGameAchievement(R.achievementId);return C&&C.craftable?C.craftable.requiredItems.filter(R=>R.unconsumable&&R.quantity>(0,$.RQ)(m)(R.id)):[]},selectedCraftingTypeSelector=m=>m.crafting.ui.craftType,hasOngoingCraftSelector=m=>{var R;return!!((null===(R=m.crafting.ui)||void 0===R?void 0:R.entityState)&&["crafting","ready"].includes(m.crafting.ui.entityState))}},39890:function(m,R,C){"use strict";C.d(R,{b:function(){return U}});var T=C(7406),L=C(16562);let U=(0,T.hg)("game/fetchWorlds",async()=>L.l.getInstance().worldService.fetchWorldData())},34256:function(m,R,C){"use strict";C.d(R,{$J:function(){return el},E3:function(){return eE},Fd:function(){return X},GP:function(){return et},Hi:function(){return K},Mr:function(){return eu},Nb:function(){return ee},Rp:function(){return ef},Sm:function(){return es},XK:function(){return eS},dM:function(){return en},dd:function(){return e_},eW:function(){return ec},iJ:function(){return eh},io:function(){return ea},lW:function(){return eg},ni:function(){return ei},nl:function(){return Q},ol:function(){return er},po:function(){return ed},r$:function(){return eb},tD:function(){return J},uy:function(){return eo},zR:function(){return ep}});var T,L,U=C(7406),$=C(39890),B=C(83928),V=C(79750),H=C(34377),G=C(60604),q=C(70247),W=C(34853);let Z={loading:!0,warping:!1,connected:!1,needNfts:!1,worlds:{total:0,maxPlayersPerWorld:0,worlds:[]},room:{levels:{}},gameLibraryLoaded:!1,player:{core:{mid:"butch",isGuest:!0,position:{x:3e3,y:3e3},velocity:{x:0,y:0},username:"",playerAvatar:"",currentAvatar:{id:"",pieces:""},typingTimestamp:0},full:{createdAt:0,cryptoWallets:[],inventory:{size:0,slots:{},activeRow:0},energy:{level:90},levels:{farming:{level:0,exp:1,totalExp:1}},avatar:{display:{body:{species:"human",type:"body",color:"light",gender:"female"},eyes:{species:"human",eyes:"simple"},outfit:{type:"outfit",species:"human",style:"semicasual"},mouth:{species:"human",mouth:"smile"},hair:{style:"elf",color:"black",type:"hair",species:"human"}}},nft:"",animation:"walk",quests:{},bookmarks:{size:3,baseSize:3,bookmarkedMaps:[]},messages:0}},urlDisclaimer:{isActive:!1},lookAtText:{isActive:!1,x:0,y:0,text:""},farmPicker:{isActive:!1},currentModal:"",npc_dialog:{isActive:!1,character:"ent_npcMayor",currentMessageIndex:0,messages:[],queue:[]},playersOnline:{isVisible:!1,updated:0},playerOnlineInfo:{isVisible:!1,mid:"",username:""},soundState:{global:{mute:"1"===(0,B.Ul)("global_mute"),volume:parseFloat(null!==(T=(0,B.Ul)("global_volume"))&&void 0!==T?T:"1")},music:{mute:"1"===(0,B.Ul)("music_mute"),volume:parseFloat(null!==(L=(0,B.Ul)("music_volume"))&&void 0!==L?L:"1")}},enhancedState:{enabled:"1"===(0,B.Ul)("enhanced_enabled")},joystickState:{enabled:"1"!==(0,B.Ul)("joystick_disabled")},criticalMessage:{isActive:!1,text:"Reconnecting to Server..."},nftPicker:{isVisible:!1},petPicker:{isVisible:!1,mode:"hatched"},realmrefresh:!1,petDetails:{isVisible:!1},socialSettings:{isVisible:!1},questLog:{isVisible:!1},showSkills:!1,showSettings:!1,farmDetails:{isActive:!1,mapId:(0,V.lf)()},sidePanel:{isActive:!1},farmUpgradePanel:{isActive:!1}},updatePlayerLevelReducer=(m,R)=>{var C;let{key:T,level:L}=R.payload;(null===(C=m.player)||void 0===C?void 0:C.full)&&(m.player.full.levels||(m.player.full.levels={}),T&&L&&(m.player.full.levels[T]=L))},updateRoomLevelReducer=(m,R)=>{let{key:C,level:T}=R.payload;m.room&&m.room.levels&&(m.room.levels[C]=T)},pushNPCDialog=(m,R)=>{var C;if(R.pet&&(m.npc_dialog.isActive&&m.npc_dialog.pet||m.npc_dialog.queue.some(m=>{var C,T;return m.pet&&(null===(C=m.messages)||void 0===C?void 0:C.length)===(null===(T=R.messages)||void 0===T?void 0:T.length)&&m.messages.every((m,C)=>m===R.messages[C])})))return;let T=null===(C=R.messages)||void 0===C?void 0:C.some(m=>{if(m.includes(" ")||!m.includes("_"))return!1;let R=W.ZP.t(m,{ns:"quest",defaultValue:""})||W.ZP.t(m,{ns:"game",defaultValue:""});return""===R});return m.npc_dialog.queue.push(R),T},nextNPCDialogGroup=m=>{if(m.npc_dialog.queue.length>0){let R=m.npc_dialog.queue[0];m.npc_dialog.isActive=!0,m.npc_dialog.currentMessageIndex=0,m.npc_dialog.character=R.npcId,m.npc_dialog.pet=R.pet,m.npc_dialog.messages=R.messages,m.npc_dialog.event=R.event,m.npc_dialog.queue=m.npc_dialog.queue.slice(1)}else m.npc_dialog.isActive=!1,m.npc_dialog.currentMessageIndex=0,m.npc_dialog.character=void 0,m.npc_dialog.pet=void 0,m.npc_dialog.messages=[]},Y=(0,U.oM)({name:"game",initialState:Z,reducers:{mapSelected:(m,R)=>{m.room.mapId=R.payload.mapId,m.room.lastSavedAt=R.payload.lastSavedAt},dialogNext:m=>{let{messages:R}=m.npc_dialog,{currentMessageIndex:C}=m.npc_dialog;C+=1,R&&C{m.npc_dialog.currentMessageIndex=Math.max(m.npc_dialog.currentMessageIndex-1,0)},togglePlayersOnline:m=>{m.playersOnline.isVisible=!m.playersOnline.isVisible},setPlayerOnlineInfo:(m,R)=>{m.playerOnlineInfo={isVisible:!0,...R.payload}},unsetPlayerOnlineInfo:m=>{m.playerOnlineInfo={isVisible:!1,mid:"",username:""}},toggleQuestLog:m=>{m.questLog.isVisible=!m.questLog.isVisible},toggleSkills:m=>{m.showSkills=!m.showSkills},setWorld:(m,R)=>{m.room.worldId=R.payload.worldId,m.room.mapId=R.payload.mapId,m.criticalMessage.text="Loading...",m.criticalMessage.isActive=!0},dismissURLDisclaimer:m=>{m.urlDisclaimer.isActive=!1},logOut:m=>{m.loading=!0,m.connected=!1,m.needNfts=!1,m.lookAtText.isActive=!1,m.room.worldId=void 0,m.room.mapId=void 0,m.room.lastSavedAt=void 0,m.npc_dialog.isActive=!1,m.sidePanel.isActive=!1,m.farmUpgradePanel.isActive=!1,m.questLog.isVisible=!1,m.criticalMessage.isActive=!1},updateLookAt:(m,R)=>{let{mouse:C,text:T,style:L}=R.payload;m.lookAtText={isActive:!0,text:T,x:Math.round(C.x),y:Math.round(C.y),style:L}},roomWarpBegan:(m,R)=>{var C;(null===(C=R.payload)||void 0===C?void 0:C.abort)?m.warping=!1:m.warping=!0},roomWarpLoading:(m,R)=>{m.room.mapId=R.payload.mapId,m.loading=!0},closeModal:m=>{m.currentModal=""},toggleModal:(m,R)=>{let C=R.payload.dialog;C===m.currentModal?m.currentModal="":(m.currentModal=C,"nftpicker"===C&&(m.needNfts=!0))},openPetPicker:(m,R)=>{var C,T,L,U;(null===(C=m.player)||void 0===C?void 0:C.core.isGuest)||(m.needNfts=!0,m.petPicker.mode=null!==(U=null===(T=R.payload)||void 0===T?void 0:T.mode)&&void 0!==U?U:"hatched",m.petPicker.isVisible=!0,m.petPicker.entity=null===(L=R.payload)||void 0===L?void 0:L.entity,m.currentModal="",m.questLog.isVisible=!1,m.petDetails.isVisible=!1,m.farmDetails.isActive=!1)},closePetPicker:m=>{m.petPicker.isVisible=!1},mintedPet:m=>{m.petPicker.refresh=Date.now()+6e5},togglePetDetails:(m,R)=>{var C;(null===(C=R.payload)||void 0===C?void 0:C.petId)?(m.petDetails.mid=R.payload.petId,m.petDetails.isVisible=!0,m.petDetails.firstReveal=!0,m.petPicker.refresh=Date.now()):(m.petDetails.mid=void 0,m.petDetails.isVisible=!m.petDetails.isVisible,m.petDetails.firstReveal=!1)},toggleSidePanel:m=>{m.sidePanel.isActive=!m.sidePanel.isActive},activateSidePanel:m=>{m.sidePanel.isActive=!0},activateFarmUpgradePanel:m=>{m.farmUpgradePanel.isActive=!0},deactivateFarmUpgradePanel:m=>{m.farmUpgradePanel.isActive=!1},updateTemplateName:(m,R)=>{m.room.templateName=R.payload.newTemplate},openSettings:m=>{m.showSettings=!0},closeSettings:m=>{m.showSettings=!1},clearRealmRefresh:m=>{m.realmrefresh=!1}},extraReducers:m=>{m.addCase("game/ROOM_LEAVE",m=>{m.playerOnlineInfo.isVisible=!1,m.lookAtText.isActive=!1,m.npc_dialog.isActive=!1,m.sidePanel.isActive=!1,m.farmUpgradePanel.isActive=!1,m.showSkills=!1,m.questLog.isVisible=!1,m.farmDetails.isActive=!1,m.petPicker.isVisible=!1,m.petDetails.isVisible=!1,m.room.levels={}}),m.addCase("game/ROOM_LOADED",(m,R)=>{m.player=R.payload.player,m.playerOnlineInfo.isVisible=!1,m.lookAtText.isActive=!1,m.room.roomType=R.payload.roomType,m.room.templateName=R.payload.templateName,m.sessionId=R.payload.sessionId,m.criticalMessage.isActive=!1,m.npc_dialog.isActive=!1,m.sidePanel.isActive=!1,m.farmUpgradePanel.isActive=!1,m.showSkills=!1,m.showSettings=!1,m.questLog.isVisible=!1,m.farmDetails.mapId=R.payload.mapId,m.farmDetails.isActive=!1,m.currentModal="",m.petPicker.isVisible=!1,m.petDetails.isVisible=!1}),m.addCase("game/PLAYER_AVATAR",(m,R)=>{if(R.payload.success)switch(m.currentModal){case"avatar":case"nftpicker":case"social":case"username":m.currentModal=""}}),m.addCase("game/ROOM_WARP",m=>{m.lookAtText.isActive=!1,m.npc_dialog.isActive=!1,m.sidePanel.isActive=!1,m.farmUpgradePanel.isActive=!1,m.showSkills=!1,m.showSettings=!1,m.questLog.isVisible=!1,m.farmDetails.isActive=!1,m.needNfts=!1,m.room.lastSavedAt=void 0}),m.addCase("game/SLOW_LOAD",(m,R)=>{var C;(null===(C=R.payload)||void 0===C?void 0:C.retry)?(R.payload.retry<=2?m.criticalMessage.text="Retrying Connection":m.criticalMessage.text="Retrying Connection x".concat(R.payload.retry-1),m.criticalMessage.isActive=!0):m.criticalMessage.isActive||(m.criticalMessage.text="Still Loading...",m.criticalMessage.isActive=!0)}),m.addCase("game/GAME_INITIATED",m=>{m.loading=!1,m.warping=!1,m.connected=!0,m.criticalMessage.isActive=!1,m.room.lastSavedAt=void 0}),m.addCase("game/PLAYER_JOINED",m=>{m.playersOnline.updated+=1}),m.addCase("game/PLAYER_REMOVED",m=>{m.playersOnline.updated+=1}),H.rV.soundControl.addReduxCase(m,(m,R)=>{let{payload:{soundControlKey:C,mute:T,volume:L}}=R;void 0!==T&&(m.soundState[C].mute=T,(0,B.Ul)("".concat(C,"_mute"),T?"1":"0")),void 0!==L&&(L=Math.min(Math.max(L,0),1),m.soundState[C].volume=L,(0,B.Ul)("".concat(C,"_volume"),L.toString()))}),H.rV.enhancedControl.addReduxCase(m,(m,R)=>{let{payload:{enabled:C}}=R;void 0!==C&&(m.enhancedState.enabled=C,(0,B.Ul)("enhanced_enabled",C?"1":"0"),setTimeout(()=>{window.location.reload()},2e3))}),H.rV.joystickControl.addReduxCase(m,(m,R)=>{let{payload:{enabled:C}}=R;void 0!==C&&(m.joystickState.enabled=C,(0,B.Ul)("joystick_disabled",C?"0":"1"))}),m.addCase("game/LINK_OPEN",(m,R)=>{let{link:C,msgKey:T}=R.payload;T||(0,B.fI)(C)?(m.urlDisclaimer.isActive=!0,m.urlDisclaimer.URL=C,m.urlDisclaimer.msgKey=T):(0,B.T1)(C)?window.location.href=C:window.open(C,"_blank")}),m.addCase("game/GAME_OBJECT_MOUSEOVER",(m,R)=>{let{mouse:C,text:T,style:L}=R.payload;m.lookAtText={isActive:!!T,text:T,x:Math.round(C.x),y:Math.round(C.y),style:L}}),m.addCase("game/GAME_OBJECT_MOUSEOUT",m=>{m.lookAtText={...m.lookAtText,isActive:!1}}),m.addCase("game/LIBRARY",(m,R)=>{var C;m.gameLibraryLoaded=!!R.payload,(null===(C=q.Z.getTenants())||void 0===C?void 0:C[(0,V.F5)()])||(m.criticalMessage.text="Unknown Realm...You could be waiting a long time.",m.criticalMessage.isActive=!0,m.gameLibraryLoaded=!1)}),m.addCase("game/PLAYER_INVENTORY_CHANGE",(m,R)=>{var C;let{inventory:T}=R.payload;T&&(null===(C=m.player)||void 0===C?void 0:C.full.inventory)&&(m.player.full.inventory=T)}),m.addCase("game/PLAYER_COIN_INVENTORY_CHANGE",(m,R)=>{var C;let{coinInventory:T}=R.payload;T&&(null===(C=m.player)||void 0===C?void 0:C.full.coinInventory)&&(m.player.full.coinInventory=T)}),m.addCase("game/PLAYER_QUESTPROGRESS_ADDED",(m,R)=>{var C;let{quests:T}=R.payload;T&&(null===(C=m.player)||void 0===C?void 0:C.full.quests)&&(m.player.full.quests=T)}),m.addCase("game/PLAYER_LEVEL_ADD",updatePlayerLevelReducer),m.addCase("game/PLAYER_LEVEL_CHANGE",updatePlayerLevelReducer),m.addCase("game/SVR_CANNOTCONNECT",(m,R)=>{var C,T;m.loading=!0,m.connected=!1,m.lookAtText.isActive=!1,m.room.worldId=void 0,m.room.mapId=void 0,m.room.lastSavedAt=void 0,m.criticalMessage.text=null===(C=R.payload)||void 0===C?void 0:C.message,(null===(T=R.payload)||void 0===T?void 0:T.message)&&(m.criticalMessage.isActive=!0)}),m.addCase("game/NPC_SPEAKS",(m,R)=>{let C=R.payload;"function"!=typeof C.forEach&&(C=[C]);let T=C.reduce((R,C)=>pushNPCDialog(m,C)||R,!1);T?(console.log("reloading string resources for missing dialog"),W.ZP.reloadResources().then(()=>{m.npc_dialog.isActive||nextNPCDialogGroup(m)}).catch(console.error)):m.npc_dialog.isActive||nextNPCDialogGroup(m)}),m.addCase("game/PLAYER_ENERGY_CHANGE",(m,R)=>{var C;let{energy:T}=R.payload;T&&(null===(C=m.player)||void 0===C?void 0:C.full.energy)&&(m.player.full.energy=T)}),m.addCase($.b.fulfilled,(m,R)=>{m.worlds=R.payload}),m.addCase("game/PRESENT_FARM_DETAILS",m=>{m.farmDetails.isActive=!0}),m.addCase("game/DISMISS_FARM_DETAILS",m=>{m.farmDetails.isActive=!1}),m.addCase("game/PLAYER_EXP_CHANGE",(m,R)=>{m.player&&(m.player.full.levels={...R.payload.levels})}),m.addCase("game/ROOM_LEVEL_ADD",updateRoomLevelReducer),m.addCase("game/ROOM_LEVEL_CHANGED",updateRoomLevelReducer),m.addCase("game/BOOKMARK_MAP",(m,R)=>{var C;let{mapId:T,bookmark:L,environ:U}=R.payload,$=null===(C=m.player)||void 0===C?void 0:C.full.bookmarks;$&&($.bookmarkedMaps||($.bookmarkedMaps=[]),L&&T?$.bookmarkedMaps.push({mapId:T,environ:U}):!L&&T&&($.bookmarkedMaps=$.bookmarkedMaps.filter(m=>{var R;return(null!==(R=null==m?void 0:m.mapId)&&void 0!==R?R:m)!==T})))}),m.addCase("game/".concat(H.fb.SET_TOS_ACCEPTED),m=>{m.player&&(m.player.full.tosVersion=G.sV)}),m.addCase("game/".concat(H.fb.PLAYER_PET_CHANGE),(m,R)=>{if(m.player){var C,T,L,U;((null===(C=m.player.full.pet)||void 0===C?void 0:C.tokenId)!==(null===(T=R.payload.full.pet)||void 0===T?void 0:T.tokenId)||(null===(L=m.player.full.pet)||void 0===L?void 0:L.avatar.id)!==(null===(U=R.payload.full.pet)||void 0===U?void 0:U.avatar.id))&&(m.petDetails.isVisible=!1),m.player.core.petAvatar=R.payload.core.petAvatar,m.player.full.pet=R.payload.full.pet}}),m.addCase("game/".concat(H.fb.CLIENT_CMD),(m,R)=>{let C=R.payload;"petmint"===C.detail&&(m.petPicker.refresh=Date.now()+9e5),"realmmint"===C.detail&&(m.realmrefresh=!0)})}}),{mapSelected:K,roomWarpBegan:J,roomWarpLoading:X,dialogNext:Q,dialogBack:ee,togglePlayersOnline:et,setPlayerOnlineInfo:er,unsetPlayerOnlineInfo:en,setWorld:eo,logOut:ei,updateLookAt:ea,dismissURLDisclaimer:es,toggleModal:el,closeModal:eu,toggleQuestLog:ec,toggleSkills:ed,toggleSidePanel:ef,togglePetDetails:ep,closePetPicker:eh,openPetPicker:eg,activateSidePanel:em,activateFarmUpgradePanel:ey,deactivateFarmUpgradePanel:ev,openSettings:eb,closeSettings:eE,clearRealmRefresh:e_,updateTemplateName:eS}=Y.actions;R.ZP=Y.reducer},19445:function(m,R,C){"use strict";C.d(R,{$Z:function(){return q},B6:function(){return selectedItemSelector},NS:function(){return storageWindowState},aq:function(){return G},hO:function(){return W},me:function(){return V},oi:function(){return Z},pc:function(){return activeRow},xM:function(){return selectedEquipmentIndexSelector}});var T=C(7406),L=C(34377),U=C(16562);let $=(0,T.oM)({name:"storage",initialState:{openStorage:{isOpen:!1,updated:0},selectedEquipment:-1,selectedQty:0,activeRow:0},reducers:{closeStorage:m=>{m.openStorage.isOpen=!1},setActiveRow:(m,R)=>{let{payload:C}=R;m.activeRow=C,L.rV.inventory.changeActiveRow.emit({activeRow:C})},selectEquipment:(m,R)=>{var C,T;m.selectedEquipment=R.payload.selectedEquipment,m.storageMid=R.payload.mid,m.selectedItem=R.payload.item,m.selectedQty=null!==(T=R.payload.quantity)&&void 0!==T?T:1,(null===(C=m.selectedItem)||void 0===C?void 0:C.id)===m.highlightedItem&&(m.highlightedItem=void 0)},resetEquipment:m=>{L.ZP.sendEvent(L.qM.RELEASE_FROM_CURSOR),m.selectedEquipment=-1,m.storageMid=void 0,m.selectedItem=void 0},closeInventoryWindow:m=>{m.openStorage.isOpen=!1},toggleInventoryWindow:m=>{m.openStorage.isOpen&&!m.openStorage.mid?m.openStorage.isOpen=!1:m.openStorage={isOpen:!0,mid:void 0,updated:0}},moveEquipmentSlot:(m,R)=>{}},extraReducers:m=>{m.addCase("game/ROOM_LOADED",(m,R)=>{var C,T,L,U,$,B;m.selectedEquipment=-1,m.storageMid=void 0,m.selectedItem=void 0,(null===(L=R.payload.player)||void 0===L?void 0:null===(T=L.full)||void 0===T?void 0:null===(C=T.inventory)||void 0===C?void 0:C.activeRow)>=0&&(m.activeRow=null===(B=R.payload.player)||void 0===B?void 0:null===($=B.full)||void 0===$?void 0:null===(U=$.inventory)||void 0===U?void 0:U.activeRow),m.openStorage={isOpen:!1,updated:0}}),m.addCase("game/".concat(L.fb.PLAYER_PET_CHANGE),m=>{m.openStorage={isOpen:!1,updated:0}}),m.addCase("game/PLAYER_OPEN_STORAGE",(m,R)=>{let C=R.payload.storageId;C?m.openStorage={isOpen:!0,mid:C,updated:0}:m.openStorage={isOpen:!1,updated:0}}),m.addCase("game/ENTITY_ADD",(m,R)=>{let C=R.payload,T=C.mapEntity_id;m.openStorage.mid&&T===m.openStorage.mid&&(m.openStorage={isOpen:!0,mid:C.mid,updated:0})}),m.addCase("game/ROOM_LEAVE",m=>{m.openStorage={isOpen:!1,updated:0},m.selectedEquipment=-1,m.selectedItem=void 0,m.storageMid=void 0,m.highlightedItem=void 0}),m.addCase("game/ENTITY_UPDATE",(m,R)=>{R.payload.mid===m.openStorage.mid&&(m.openStorage.updated+=1)}),m.addCase("game/".concat(L.fb.CLIENT_CMD),(m,R)=>{let C=R.payload;if("itemhighlight"===C.detail){var T;m.highlightedItem=(null===(T=C.params)||void 0===T?void 0:T[0])||void 0}}),m.addCase("game/PLAYER_INVENTORY_CHANGE",(m,R)=>{let{inventory:C}=R.payload;m.activeRow=C.activeRow,function(m){let R;if(-1===m.selectedEquipment)return;let C=U.l.getInstance();if(m.storageMid){if(m.storageMid===C.mapStorageId)R=C.getMapStorage();else{let T=C.getEntityByUniqueId(m.storageMid);if(null==T?void 0:T.storage)R=T.storage;else{m.selectedEquipment=-1,m.storageMid=void 0;return}}}else R=C.currentPlayer.full.inventory;if(null==R?void 0:R.slots){R=JSON.parse(JSON.stringify(R));let C=Object.values(R.slots).find(R=>R.slot===m.selectedEquipment);(null==C?void 0:C.quantity)?m.selectedQty=C.quantity:(m.selectedEquipment=-1,m.storageMid=void 0,m.selectedItem=void 0,L.ZP.postEvent(L.qM.RELEASE_FROM_CURSOR))}}(m)}),m.addCase("game/PLAYER_INVENTORY_NEW",(m,R)=>{let{item:C}=R.payload;m.highlightedItem=C})}}),selectedEquipmentIndexSelector=m=>({slot:m.storage.selectedEquipment,storage:m.storage.storageMid,quantity:m.storage.selectedQty,attention:m.storage.highlightedItem}),selectedItemSelector=m=>{if(m.game.player)return m.storage.selectedItem},storageWindowState=m=>m.storage.openStorage||m.game.petDetails.isVisible,activeRow=m=>m.storage.activeRow,{closeStorage:B,closeInventoryWindow:V,toggleInventoryWindow:H,resetEquipment:G,selectEquipment:q,setActiveRow:W,moveEquipmentSlot:Z}=$.actions;R.ZP=$.reducer},83171:function(m,R,C){"use strict";C.d(R,{$b:function(){return playersOnlineSelector},$v:function(){return mapTypeSelector},$x:function(){return lookAtTextSelector},Ai:function(){return $},CO:function(){return petPickerSelector},GO:function(){return gameLoadingSelector},K7:function(){return gameWarpingSelector},Kx:function(){return soundSelector},NY:function(){return showSettingsSelector},Nz:function(){return dialogDataSelector},O$:function(){return showPlayersOnlineSelector},Od:function(){return mapSelector},PD:function(){return bookmarkedMapsSelector},QV:function(){return currentModal},Qk:function(){return showSidePanelSelector},RQ:function(){return U},SP:function(){return isLibraryLoadedSelector},TR:function(){return playerOnlineInfoSelector},U7:function(){return showIntroScreen},V4:function(){return roomLevelSelector},VQ:function(){return realmrefresh},Wj:function(){return templateNameSelector},Xt:function(){return worldSelector},_i:function(){return petDetailsSelector},b_:function(){return joystickSelector},cV:function(){return showSkillsSelector},ge:function(){return hasVip},gx:function(){return availableWorldsSelector},h2:function(){return showFarmUpgradePanel},iF:function(){return gameConnected},iN:function(){return URLDisclaimerSelector},lA:function(){return playerSelector},o7:function(){return showNftPicker},oJ:function(){return showDialogSelector},pB:function(){return dialogMessageSelector},pR:function(){return enhancedSelector},px:function(){return messageSelector},qB:function(){return showWorldPickerSelector},qb:function(){return playerLevelSelector},wk:function(){return gameNeedNfts},x6:function(){return hasModalSelector},xK:function(){return inventorySelector},y4:function(){return showQuestLogSelector},zY:function(){return maxBookmarksSizeSelector}});var T=C(68697),L=C(64939);let isLibraryLoadedSelector=m=>m.game.gameLibraryLoaded,showDialogSelector=m=>m.game.npc_dialog.isActive,showPlayersOnlineSelector=m=>m.game.playersOnline,showQuestLogSelector=m=>m.game.questLog,showNftPicker=m=>"nftpicker"===m.game.currentModal,petPickerSelector=m=>m.game.petPicker,petDetailsSelector=m=>m.game.petDetails,dialogMessageSelector=m=>{var R;let{npc_dialog:C}=m.game;return{dialogMessage:C.messages&&C.currentMessageIndexm.game.npc_dialog.isActive||m.game.currentModal||m.game.questLog.isVisible||m.game.petPicker.isVisible||m.game.petDetails.isVisible&&m.game.petDetails.firstReveal||m.generalStore.isOpen||m.ui.imageDialog.isVisible&&!m.ui.imageDialog.modeless||"none"!==m.marketplace.mode,lookAtTextSelector=m=>m.game.lookAtText,dialogDataSelector=m=>m.game.npc_dialog,messageSelector=m=>m.game.criticalMessage,playerSelector=m=>m.game.player,bookmarkedMapsSelector=m=>{var R;let C=null===(R=m.game.player)||void 0===R?void 0:R.full.bookmarks;return(null==C?void 0:C.bookmarkedMaps)||[]},maxBookmarksSizeSelector=m=>{var R,C;return(null===(C=m.game.player)||void 0===C?void 0:null===(R=C.full.bookmarks)||void 0===R?void 0:R.size)||L.vn},gameLoadingSelector=m=>m.game.loading||!m.auth.authenticated,gameWarpingSelector=m=>m.game.warping,gameNeedNfts=m=>m.game.needNfts,gameConnected=m=>!!m.game.connected&&m.game.sessionId,inventorySelector=m=>{var R;return null===(R=m.game.player)||void 0===R?void 0:R.full.inventory},hasVip=m=>{var R;let C=new Date,T=m.game.player,L=(null==T?void 0:T.core.memberships)&&(null===(R=T.core.memberships.vip)||void 0===R?void 0:R.expiration)?new Date(T.core.memberships.vip.expiration):null;return!!L&&CR=>{if(!m||!m||!m.slots||0===Object.keys(m.slots).length)return 0;let C=Object.values(m.slots).filter(m=>m.item===R);if(!C.length)return 0;let T=C.reduce((m,R)=>m+R.quantity,0);return T}),soundSelector=m=>m.game.soundState,enhancedSelector=m=>m.game.enhancedState,joystickSelector=m=>m.game.joystickState,playersOnlineSelector=m=>m.game.playersOnline.updated,playerOnlineInfoSelector=m=>m.game.playerOnlineInfo,currentModal=m=>m.game.currentModal,playerLevelSelector=m=>R=>{var C;return(null===(C=m.game.player)||void 0===C?void 0:C.full.levels)[R]},roomLevelSelector=m=>R=>m.game.room.levels[R],showWorldPickerSelector=m=>m.auth.authenticated&&m.auth.username&&m.auth.playerAvatar&&!m.game.room.worldId,showIntroScreen=m=>!m.game.room.worldId,availableWorldsSelector=m=>m.game.worlds,mapSelector=m=>m.game.room.mapId,mapTypeSelector=m=>m.game.room.roomType,worldSelector=m=>m.game.room.worldId,templateNameSelector=m=>m.game.room.templateName,URLDisclaimerSelector=m=>m.game.urlDisclaimer,showSkillsSelector=m=>m.game.showSkills,showSettingsSelector=m=>m.game.showSettings,$=(0,T.P1)([m=>m.game.farmDetails,m=>m.mapEditor.roomSettings],(m,R)=>({...m,farmName:R.name,ownership:R.ownership,ethAddress:R.ownerAddress,guild:R.guild})),showSidePanelSelector=m=>m.game.sidePanel.isActive,showFarmUpgradePanel=m=>m.game.farmUpgradePanel.isActive,realmrefresh=m=>m.game.realmrefresh},54698:function(m,R,C){"use strict";C.d(R,{tz:function(){return chatSelector},w2:function(){return B},wt:function(){return V}});var T=C(7406),L=C(39135),U=C(34377);function filterMessages(m){let R=Date.now();m=m.filter(m=>"sys"!==m.creator_id||R-m.createdAt<3e4);let C=m.length-1500;return C>0&&(m=m.slice(C)),m}function isSpecialCommand(m){return"pixels-bot"===m.creator_id&&m.message.startsWith("/COMMAND ")}function processCommand(m){if("pixels-bot"===m.creator_id){if(Date.now()-m.createdAt>12e5)return;let R=m.message.substring(9);if(!R.startsWith("{"))return U.ZP.postEvent(U.fb.SERVICE_COMMAND,{command:"Notice",message:R,allowClose:!0,allowReload:!0}),{...m,message:R};try{let C=JSON.parse(R);if(C.duration&&Date.now()-m.createdAt>C.duration)return;if(U.ZP.postEvent(U.fb.SERVICE_COMMAND,C),"notice"===C.command&&C.message)return{...m,message:C.message}}catch(m){console.log("invalid command",R,m)}}}let $=(0,T.oM)({name:"chatSlice",initialState:{isVisible:!1,openedNow:!1,newMessage:!1,chatEnabled:!0,messages:[{createdAt:0,creator_id:"",message:"Welcome To Pixels.",creatorName:"Pixels Bot"}]},reducers:{closeChat:m=>{m.isVisible=!1},toggleChat:m=>{m.isVisible?(m.isVisible=!1,m.openedNow=!1):(m.isVisible=!0,m.openedNow=!0,m.newMessage=!1)}},extraReducers:m=>{m.addCase("game/roomWarpBegan",m=>{m.openedNow=!1}),m.addCase("game/ROOM_LOADED",(m,R)=>{m.messages=[{createdAt:0,creator_id:"sys",message:L.Z.t("chat.welcome","Welcome To Pixels."),creatorName:""}],m.openedNow=!1,R.payload.messages&&R.payload.messages.filter(m=>!isSpecialCommand(m)||(processCommand(m),!1)).forEach(R=>m.messages.push(R)),m.chatEnabled="private"!==R.payload.roomType&&"tutorial"!==R.payload.roomType}),m.addCase("game/PLAYER_REMOVED",(m,R)=>{if(m.messages.slice(-20).some(m=>m.creator_id===R.payload.id)){let C={creator_id:"sys",createdAt:new Date().getTime(),message:L.Z.t("chat.leavemsg","{PLAYER} left").replace("{PLAYER}",R.payload.username),creatorName:""};m.messages=filterMessages(m.messages),m.messages.push(C)}}),m.addCase("game/CHAT_MESSAGE_RCV",(m,R)=>{let C=R.payload;(!isSpecialCommand(C)||(C=processCommand(C)))&&(!m.isVisible&&C.creatorName&&(m.newMessage=!0),m.messages=filterMessages(m.messages),m.messages.push(C))})}}),chatSelector=m=>m.chat,{toggleChat:B,closeChat:V}=$.actions;R.ZP=$.reducer},97761:function(m,R,C){"use strict";C.d(R,{D2:function(){return openStoreSelector},IT:function(){return V},NN:function(){return B},WU:function(){return U},fD:function(){return $}});var T=C(7406);let L=(0,T.oM)({name:"generalStoreModal",initialState:{isOpen:!1,isLoading:!1},reducers:{openStoreModal:(m,R)=>{m.storeId=R.payload,m.isOpen=!0},closeStoreModal:m=>{m.isOpen=!1},buyStoreItem:(m,R)=>{m.isLoading=!0},sellStoreItem:(m,R)=>{m.isLoading=!0}},extraReducers:m=>{m.addCase("game/ROOM_LEAVE",m=>{m.isOpen=!1})}}),openStoreSelector=m=>m.generalStore,{openStoreModal:U,closeStoreModal:$,buyStoreItem:B,sellStoreItem:V}=L.actions;R.ZP=L.reducer},95767:function(m,R,C){"use strict";C.d(R,{AK:function(){return mailboxSelector},I_:function(){return B},Yy:function(){return mailCountSelector},e4:function(){return $}});var T=C(7406),L=C(70247);function getActiveMail(m){return m.filter(m=>{let R=m.itemId?L.Z.getGameItem(m.itemId):void 0,C=m.currencyId?L.Z.getGameCurrency(m.currencyId):void 0;return!("item"===m.kind&&m.itemId&&!R||"coins"===m.kind&&m.currencyId&&!C)})}let U=(0,T.oM)({name:"mailbox",initialState:{isVisible:!1,isLoading:!0,mail:[],mailCount:0},reducers:{openMailbox:m=>{m.isVisible=!0},closeMailbox:m=>{m.isVisible=!1}},extraReducers:m=>{m.addCase("game/ROOM_LOADED",(m,R)=>{var C,T;(null===(C=R.payload.player)||void 0===C?void 0:C.full)&&(m.mailCount=null!==(T=R.payload.player.full.messages)&&void 0!==T?T:0)}),m.addCase("game/MAIL_UPDATE",(m,R)=>{void 0!==R.payload.messages&&(m.mailCount=R.payload.messages)}),m.addCase("game/RECEIVE_MAIL",(m,R)=>{m.isLoading=!1;let C=getActiveMail(R.payload.mail);m.mail=C}),m.addCase("game/COLLECT_MAIL_ITEM_RESPONSE",(m,R)=>{if(R.payload.success){let C=R.payload.mailId,T=getActiveMail(m.mail.filter(m=>m._id!=C));m.mail=T}})}}),{openMailbox:$,closeMailbox:B}=U.actions,mailboxSelector=m=>m.mailbox,mailCountSelector=m=>m.mailbox.mailCount;R.ZP=U.reducer},76873:function(m,R,C){"use strict";C.d(R,{CL:function(){return X},Cn:function(){return Q},DL:function(){return isEditorCategory},Ei:function(){return isOwnerSelector},Er:function(){return selectedBuilderElementSelector},LB:function(){return canOpenMapStorage},Mp:function(){return roomSettingsSelector},Mt:function(){return canEditMapSettings},Mz:function(){return J},PM:function(){return W},PR:function(){return Z},St:function(){return isModeSelector},T:function(){return canAccessStorage},TI:function(){return selectedObjectSelector},Vb:function(){return hasPermissionToBuild},Y7:function(){return editorCategory},_0:function(){return canEditMapMembers},a0:function(){return editorUpdated},aT:function(){return et},c6:function(){return Y},j6:function(){return K},pT:function(){return isMapEditorActiveSelector},pW:function(){return selectedEntitySelector},r5:function(){return er},sW:function(){return canEditMapSelector},v4:function(){return ee},xp:function(){return selectedTileSelector},zl:function(){return roomRestrictionsSelector}});var T=C(7406),L=C(36968),U=C.n(L),$=C(41609),B=C.n($),V=C(70247),H=C(34377);let G={isActive:!1,category:"objects",mode:"off",roomSettings:{name:"",ownerAddress:void 0,members:[],restrictions:{bannedAddresses:[]},ownership:{forSale:!1,forRent:!1}},updateVersion:1},q=(0,T.oM)({name:"mapEditor",initialState:{...G},reducers:{setMode:(m,R)=>{m.mode=R.payload,m.selectedItem=void 0},setCategory:(m,R)=>{m.category=R.payload,m.selectedItem=void 0},paintObject:(m,R)=>{R.payload?m.selectedItem={type:"object",object:{def:{...R.payload}}}:m.selectedItem=void 0,H.rV.attachToCursor.emit(R.payload?{type:"object",config:{object:R.payload}}:void 0)},paintEntity:(m,R)=>{R.payload?m.selectedItem={type:"entity",entity:{def:{...R.payload}}}:m.selectedItem=void 0,H.rV.attachToCursor.emit(R.payload?{type:"entity",config:{entity:R.payload}}:void 0)},selectObject:(m,R)=>{if(null==R?void 0:R.payload){let C=R.payload.object;m.category=(null==C?void 0:C.wall)?"walls":"objects",m.selectedItem={type:"object",object:{def:{...C},config:{...R.payload.config},configDirty:R.payload.configDirty}}}else m.selectedItem=void 0},patchObjectConfig:(m,R)=>{var C,T;(null===(C=m.selectedItem)||void 0===C?void 0:C.type)==="object"?(m.selectedItem.object.config={...m.selectedItem.object.config,...R.payload},m.selectedItem.object.configDirty=!0):(null===(T=m.selectedItem)||void 0===T?void 0:T.type)==="entity"&&(m.selectedItem.entity.config={...m.selectedItem.entity.config,...R.payload})},updateObject:(m,R)=>{var C;(null===(C=m.selectedItem)||void 0===C?void 0:C.type)==="object"&&R.payload&&(m.selectedItem.object.configDirty=!1)},selectEntity:(m,R)=>{if(!R.payload){m.selectedItem=void 0;return}m.selectedItem={type:"entity",entity:{def:{...R.payload.entity},config:R.payload.config}}},selectTile:(m,R)=>{if(!R.payload){m.selectedItem=void 0;return}m.mode="paint",m.selectedItem={type:"tile",tile:{...R.payload}},H.rV.attachToCursor.emit(R.payload?{type:"tile",config:{tile:R.payload}}:void 0)},updateRoomSettings:(m,R)=>{let C={...m.roomSettings};U()(C,R.payload.path,R.payload.value),m.roomSettings=C}},extraReducers:m=>{H.rV.editor.on.addReduxCase(m,m=>{m.isActive=!0,m.category="objects"}),H.rV.editor.off.addReduxCase(m,m=>{m.isActive=!1,m.mode="off",m.selectedItem=void 0}),m.addCase("game/SERVER_BUILD_NODE",(m,R)=>{var C,T,L,U,$,B;let H=R.payload;if("object"===H.type&&(null===(C=m.selectedItem)||void 0===C?void 0:C.type)==="object"&&(null===(L=m.selectedItem.object)||void 0===L?void 0:null===(T=L.config)||void 0===T?void 0:T._id)===H._id){if("update"===H.action){let R=V.Z.getMapObject(H._id);R&&(m.selectedItem.object.config.x=R.x,m.selectedItem.object.config.y=R.y,m.selectedItem.object.config.flip=R.flip)}else"remove"===H.action&&(m.selectedItem=void 0)}else"entity"===H.type&&(null===(U=m.selectedItem)||void 0===U?void 0:U.type)==="entity"&&(null===(B=m.selectedItem.entity)||void 0===B?void 0:null===($=B.config)||void 0===$?void 0:$.mid)===H._id&&"remove"===H.action&&(m.selectedItem=void 0);m.updateVersion+=1}),m.addCase("game/ENTITY_UPDATE",(m,R)=>{var C,T,L;if((null===(C=m.selectedItem)||void 0===C?void 0:C.type)==="entity"){let C=R.payload;C.mid===(null===(L=m.selectedItem.entity)||void 0===L?void 0:null===(T=L.config)||void 0===T?void 0:T.mid)&&(m.selectedItem.entity.config=C)}}),m.addCase("game/ROOM_NAME_CHANGED",(m,R)=>{m.roomSettings.name=R.payload,m.updateVersion+=1}),m.addCase("game/ROOM_OWNER_CHANGED",(m,R)=>{var C;m.roomSettings.ownerAddress=null===(C=R.payload)||void 0===C?void 0:C.toLowerCase()}),m.addCase("game/ROOM_PERMISSIONS_CHANGED",(m,R)=>{m.roomSettings.permissions=R.payload}),m.addCase("game/ROOM_GUILD_CHANGED",(m,R)=>{m.roomSettings.guild=R.payload}),m.addCase("game/ROOM_RESTRICTIONS_CHANGED",(m,R)=>{m.roomSettings.restrictions=R.payload}),m.addCase("game/ROOM_OWNERSHIP_CHANGED",(m,R)=>{m.roomSettings.ownership=R.payload}),m.addCase("game/ROOM_MEMBERS_CHANGED",(m,R)=>{m.roomSettings.members=R.payload}),m.addCase("game/ROOM_LEAVE",m=>{m.roomSettings={...G.roomSettings},m.isActive=!1,m.mode="off",m.selectedItem=void 0,m.updateVersion+=1})}}),{setMode:W,setCategory:Z,paintObject:Y,selectObject:K,paintEntity:J,selectEntity:X,patchObjectConfig:Q,updateObject:ee,selectTile:et,updateRoomSettings:er}=q.actions;R.ZP=q.reducer;let isMapEditorActiveSelector=m=>m.mapEditor.isActive,isModeSelector=m=>R=>R===m.mapEditor.mode,editorCategory=m=>m.mapEditor.category,isEditorCategory=m=>R=>R===m.mapEditor.category,selectedBuilderElementSelector=m=>{let{selectedItem:R}=m.mapEditor;return{selectedItem:R}},editorUpdated=m=>m.mapEditor.updateVersion,canEditMapSelector=m=>{var R;return!!(null===(R=m.game.player)||void 0===R?void 0:R.full.godmode)};function checkRole(m,R){return!!m&&!!R&&0!==R.length&&m.some(m=>R.includes(m.toUpperCase()))}let canEditMapSettings=m=>{var R;let C=getPlayerRoles(m);return checkRole(null===(R=m.mapEditor.roomSettings.permissions)||void 0===R?void 0:R.editFarmConfig,C)},canEditMapMembers=m=>{var R;let C=getPlayerRoles(m);return checkRole(null===(R=m.mapEditor.roomSettings.permissions)||void 0===R?void 0:R.editMapMembers,C)},hasPermissionToBuild=m=>{var R;let C=getPlayerRoles(m);return checkRole(null===(R=m.mapEditor.roomSettings.permissions)||void 0===R?void 0:R.build,C)},canOpenMapStorage=m=>{var R;let C=getPlayerRoles(m);return!!C&&0!==C.length&&(!!C.includes("OWNER")||checkRole(null===(R=m.mapEditor.roomSettings.permissions)||void 0===R?void 0:R.surplusAccess,C))},canAccessStorage=m=>{var R;let C=getPlayerRoles(m);return!!C&&0!==C.length&&(!!C.includes("OWNER")||checkRole(null===(R=m.mapEditor.roomSettings.permissions)||void 0===R?void 0:R.storageAccess,C))},isOwnerSelector=m=>{var R,C,T;if(!B()(m.mapEditor.roomSettings.ownerAddress)){let R=!!(null===(T=m.game.player)||void 0===T?void 0:T.full.cryptoWallets.find(R=>{var C;return R.address.toLowerCase()===(null===(C=m.mapEditor.roomSettings.ownerAddress)||void 0===C?void 0:C.toLowerCase())}));if(R)return R}return!!((null===(R=m.game.room)||void 0===R?void 0:R.mapId)&&(null===(C=m.game.player)||void 0===C?void 0:C.full.farms)&&m.game.player.full.farms.includes(m.game.room.mapId))},getPlayerRoles=m=>{var R,C,T;if(null===(R=m.game.player)||void 0===R?void 0:R.full.godmode)return["GOD","OWNER","MANAGER","ANY"];if(isOwnerSelector(m))return["OWNER","MANAGER","ANY"];if(m.mapEditor.roomSettings.members&&m.mapEditor.roomSettings.members.length>0){let R=null===(T=m.game.player)||void 0===T?void 0:null===(C=T.core.mid)||void 0===C?void 0:C.toLowerCase(),L=m.mapEditor.roomSettings.members.find(C=>{var T,L;return(null===(T=m.game.player)||void 0===T?void 0:T.core.mid)&&(null===(L=C.member)||void 0===L?void 0:L.toLowerCase())===R});if(null==L?void 0:L.roles)return[...L.roles.map(m=>m.toUpperCase()),"ANY"]}return["ANY"]},selectedObjectSelector=m=>{var R,C;return(null===(R=m.mapEditor.selectedItem)||void 0===R?void 0:R.type)==="object"?null===(C=m.mapEditor.selectedItem)||void 0===C?void 0:C.object:void 0},selectedTileSelector=m=>{var R,C;return(null===(R=m.mapEditor.selectedItem)||void 0===R?void 0:R.type)==="tile"?null===(C=m.mapEditor.selectedItem)||void 0===C?void 0:C.tile:void 0},selectedEntitySelector=m=>{var R,C;return(null===(R=m.mapEditor.selectedItem)||void 0===R?void 0:R.type)==="entity"?null===(C=m.mapEditor.selectedItem)||void 0===C?void 0:C.entity:void 0},roomSettingsSelector=m=>m.mapEditor.roomSettings,roomRestrictionsSelector=m=>m.mapEditor.roomSettings.restrictions},71156:function(m,R,C){"use strict";C.d(R,{SY:function(){return marketplaceIniitalCategorySelector},Uj:function(){return H},eo:function(){return V},ft:function(){return B},j4:function(){return $},oG:function(){return isMarketplaceListingsOpenSelector},ww:function(){return isMarketplaceOpenSelector},yW:function(){return marketplacePurchaseSelector}});var T=C(7406),L=C(34377);let U=(0,T.oM)({name:"marketplace",initialState:{mode:"none"},reducers:{openMarketplace:(m,R)=>{m.mode="marketplace",m.initialCategory=R.payload.initialCategory},openListings:m=>{m.mode="listings"},close:m=>{m.mode="none"},handlePurchaseSuccess:m=>{delete m.purchase}},extraReducers:m=>{m.addCase("game/".concat(L.fb.MARKETPLACE_SEND),(m,R)=>{let{payload:C}=R;"purchase"===C.subcommand&&(m.purchase="pending")}),m.addCase("game/".concat(L.fb.MARKETPLACE_RECEIVE),(m,R)=>{let{payload:C}=R;switch(C.type){case"purchase-success":{let{...R}=C;m.purchase=R;break}case"purchase-failure":delete m.purchase;break;default:throw Error("Unexpected value ".concat(C))}})}}),isMarketplaceOpenSelector=m=>"marketplace"===m.marketplace.mode,marketplaceIniitalCategorySelector=m=>m.marketplace.initialCategory,isMarketplaceListingsOpenSelector=m=>"listings"===m.marketplace.mode,marketplacePurchaseSelector=m=>m.marketplace.purchase,{openMarketplace:$,openListings:B,close:V,handlePurchaseSuccess:H}=U.actions;R.ZP=U.reducer},77497:function(m,R,C){"use strict";C.d(R,{HS:function(){return Z},W_:function(){return q},wm:function(){return W}});var T=C(34377),L=C(16562),U=C(46787),$=C(15103),B=C(80535),V=C(86731);let H=(0,$.cn)([]),G=1,q=(0,$.cn)(null,(m,R,C)=>{let T=m(H).slice();C.forEach(m=>{var R,C,L;if(m.deduplicationKey){let R=T.findIndex(R=>{let{deduplicationKey:C}=R;return m.deduplicationKey===C}),L=T[R];if(L){T.splice(R,1,{...L,duplicates:(null!==(C=L.duplicates)&&void 0!==C?C:1)+1});return}}if(m.stacking&&(null===(R=m.text)||void 0===R?void 0:R[m.stacking.textPropertyName])!==void 0){let{key:R,textPropertyName:C}=m.stacking,U=null===(L=m.text)||void 0===L?void 0:L[C];if(void 0!==U){let m=T.findIndex(m=>{let{stacking:C}=m;return(null==C?void 0:C.key)===R}),L=T[m];if(null==L?void 0:L.text){let R={...L,text:{...L.text}};void 0===R.text[C]?R.text[C]=U:R.text[C]+=U,T.splice(m,1,R);return}}}T.push({...m,reactKey:++G})}),R(H,T)}),W=(0,$.cn)(m=>m(H).find(R=>"trade"!==R.source||m(U.eH))),Z=(0,$.cn)(null,(m,R,C)=>{let T=m(H),L=C?T.findIndex(m=>m.reactKey===C.reactKey):-1;R(H,T.slice(Math.max(L+1,1)))});(0,V.H)("game/".concat(T.fb.ROOM_LEAVE),()=>{B.e.set(H,[])}),(0,V.H)("game/".concat(T.fb.TRADE_RECEIVE),m=>{if("request"===m.subcommand){let R=L.l.getInstance(),C=R.getSessionId(),T=Object.keys(m.trade.players).find(m=>m!==C),U=T?L.l.getInstance().getPlayerCoreBySessionId(T):void 0;B.e.set(q,[{source:"trade",text:{id:"notifications.trade.request",name:null==U?void 0:U.username},deduplicationKey:"notifications.trade.request"}])}})},69959:function(m,R,C){"use strict";C.d(R,{Vu:function(){return U},_V:function(){return $},pM:function(){return plotOpenSelector}});var T=C(7406);let L=(0,T.oM)({name:"plotSlice",initialState:{isVisible:!1},reducers:{openPlot:m=>{m.isVisible=!0},closePlot:m=>{m.isVisible=!1}},extraReducers:m=>{m.addCase("game/ROOM_LEAVE",m=>{m.isVisible=!1})}}),plotOpenSelector=m=>m.plot.isVisible,{openPlot:U,closePlot:$}=L.actions;R.ZP=L.reducer},87434:function(m,R,C){"use strict";C.d(R,{Hg:function(){return $},fp:function(){return reportTargetMidSelector},ht:function(){return U},op:function(){return reportWindowOpenSelector}});var T=C(7406);let L=(0,T.oM)({name:"reportSlice",initialState:{open:!1,mid:""},reducers:{openReportPlayerWindow:(m,R)=>{let{payload:C}=R;m.open=!0,m.mid=C.mid},closeReportPlayerWindow:m=>{m.open=!1,m.mid=""}}}),reportWindowOpenSelector=m=>m.report.open,reportTargetMidSelector=m=>m.report.mid,{openReportPlayerWindow:U,closeReportPlayerWindow:$}=L.actions;R.ZP=L.reducer},6354:function(m,R,C){"use strict";C.d(R,{v:function(){return $}});var T=C(15103),L=C(34377),U=C(80535);let $=(0,T.cn)({},(m,R,C)=>{if("clear"===C){R($,{});return}R($,{...m($),...C})});L.rV.sellOrders.fill.subscribe(m=>{var R;let{storeId:C,sellOrderIndex:T}=m,{nextReset:L,orders:B}=null!==(R=U.e.get($)[C])&&void 0!==R?R:{nextReset:0,orders:[]},V=B.slice();V[T]={...V[T],completedAt:-1},U.e.set($,{[C]:{nextReset:L,orders:V}})});let B=[];L.rV.sellOrders.fetch.subscribe(m=>{let{storeId:R}=m;U.e.set($,{[R]:{nextReset:0,orders:B,...U.e.get($)[R],fetching:!0}})})},46787:function(m,R,C){"use strict";C.d(R,{$6:function(){return tradeValueSelector},KU:function(){return tradeIdSelector},V:function(){return H},eH:function(){return B},gJ:function(){return q},sG:function(){return tradeSelector},sU:function(){return G}});var T=C(7406),L=C(34377),U=C(80535),$=C(15103);let B=(0,$.cn)(!1),V=(0,T.oM)({name:"tradeSlice",initialState:{trade:null,tradeId:"",tradeValue:null,otherTradeValue:null},reducers:{acceptTrade:m=>{U.e.set(B,!1)},adjustTrade:(m,R)=>{},dropTradeItem:(m,R)=>{}},extraReducers:m=>{m.addCase("game/".concat(L.fb.TRADE_RECEIVE),(m,R)=>{let{payload:C}=R;switch(C.subcommand){case"request":case"update":var T,L;m.tradeId&&m.tradeId!==C.tradeId&&console.warn("Server sending new trade while another trade is ongoing",C.tradeId),"request"===C.subcommand&&U.e.set(B,!0),m.tradeValue=null!==(T=C.tradeValue)&&void 0!==T?T:0,m.otherTradeValue=null!==(L=C.otherTradeValue)&&void 0!==L?L:0,m.trade=C.trade,m.tradeId=C.tradeId;break;case"close":m.tradeId===C.tradeId&&(m.trade=null,m.tradeId="",U.e.set(B,!1));break;default:throw Error("Unexpected value ".concat(C))}})}}),tradeSelector=m=>m.trade.trade,tradeValueSelector=m=>({tradeValue:m.trade.tradeValue,otherTradeValue:m.trade.otherTradeValue}),tradeIdSelector=m=>m.trade.tradeId,{acceptTrade:H,adjustTrade:G,dropTradeItem:q}=V.actions;R.ZP=V.reducer},69140:function(m,R,C){"use strict";C.d(R,{Bd:function(){return q},Dw:function(){return $},Ep:function(){return confirmDialogSelector},JR:function(){return entityInputSelector},OH:function(){return popupSelector},VG:function(){return Z},aA:function(){return B},aP:function(){return W},e4:function(){return V},ex:function(){return Y},gs:function(){return hiddenHUD},j2:function(){return portalSelector},rg:function(){return screenSize},tD:function(){return U},vV:function(){return H},wR:function(){return G}});var T=C(7406);let L=(0,T.oM)({name:"ui",initialState:{portalDialog:{isVisible:!1,mid_portal:"",tenant:"pixels"},entityInput:{isVisible:!1},imageDialog:{isVisible:!1,isIframe:!1},confirmDialog:{isVisible:!1},hideHUD:!1},reducers:{gameDimension:(m,R)=>{m.dimension=R.payload},portalConfig:(m,R)=>{m.portalDialog={isVisible:!0,mid_portal:R.payload.source,tenant:R.payload.tenant,mode:R.payload.mode||"infiniportal"}},showHUD:(m,R)=>{m.hideHUD=!R.payload},portalClose:m=>{m.portalDialog={isVisible:!1,mid_portal:"",tenant:"pixels"}},entityInput:(m,R)=>{m.entityInput={isVisible:!0,mid_portal:R.payload.source,prompt:R.payload.prompt,config:R.payload.config}},entityInputClose:m=>{m.entityInput={isVisible:!1}},confirmDialog:(m,R)=>{m.confirmDialog={isVisible:!0,...R.payload}},confirmDialogClose:m=>{m.confirmDialog={isVisible:!1}},imagePopup:(m,R)=>{m.imageDialog={isVisible:!0,url:R.payload.url,isIframe:R.payload.isIframe||!1,modeless:!0===R.payload.modeless,vertical:!0===R.payload.vertical}},imagePopupClose:m=>{m.imageDialog={isVisible:!1,isIframe:!1}}},extraReducers:m=>{m.addCase("game/ROOM_LOADED",m=>{m.portalDialog={isVisible:!1,mid_portal:"",tenant:"pixels"},m.entityInput.isVisible=!1,m.imageDialog.isVisible=!1,m.imageDialog.isIframe=!1,m.hideHUD=!1})}}),{gameDimension:U,showHUD:$,portalConfig:B,portalClose:V,imagePopup:H,imagePopupClose:G,entityInput:q,entityInputClose:W,confirmDialog:Z,confirmDialogClose:Y}=L.actions,portalSelector=m=>m.ui.portalDialog,popupSelector=m=>m.ui.imageDialog,entityInputSelector=m=>m.ui.entityInput,confirmDialogSelector=m=>m.ui.confirmDialog,hiddenHUD=m=>m.ui.hideHUD,screenSize=m=>m.ui.dimension;R.ZP=L.reducer},80535:function(m,R,C){"use strict";let T,L,U;C.d(R,{e:function(){return eT},h:function(){return eC}});var $=C(7406),B=C(86731),V=C(34377),H=C(69140),G=C(97761),q=C(76873);let W={[H.tD.type]:{event:V.Vh.RESIZE},[G.NN.type]:{event:V.Yi.BUY_STORE_ITEM},[G.IT.type]:{event:V.Yi.SELL_STORE_ITEM},[q.PM.type]:{event:V.qM.SET_MODE},[q.PR.type]:{event:V.qM.SET_CATEGORY},[q.v4.type]:{event:V.qM.BUILD_OBJECT}};Object.entries(W).forEach(m=>{let[R,C]=m;(0,B.H)(R,m=>{V.ZP.sendEvent(C.event,C.adapter?C.adapter(m):m)})});var Z=C(34256),Y=C(92217),K=C(89733),J=C(16562);(0,B.H)(Z.uy.type,(m,R)=>{(async()=>{await V.ZP.init(),await K.Z.initGame(),await K.Z.initRoom({...m,transition:m.snap?"snap":"intro"})})()}),(0,B.H)(Z.Hi.type,(m,R)=>{(async()=>{try{let C=await K.Z.loadLibraries(m.mapId);R.dispatch({type:"game/LIBRARY",payload:!!C})}catch(m){R.dispatch({type:"game/SVR_CANNOTCONNECT",payload:{message:["mapLoadFailed","Error Loading Map"]}})}})()}),(0,B.H)(Y.iM.type,(m,R)=>{m.mapId&&R.dispatch((0,Z.Hi)({mapId:m.mapId,lastSavedAt:m.lastSavedAt}))}),(0,B.H)(Y.z1.type,(m,R)=>{m.mapId&&R.dispatch((0,Z.Hi)({mapId:m.mapId,lastSavedAt:m.lastSavedAt}))}),(0,B.H)(Z.ni.type,()=>{(async()=>{await K.Z.killScene();let m=J.l.getInstance();await m.disconnect()})()});var X=C(83171),Q=C(83928),ee=C(79750),et=C(70247),er=C(39135);let navigateRoad=m=>"left"===m?J.l.getInstance().peekLeftMap():"right"===m?J.l.getInstance().peekRightMap():m,getTransition=(m,R,C)=>{let T=null==m?void 0:m.match(/\d+$/),L=null==R?void 0:R.match(/\d+$/);if(!T&&!L)return"quick";let U="quick";if(C){let m=C.split(",");"right"===m[0]?U="roadleft":"left"===m[0]&&(U="roadright")}return T&&L&&T[0]===L[0]?"quick":U},updateMapName=(m,R)=>{let C=null==m?void 0:m.match(/\d+$/);return(null==R?void 0:R.indexOf("*"))!==-1?R=R.replace("*",C?C[0]:""):["left","right"].includes(R)&&(R=navigateRoad(R)),(0,Q.En)(R)},loadTenant=async m=>{(0,ee.q4)(m)&&(await (0,er.W)(!0),et.Z.clearGameLibrary(),await et.Z.loadLibraries())},checkMapTenant=async(m,R)=>{var C,T,L;let U=(0,ee.GU)(),$=null!==(T=null==m?void 0:null===(C=m.tenants)||void 0===C?void 0:C[0])&&void 0!==T?T:"pixels";if($!==U.name&&(await loadTenant($),(U=(0,ee.GU)()).tutorialQuest&&U.tutorialMap)){let m=null===(L=R.full.quests)||void 0===L?void 0:L[U.tutorialQuest];if(!(null==m?void 0:m.isComplete))return U.tutorialMap}return m.id},backupWarp=(m,R)=>{clearTimeout(T),m.dispatch((0,Z.tD)({abort:!0})),K.Z.unfreezeRoom(R)};(0,B.H)("game/ROOM_WARP",(m,R)=>{let C=R.getState(),U=(0,X.Xt)(C),$=(0,X.Od)(C),B=(0,X.K7)(C),H=updateMapName($,m.mapId),G=getTransition($,H,m.spawn),q=(0,X.lA)(C);if(q){if(!B&&!m.abort&&m.mapId&&U){R.dispatch((0,Z.tD)({})),V.rV.editor.off.emit(),console.log("warp to ".concat(H)),K.Z.freezeRoom(G),L=m.source;let C=et.Z.loadMap(H);T=setTimeout(async()=>{let $;T=void 0,L=void 0;try{$=await C}catch(m){backupWarp(R,G);return}if(!$){backupWarp(R,G);return}K.Z.pauseRoom(),R.dispatch((0,Z.Fd)({...m,mapId:H}));try{let R=J.l.getInstance(),C=await R.disconnect();if(-1!==C){let R=await checkMapTenant($,q);await K.Z.initRoom({mapId:R,spawn:m.spawn,worldId:U,transition:G})}else await K.Z.initRoom({mapId:(0,ee.lf)(),worldId:U,transition:"quick"})}catch(m){console.log("this is what happened, dude",m),R.dispatch({type:"game/SVR_CANNOTCONNECT",payload:{message:["mapNotFound","The there there is not there. Try again. Message ID: mapNotFound"]}})}},"quick"!==G?1500:1e3)}else B&&m.abort&&("quick"===G||"portal"===G)&&T&&L&&m.source===L&&backupWarp(R,G)}});var en=C(19445),eo=C(60604),ei=C(82485),ea=C(71343),es=C(61036);let el=0;(0,B.H)("game/GAME_OBJECT_CLICKED",(m,R)=>{var C,T,L,U,$,B;let H=Date.now();if(H-el<150)return;el=H;let G=R.getState(),W=(0,q.pT)(G),Y=(0,en.NS)(G);if(W||(null==Y?void 0:Y.isOpen))return;let{selfPlayer:K,world:X}=m;if(!K)return;let ee=(0,Q.pp)(m),er=J.l.getInstance(),eu=null===(C=er.currentPlayer)||void 0===C?void 0:C.full.pet,ec=eo.ZD;eu&&eu.happiness>50&&(null!==(L=null===(T=eu.traits)||void 0===T?void 0:T.Speed)&&void 0!==L?L:0)>1&&(ec+=32+(eu.traits.Speed-1));let ed=ee>ec*ec;if(ed){R.dispatch((0,Z.io)({mouse:m.mouse,text:"hover.toofar"}));return}m.animation&&(null===(U=er.scene)||void 0===U||U.playOneTimeAnimation(m.animation));let ef=(0,en.xM)(G),ep=(0,en.B6)(G);if(ep&&!(null==Y?void 0:Y.isOpen)){let R=null===($=ep.onUse)||void 0===$?void 0:$.types.includes("move");if(R&&(0,ei.ZP)(ep,m.key,m.type||m.entityType,m.cropState)){let R=m.useType||"unknown",C="object"===R?et.Z.getGameObject(m.key):et.Z.getGameEntity(m.key);V.rV.attachToCursor.emit({type:R,mid:m.targetId,moving:!0,config:{[R]:C}})}else"npc"!==m.entityType||(0,ei.ZP)(ep,m.npcId,"npc")?V.ZP.sendEvent(V.qM.PLAYER_USED_ITEM,{item:{id:ep.id,inventorySlot:ef.slot},target:{id:m.targetId,mid:m.targetId,type:m.useType||"unknown"},client:{key:m.key,entityType:m.entityType,cropState:m.cropState}}):V.ZP.sendEvent(V.qM.PLAYER_CLICKED_NPC,{npcId:m.npcId,mid:m.targetId});return}if("npc"===m.entityType){V.ZP.sendEvent(V.qM.PLAYER_CLICKED_NPC,{npcId:m.npcId,mid:m.targetId});return}if("storage"===m.entityType){let C=m.targetId,T=er.getEntityByUniqueId(C);if(T){let m=et.Z.getGameEntity(T.entity);((null==m?void 0:null===(B=m.storage)||void 0===B?void 0:B.transient)||(0,q.T)(R.getState()))&&V.ZP.sendEvent(V.fb.PLAYER_OPEN_STORAGE,{storageId:C})}return}if("generic"===m.entityType&&m.clickable){V.ZP.sendEvent(ea.m.clickEntity,{mid:m.targetId,entity:m.entityId,impact:"click",inputs:[null==X?void 0:X.x,null==X?void 0:X.y]});return}if(m.action){let C=m.action;if(C.room){let m=C.room;V.ZP.sendEvent(V.fb.ROOM_WARP,{mapId:m,spawn:C.spawn})}C.link&&("https://play.pixels.online/terravilla101"===C.link.toLowerCase()?V.ZP.sendEvent(V.fb.ROOM_WARP,{mapId:"terravilla"}):/^[^./:]*$/.test(m.action.link)?V.ZP.sendEvent(V.fb.ROOM_WARP,{mapId:C.link.trim()}):V.ZP.sendEvent(V.fb.LINK_OPEN,{link:C.link.trim(),msgKey:C.confirm})),C.dialog&&R.dispatch({type:"game/PRESENT_UI",payload:{ui:C.dialog,params:[C.spawn],source:m.targetId}}),C.sound&&V.rV.playSound.emit(C.sound),C.sharelink&&(0,es.Bf)(C.sharelink,"Play Pixels.xyz")}else"self"===m.useType||("pet"===m.useType?R.dispatch((0,Z.zR)({})):"otherPlayer"===m.useType?R.dispatch((0,Z.ol)({mid:m.mid,username:m.username})):console.log("nothing to do",m))});var eu=C(27361),ec=C.n(eu);let ed=0;(0,B.H)("game/PLAYER_CLICKED",(m,R)=>{let C=Date.now();if(C-ed<150)return;ed=C;let T=R.getState(),L=(0,q.pT)(T),U=(0,en.NS)(T);if(!L&&!(null==U?void 0:U.isOpen)){let R=(0,en.B6)(T),C=(0,en.xM)(T);if(R){var $,B,H,G,W;let T=(null===($=R.onUse)||void 0===$?void 0:$.placeEntity)||(null===(B=R.onUse)||void 0===B?void 0:B.placeObject),L=ec()(m,"context.tempNode.isBuildAreaFree",!1);if(T&&!L)return;let U={type:"ground",x:ec()(m,"context.tempNode.position.x")||ec()(m,"world.x"),y:ec()(m,"context.tempNode.position.y")||ec()(m,"world.y")};if(null==R?void 0:null===(H=R.onUse)||void 0===H?void 0:H.types.includes("move")){if(U.type=ec()(m,"context.tempNode.type"),U.mid=ec()(m,"context.tempNode.mid"),!U.type||!U.mid||!L)return;V.rV.attachToCursor.emit({type:"item",config:{item:R}})}else if((null===(G=R.onUse)||void 0===G?void 0:G.types.includes("placeTile"))||(null===(W=R.onUse)||void 0===W?void 0:W.types.includes("removeTile"))){if(!L)return;U.tiles=ec()(m,"context.tiles")}V.ZP.sendEvent(V.qM.PLAYER_USED_ITEM,{item:{id:R.id,inventorySlot:C.slot},target:U,client:{key:"ground",entityType:"ground"}})}}});var ef=C(36968),ep=C.n(ef);(0,B.H)(q.r5.type,(m,R)=>{switch(m.path){case"restrictions.bannedAddresses":let C={restrictions:{...(0,q.zl)(R.getState())}};ep()(C,m.path,m.value),V.ZP.sendEvent(V.qM.ROOM_RESTRICTIONS,{...C.restrictions});break;case"permissions.use":V.ZP.sendEvent(V.qM.ROOM_PERMISSIONS,{permissions:{use:m.value}});break;case"guild":console.log("sending ROOM_PERMISSIONS",m),V.ZP.sendEvent(V.qM.ROOM_PERMISSIONS,{guild:m.value});break;case"name":V.ZP.sendEvent(V.qM.ROOM_NAME,m.value);break;case"ownership.forSale":V.ZP.sendEvent(V.qM.ROOM_OWNERSHIP,{forSale:m.value})}}),(0,B.H)("mapEditor/addMember",m=>{V.ZP.sendEvent(V.qM.ROOM_MEMBERS,m)}),(0,B.H)("game/PLAYER_COLLIDED_WITH_OBJECT",m=>{if(null==m?void 0:m.onCollide){let R=m.onCollide;R.teleport&&V.ZP.sendEvent(V.fb.ROOM_WARP,{mapId:R.teleport,spawn:R.spawn,source:m.key}),R.sound&&V.rV.playSound.emit(R.sound),R.trigger&&V.ZP.sendEvent(V.Yi.TRIGGER_EVENT,{trigger:m.onCollide.trigger,targetId:m.targetId}),R.link&&V.ZP.sendEvent(V.fb.LINK_OPEN,{link:R.link.trim(),msgKey:R.confirm})}}),(0,B.H)("game/PLAYER_UNCOLLIDED_WITH_OBJECT",m=>{if(null==m?void 0:m.onCollide){let R=m.onCollide;R.teleport&&V.ZP.sendEvent(V.fb.ROOM_WARP,{mapId:R.teleport,spawn:R.spawn,source:m.key,abort:!0})}});var eh=C(77341),eg=C(79274),em=C(69959),ey=C(71156),ev=C(95767);function registerWorker(){if(navigator.serviceWorker&&"PushManager"in window)return navigator.serviceWorker.register("/workers/push-worker.js?v=1").then(function(m){return U=m}).catch(()=>{U=void 0})}async function isSubscriptionPossible(){return await registerWorker(),U&&"denied"!==Notification.permission}async function isUserSubscribedToPush(){if(await registerWorker(),!U)return!1;let m=await U.pushManager.getSubscription();return!(!m||m.expirationTime&&Date.now()>m.expirationTime)}async function subscribeUserToPush(){if(await registerWorker(),!U)return;await new Promise(function(m,R){if("granted"===Notification.permission)m(Notification.permission);else{let C=Notification.requestPermission(function(R){m(R)});C&&C.then(m,R)}}).then(function(m){if("granted"!==m)throw Error("We weren't granted permission.")});let m={userVisibleOnly:!0,applicationServerKey:function(m){let R="=".repeat((4-m.length%4)%4),C=(m+R).replace(/-/g,"+").replace(/_/g,"/"),T=window.atob(C),L=new Uint8Array(T.length);for(let m=0;m{var C,T,L,U,$,B,W,Y,K,X,Q;let{ui:ee,source:er}=m,eo=m.params;if(eo||(eo=[m.param]),console.log("got presentui ".concat(ee)),ee.includes("marketplace-")&&"marketplace-listings"!==ee){R.dispatch((0,ey.j4)({initialCategory:ee.split("marketplace-")[1]}));return}switch(ee){case"farmDetails":R.dispatch({type:"game/PRESENT_FARM_DETAILS"});break;case"farmPicker":case"plotDialog":R.dispatch((0,em.Vu)());break;case"portalConfig":R.dispatch((0,en.aq)()),R.dispatch((0,H.aA)({source:er,tenant:"pixels",mode:null==eo?void 0:eo[0]}));break;case"entityInput":R.dispatch((0,en.aq)()),R.dispatch((0,H.Bd)({source:er,prompt:null==eo?void 0:eo[0],config:eo.slice(1)}));break;case"marketplace":R.dispatch((0,en.aq)()),R.dispatch((0,ey.j4)({}));break;case"marketplace-listings":R.dispatch((0,en.aq)()),R.dispatch((0,ey.ft)());break;case"portalConfigTenant":R.dispatch((0,en.aq)()),R.dispatch((0,H.aA)({source:er,mode:null==eo?void 0:eo[0]}));break;case"hideHUD":R.dispatch((0,H.Dw)(!1));break;case"showHUD":R.dispatch((0,H.Dw)(!0));break;case"link":"string"==typeof(null==eo?void 0:eo[0])&&V.ZP.sendEvent(V.fb.LINK_OPEN,{link:null==eo?void 0:eo[0],msgKey:null==eo?void 0:eo[1]});break;case"petStorage":{let m=null===(C=J.l.getInstance().selfPlayer)||void 0===C?void 0:C.pet;m&&V.ZP.sendEvent(V.fb.PLAYER_OPEN_STORAGE,{storageId:m.mid})}break;case"petPicker":R.dispatch((0,Z.lW)({mode:"hatched",entity:er}));break;case"petCapsule":R.dispatch((0,Z.lW)({mode:"capsule",entity:er}));break;case"petDetails":R.dispatch((0,Z.zR)({petId:null==eo?void 0:eo[0]}));break;case"mapStorage":(0,q.LB)(R.getState())&&V.ZP.sendEvent(V.fb.PLAYER_OPEN_STORAGE,{storageId:J.l.getInstance().mapStorageId});break;case"entityStorage":{let m=J.l.getInstance(),C=m.getEntityByUniqueId(er);if(C){let m=et.Z.getGameEntity(C.entity);((null==m?void 0:null===(T=m.storage)||void 0===T?void 0:T.transient)||(0,q.T)(R.getState()))&&V.ZP.sendEvent(V.fb.PLAYER_OPEN_STORAGE,{storageId:er})}}break;case"popupMap":let ei=null!==(U=null==eo?void 0:eo[0])&&void 0!==U?U:"obj_mapTerravilla",ea=et.Z.getGameObject(ei);(null==ea?void 0:null===(L=ea.sprite)||void 0===L?void 0:L.image)&&(ea.sprite.size&&ea.sprite.size.height>ea.sprite.size.width?R.dispatch((0,H.vV)({url:null==ea?void 0:null===($=ea.sprite)||void 0===$?void 0:$.image,vertical:!0})):R.dispatch((0,H.vV)({url:null==ea?void 0:null===(B=ea.sprite)||void 0===B?void 0:B.image})));break;case"popupFrame":R.dispatch((0,H.vV)({url:(null==eo?void 0:eo[0])||"https://www.pixels.xyz",isIframe:!0}));break;case"theatreFrame":(null==eo?void 0:eo[0])==="close"?R.dispatch((0,H.wR)()):R.dispatch((0,H.vV)({url:(null==eo?void 0:eo[0])||"https://www.pixels.xyz",isIframe:!0,modeless:!0}));break;case"closeCrafting":R.dispatch((0,eh.F0)());break;case"openMailbox":R.dispatch((0,en.aq)()),R.dispatch((0,ev.e4)());break;case"closeMailbox":R.dispatch((0,ev.I_)());break;case"webpush":if(eE)break;shouldAskAboutSubscription().then(m=>{m&&R.dispatch((0,H.VG)({prompt:null==eo?void 0:eo[0],yesno:!0,callback:m=>{"yes"===m?subscribeUserToPush().then(m=>{if(m){let R=JSON.parse(JSON.stringify(m));V.ZP.sendEvent(V.Yi.PUSH_SUBSCRIBE,{endpoint:R.endpoint,expiration:R.expirationTime,extra:{...R,endpoint:void 0,expirationTime:void 0}})}}).catch(m=>{console.log(m)}):"no"===m&&(eE=!0)}}))});break;default:if(ee.startsWith(eb)||eg.h3.includes(ee)){let m=ee.replace(eb,""),C=null!==(W=null==eo?void 0:eo[1])&&void 0!==W?W:"";(null==C?void 0:C.startsWith("update:"))||R.dispatch((0,en.aq)()),R.dispatch((0,eh.Uf)({source:null!=er?er:"",craftType:m,tableTier:null!==(Y=null==eo?void 0:eo[0])&&void 0!==Y?Y:1,state:C,achievement:null!==(K=null==eo?void 0:eo[2])&&void 0!==K?K:"",finish:null!==(X=null==eo?void 0:eo[3])&&void 0!==X?X:1,quantity:null!==(Q=null==eo?void 0:eo[4])&&void 0!==Q?Q:1}))}else et.Z.getStore(ee)?(R.dispatch((0,en.aq)()),R.dispatch((0,G.WU)(ee))):console.log("unknown dialog ".concat(ee))}}),(0,B.H)(en.oi.type,m=>{let{sourceIndex:R,targetIndex:C,sourceContainer:T,targetContainer:L}=m;(R!==C||T!==L)&&V.rV.inventory.swapItems.emit(m)});var e_=C(77497);(0,B.H)("game/".concat(V.fb.PLAYER_EXP_CHANGE),(m,R)=>{var C,T,L;let U=R.getState(),$=null===(C=U.game.player)||void 0===C?void 0:C.full;if(!$)return;let B=$.levels,V=m.levels,H=[],G=$.quests,q=eg.nA.every(m=>{var R,C;let T=(null===(R=B[m])||void 0===R?void 0:R.level)||0,L=(null===(C=V[m])||void 0===C?void 0:C.level)||0;return T===L});!q&&(null===(T=Object.values(et.Z.getGameItems()||{}).filter(m=>{var R,C;return null==m?void 0:null===(C=m.requirements)||void 0===C?void 0:null===(R=C.levels)||void 0===R?void 0:R.some(m=>{let{levelType:R,level:C}=m;return!!eg.nA.includes(R)&&C>=0})}))||void 0===T||T.filter(m=>{var R,C;return(null===(R=m.requirements.levels)||void 0===R?void 0:R.some(m=>{var R;return m.level>((null===(R=B[m.levelType])||void 0===R?void 0:R.level)||0)}))&&m.requirements.levels.every(m=>{var R;return((null===(R=V[m.levelType])||void 0===R?void 0:R.level)||0)>=m.level})&&(!(null===(C=m.requirements)||void 0===C?void 0:C.quests)||m.requirements.quests.every(m=>{var R;return null===(R=G[m])||void 0===R?void 0:R.isComplete}))}).forEach(m=>H.push({source:"item",icon:m.image,text:{id:"notifications.itemUnlocked",name:(0,es.sA)(m.id)},deduplicationKey:"notifications.itemUnlocked-".concat(m.id)})),null===(L=Object.values(et.Z.getGameAchievements()||{}).filter(m=>{var R;return(null===(R=m.craftable)||void 0===R?void 0:R.autoGrant)&&m.craftable.requiredLevel>0}))||void 0===L||L.filter(m=>{var R,C;if(!m.craftable)return!1;let T=m.craftable.requiredLevel||0,L=m.craftable.requiredSkill||eg.oi[m.craftable.type],U=(null===(R=B[L])||void 0===R?void 0:R.level)||0,$=(null===(C=V[L])||void 0===C?void 0:C.level)||0;return $>=T&&U{let R=m.craftable.requiredSkill||eg.oi[m.craftable.type];H.push({source:"achievement",icon:"".concat(eo.fd).concat(R,".png"),text:{id:"notifications.globalAchievementUnlocked",name:(0,es.sA)(m.id)},deduplicationKey:"notifications.globalAchievementUnlocked-".concat(m.id)})}),H.length&&eT.set(e_.W_,H))}),C(86193);let eS=["placeEntity","placeObject","move","removeEntity","removeObject"];(0,B.H)(en.$Z.type,(m,R)=>{let{mid:C,item:T}=m;if(!C&&T){let m=(0,q.Vb)(R.getState());!function(m,R){if(m){var C,T,L,U,$,B,H,G,q,W,Z,Y,K;let X;X=(null==m?void 0:null===(C=m.onUse)||void 0===C?void 0:C.placeObject)?{type:"object",config:{object:et.Z.getGameObject(null==m?void 0:null===(H=m.onUse)||void 0===H?void 0:H.placeObject)},placing:!0}:(null==m?void 0:null===(L=m.onUse)||void 0===L?void 0:null===(T=L.placeEntity)||void 0===T?void 0:T.entity)?{type:"entity",config:{entity:et.Z.getGameEntity(m.onUse.placeEntity.entity)},placing:!0}:(null===($=m.onUse)||void 0===$?void 0:null===(U=$.placeTile)||void 0===U?void 0:U.tileset)?{type:"tile",config:{tile:{tilesetId:null===(q=m.onUse)||void 0===q?void 0:null===(G=q.placeTile)||void 0===G?void 0:G.tileset}}}:(null===(B=m.onUse)||void 0===B?void 0:B.types.includes("removeTile"))?{type:"tile",config:{tile:{}}}:{type:"item",config:{item:m}},V.rV.attachToCursor.emit({...X,editingWithoutPermissions:(null==m?void 0:null===(Z=m.onUse)||void 0===Z?void 0:null===(W=Z.types)||void 0===W?void 0:W.some(m=>eS.includes(m)))&&!R||!function(m){var R;if(!(null==m?void 0:null===(R=m.useTargets)||void 0===R?void 0:R.types.includes("mapLabels"))||!m.useTargets.mapLabels)return!0;let C=J.l.getInstance().mapLabels;return m.useTargets.mapLabels.every(m=>C.includes(m))}(m),removing:null==m?void 0:null===(K=m.onUse)||void 0===K?void 0:null===(Y=K.types)||void 0===Y?void 0:Y.some(m=>["removeEntity","removeObject"].includes(m))})}}(T,m)}});var eO=C(95047);(0,B.H)("game/CLIENT_CMD",m=>{console.log("got client command",m);let{detail:R,source:C,params:T}=m;switch(R){case"petHatch":C&&eO.Z.hatchPet(C).then(m=>{var R,L;"success"===m?V.ZP.postEvent(ea.m.clickEntity,{mid:C,impact:"hatched",entity:null!==(R=null==T?void 0:T[0])&&void 0!==R?R:"ent_growthlab"}):V.ZP.postEvent(ea.m.clickEntity,{mid:C,impact:"failed",entity:null!==(L=null==T?void 0:T[0])&&void 0!==L?L:"ent_growthlab"})});break;case"roninInjectedFunction":try{var L,U,$,B,H,G,q,W,Z;let m=eC.getState(),R=null!==(Z=null==T?void 0:T[0])&&void 0!==Z?Z:"cbRoninCall",C=null===($=m.game.player)||void 0===$?void 0:null===(U=$.full)||void 0===U?void 0:null===(L=U.cryptoWallets)||void 0===L?void 0:L.map(m=>m.address);null===(W=window.ronin)||void 0===W||null===(q=W.provider)||void 0===q||null===(G=q[R])||void 0===G||G.call(q,{userId:null===(H=m.game.player)||void 0===H?void 0:null===(B=H.core)||void 0===B?void 0:B.mid,wallets:C})}catch(m){console.log(m)}}});var eA=C(18496),ew=C(22181),eI=C(54698),eP=C(87434),eR=C(46787),ek=C(15103);let eC=(0,$.xC)({reducer:{auth:Y.Co,game:Z.ZP,ui:H.ZP,mailbox:ev.ZP,generalStore:G.ZP,marketplace:ey.ZP,chat:eI.ZP,plot:em.ZP,report:eP.ZP,storage:en.ZP,trade:eR.ZP,mapEditor:q.ZP,crafting:eh.ZP},middleware:m=>m().concat(m=>R=>C=>{if(C.type===Y.Kx.type)(async()=>{try{var R,T,L,U;let $=null!==(L=(0,Q.Ul)("wallet-provider"))&&void 0!==L?L:"unknown",B=await eA.Z.initialize(null!==(U=(0,Q.En)(null===(R=C.payload)||void 0===R?void 0:R.mapId))&&void 0!==U?U:"",$),V=null==B?void 0:B.player,H=(0,ee.F5)(),G=null==V?void 0:null===(T=V.location)||void 0===T?void 0:T.mapId,q=null==B?void 0:B.targetTenant;if(q&&q!==H){window.open("/".concat(q,"/").concat(G),"_self");return}B&&eA.Z.sessionToken&&(m.dispatch((0,ew.R)({mapId:G})),m.dispatch((0,Y.iM)({sessionToken:eA.Z.sessionToken,provider:eA.Z.walletProvider,username:V.username,playerId:V._id.toString(),playerAvatar:V.playerAvatar,lastSavedAt:V.lastSavedAt,cryptoWallets:V.cryptoWallets,currentAvatar:V.currentAvatar,mapId:G})))}catch(R){console.warn(R),(null==R?void 0:R.error)&&m.dispatch((0,Y.gz)({message:R.message||R.error,allowReload:!0,allowClose:!1}))}m.dispatch((0,Y.RT)())})();else if(C.type===Y.YR.type);else if(C.type===Y.MD.type){let{username:R,avatarPieces:T}=C.payload;(async()=>{if(eA.Z.sessionToken){var C,L,U,$;try{let U=await eA.Z.createPlayer(R,T);(null==U?void 0:null===(C=U.player)||void 0===C?void 0:C.username)?m.dispatch((0,Y.z1)({username:U.player.username,playerId:U.player._id,cryptoWallets:U.player.cryptoWallets,playerAvatar:T,mapId:null===(L=U.player.location)||void 0===L?void 0:L.mapId})):(null==U?void 0:U.message)&&"username-already-exists"===U.message&&m.dispatch((0,Y.cm)({message:["nameInUse","Name in use"]}))}catch(R){(null==R?void 0:null===($=R.response)||void 0===$?void 0:null===(U=$.data)||void 0===U?void 0:U.message)==="username-already-exists"?m.dispatch((0,Y.cm)({message:["nameInUse","Name in use"]})):m.dispatch((0,Y.cm)({message:["internalServerError","Unknown Error Occurred Creating Player"]}))}}})()}else C.type===Z.ni.type&&(async()=>{eA.Z.sessionToken&&eA.Z.signOut().catch(m=>{console.log("error signing out",m)}),m.dispatch((0,Y.k4)())})();return R(C)}).concat(m=>R=>C=>{let T=B.q[C.type];return T&&T(C.payload,m),R(C)})}),eT=(0,ek.MT)()},21876:function(m){!function(){var R={675:function(m,R){"use strict";R.byteLength=function(m){var R=getLens(m),C=R[0],T=R[1];return(C+T)*3/4-T},R.toByteArray=function(m){var R,C,U=getLens(m),$=U[0],B=U[1],V=new L(($+B)*3/4-B),H=0,G=B>0?$-4:$;for(C=0;C>16&255,V[H++]=R>>8&255,V[H++]=255&R;return 2===B&&(R=T[m.charCodeAt(C)]<<2|T[m.charCodeAt(C+1)]>>4,V[H++]=255&R),1===B&&(R=T[m.charCodeAt(C)]<<10|T[m.charCodeAt(C+1)]<<4|T[m.charCodeAt(C+2)]>>2,V[H++]=R>>8&255,V[H++]=255&R),V},R.fromByteArray=function(m){for(var R,T=m.length,L=T%3,U=[],$=0,B=T-L;$>18&63]+C[L>>12&63]+C[L>>6&63]+C[63&L]);return U.join("")}(m,$,$+16383>B?B:$+16383));return 1===L?U.push(C[(R=m[T-1])>>2]+C[R<<4&63]+"=="):2===L&&U.push(C[(R=(m[T-2]<<8)+m[T-1])>>10]+C[R>>4&63]+C[R<<2&63]+"="),U.join("")};for(var C=[],T=[],L="undefined"!=typeof Uint8Array?Uint8Array:Array,U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$=0,B=U.length;$0)throw Error("Invalid string. Length must be a multiple of 4");var C=m.indexOf("=");-1===C&&(C=R);var T=C===R?0:4-C%4;return[C,T]}T["-".charCodeAt(0)]=62,T["_".charCodeAt(0)]=63},72:function(m,R,C){"use strict";/*! * The buffer module from node.js, for the browser. * * @author Feross Aboukhadijeh * @license MIT */var T=C(675),L=C(783),U="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function createBuffer(m){if(m>2147483647)throw RangeError('The value "'+m+'" is invalid for option "size"');var R=new Uint8Array(m);return Object.setPrototypeOf(R,Buffer.prototype),R}function Buffer(m,R,C){if("number"==typeof m){if("string"==typeof R)throw TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(m)}return from(m,R,C)}function from(m,R,C){if("string"==typeof m)return function(m,R){if(("string"!=typeof R||""===R)&&(R="utf8"),!Buffer.isEncoding(R))throw TypeError("Unknown encoding: "+R);var C=0|byteLength(m,R),T=createBuffer(C),L=T.write(m,R);return L!==C&&(T=T.slice(0,L)),T}(m,R);if(ArrayBuffer.isView(m))return fromArrayLike(m);if(null==m)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof m);if(isInstance(m,ArrayBuffer)||m&&isInstance(m.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(isInstance(m,SharedArrayBuffer)||m&&isInstance(m.buffer,SharedArrayBuffer)))return function(m,R,C){var T;if(R<0||m.byteLength=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|m}function byteLength(m,R){if(Buffer.isBuffer(m))return m.length;if(ArrayBuffer.isView(m)||isInstance(m,ArrayBuffer))return m.byteLength;if("string"!=typeof m)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof m);var C=m.length,T=arguments.length>2&&!0===arguments[2];if(!T&&0===C)return 0;for(var L=!1;;)switch(R){case"ascii":case"latin1":case"binary":return C;case"utf8":case"utf-8":return utf8ToBytes(m).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*C;case"hex":return C>>>1;case"base64":return base64ToBytes(m).length;default:if(L)return T?-1:utf8ToBytes(m).length;R=(""+R).toLowerCase(),L=!0}}function slowToString(m,R,C){var L,U,$=!1;if((void 0===R||R<0)&&(R=0),R>this.length||((void 0===C||C>this.length)&&(C=this.length),C<=0||(C>>>=0)<=(R>>>=0)))return"";for(m||(m="utf8");;)switch(m){case"hex":return function(m,R,C){var T=m.length;(!R||R<0)&&(R=0),(!C||C<0||C>T)&&(C=T);for(var L="",U=R;U2147483647?C=2147483647:C<-2147483648&&(C=-2147483648),(U=C=+C)!=U&&(C=L?0:m.length-1),C<0&&(C=m.length+C),C>=m.length){if(L)return -1;C=m.length-1}else if(C<0){if(!L)return -1;C=0}if("string"==typeof R&&(R=Buffer.from(R,T)),Buffer.isBuffer(R))return 0===R.length?-1:arrayIndexOf(m,R,C,T,L);if("number"==typeof R)return(R&=255,"function"==typeof Uint8Array.prototype.indexOf)?L?Uint8Array.prototype.indexOf.call(m,R,C):Uint8Array.prototype.lastIndexOf.call(m,R,C):arrayIndexOf(m,[R],C,T,L);throw TypeError("val must be string, number or Buffer")}function arrayIndexOf(m,R,C,T,L){var U,$=1,B=m.length,V=R.length;if(void 0!==T&&("ucs2"===(T=String(T).toLowerCase())||"ucs-2"===T||"utf16le"===T||"utf-16le"===T)){if(m.length<2||R.length<2)return -1;$=2,B/=2,V/=2,C/=2}function read(m,R){return 1===$?m[R]:m.readUInt16BE(R*$)}if(L){var H=-1;for(U=C;UB&&(C=B-V),U=C;U>=0;U--){for(var G=!0,q=0;q239?4:H>223?3:H>191?2:1;if(L+q<=C)switch(q){case 1:H<128&&(G=H);break;case 2:(192&(U=m[L+1]))==128&&(V=(31&H)<<6|63&U)>127&&(G=V);break;case 3:U=m[L+1],$=m[L+2],(192&U)==128&&(192&$)==128&&(V=(15&H)<<12|(63&U)<<6|63&$)>2047&&(V<55296||V>57343)&&(G=V);break;case 4:U=m[L+1],$=m[L+2],B=m[L+3],(192&U)==128&&(192&$)==128&&(192&B)==128&&(V=(15&H)<<18|(63&U)<<12|(63&$)<<6|63&B)>65535&&V<1114112&&(G=V)}null===G?(G=65533,q=1):G>65535&&(G-=65536,T.push(G>>>10&1023|55296),G=56320|1023&G),T.push(G),L+=q}return function(m){var R=m.length;if(R<=4096)return String.fromCharCode.apply(String,m);for(var C="",T=0;TC)throw RangeError("Trying to access beyond buffer length")}function checkInt(m,R,C,T,L,U){if(!Buffer.isBuffer(m))throw TypeError('"buffer" argument must be a Buffer instance');if(R>L||Rm.length)throw RangeError("Index out of range")}function checkIEEE754(m,R,C,T,L,U){if(C+T>m.length||C<0)throw RangeError("Index out of range")}function writeFloat(m,R,C,T,U){return R=+R,C>>>=0,U||checkIEEE754(m,R,C,4,34028234663852886e22,-34028234663852886e22),L.write(m,R,C,T,23,4),C+4}function writeDouble(m,R,C,T,U){return R=+R,C>>>=0,U||checkIEEE754(m,R,C,8,17976931348623157e292,-17976931348623157e292),L.write(m,R,C,T,52,8),C+8}R.Buffer=Buffer,R.SlowBuffer=function(m){return+m!=m&&(m=0),Buffer.alloc(+m)},R.INSPECT_MAX_BYTES=50,R.kMaxLength=2147483647,Buffer.TYPED_ARRAY_SUPPORT=function(){try{var m=new Uint8Array(1),R={foo:function(){return 42}};return Object.setPrototypeOf(R,Uint8Array.prototype),Object.setPrototypeOf(m,R),42===m.foo()}catch(m){return!1}}(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),Buffer.poolSize=8192,Buffer.from=function(m,R,C){return from(m,R,C)},Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(m,R,C){return(assertSize(m),m<=0)?createBuffer(m):void 0!==R?"string"==typeof C?createBuffer(m).fill(R,C):createBuffer(m).fill(R):createBuffer(m)},Buffer.allocUnsafe=function(m){return allocUnsafe(m)},Buffer.allocUnsafeSlow=function(m){return allocUnsafe(m)},Buffer.isBuffer=function(m){return null!=m&&!0===m._isBuffer&&m!==Buffer.prototype},Buffer.compare=function(m,R){if(isInstance(m,Uint8Array)&&(m=Buffer.from(m,m.offset,m.byteLength)),isInstance(R,Uint8Array)&&(R=Buffer.from(R,R.offset,R.byteLength)),!Buffer.isBuffer(m)||!Buffer.isBuffer(R))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(m===R)return 0;for(var C=m.length,T=R.length,L=0,U=Math.min(C,T);LC&&(m+=" ... "),""},U&&(Buffer.prototype[U]=Buffer.prototype.inspect),Buffer.prototype.compare=function(m,R,C,T,L){if(isInstance(m,Uint8Array)&&(m=Buffer.from(m,m.offset,m.byteLength)),!Buffer.isBuffer(m))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof m);if(void 0===R&&(R=0),void 0===C&&(C=m?m.length:0),void 0===T&&(T=0),void 0===L&&(L=this.length),R<0||C>m.length||T<0||L>this.length)throw RangeError("out of range index");if(T>=L&&R>=C)return 0;if(T>=L)return -1;if(R>=C)return 1;if(R>>>=0,C>>>=0,T>>>=0,L>>>=0,this===m)return 0;for(var U=L-T,$=C-R,B=Math.min(U,$),V=this.slice(T,L),H=m.slice(R,C),G=0;G>>=0,isFinite(C)?(C>>>=0,void 0===T&&(T="utf8")):(T=C,C=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var L,U,$,B,V,H,G,q,W,Z,Y,K,J=this.length-R;if((void 0===C||C>J)&&(C=J),m.length>0&&(C<0||R<0)||R>this.length)throw RangeError("Attempt to write outside buffer bounds");T||(T="utf8");for(var X=!1;;)switch(T){case"hex":return function(m,R,C,T){C=Number(C)||0;var L=m.length-C;T?(T=Number(T))>L&&(T=L):T=L;var U=R.length;T>U/2&&(T=U/2);for(var $=0;$>8,L.push(C%256),L.push(T);return L}(m,this.length-Y),this,Y,K);default:if(X)throw TypeError("Unknown encoding: "+T);T=(""+T).toLowerCase(),X=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(m,R){var C=this.length;m=~~m,R=void 0===R?C:~~R,m<0?(m+=C)<0&&(m=0):m>C&&(m=C),R<0?(R+=C)<0&&(R=0):R>C&&(R=C),R>>=0,R>>>=0,C||checkOffset(m,R,this.length);for(var T=this[m],L=1,U=0;++U>>=0,R>>>=0,C||checkOffset(m,R,this.length);for(var T=this[m+--R],L=1;R>0&&(L*=256);)T+=this[m+--R]*L;return T},Buffer.prototype.readUInt8=function(m,R){return m>>>=0,R||checkOffset(m,1,this.length),this[m]},Buffer.prototype.readUInt16LE=function(m,R){return m>>>=0,R||checkOffset(m,2,this.length),this[m]|this[m+1]<<8},Buffer.prototype.readUInt16BE=function(m,R){return m>>>=0,R||checkOffset(m,2,this.length),this[m]<<8|this[m+1]},Buffer.prototype.readUInt32LE=function(m,R){return m>>>=0,R||checkOffset(m,4,this.length),(this[m]|this[m+1]<<8|this[m+2]<<16)+16777216*this[m+3]},Buffer.prototype.readUInt32BE=function(m,R){return m>>>=0,R||checkOffset(m,4,this.length),16777216*this[m]+(this[m+1]<<16|this[m+2]<<8|this[m+3])},Buffer.prototype.readIntLE=function(m,R,C){m>>>=0,R>>>=0,C||checkOffset(m,R,this.length);for(var T=this[m],L=1,U=0;++U=(L*=128)&&(T-=Math.pow(2,8*R)),T},Buffer.prototype.readIntBE=function(m,R,C){m>>>=0,R>>>=0,C||checkOffset(m,R,this.length);for(var T=R,L=1,U=this[m+--T];T>0&&(L*=256);)U+=this[m+--T]*L;return U>=(L*=128)&&(U-=Math.pow(2,8*R)),U},Buffer.prototype.readInt8=function(m,R){return(m>>>=0,R||checkOffset(m,1,this.length),128&this[m])?-((255-this[m]+1)*1):this[m]},Buffer.prototype.readInt16LE=function(m,R){m>>>=0,R||checkOffset(m,2,this.length);var C=this[m]|this[m+1]<<8;return 32768&C?4294901760|C:C},Buffer.prototype.readInt16BE=function(m,R){m>>>=0,R||checkOffset(m,2,this.length);var C=this[m+1]|this[m]<<8;return 32768&C?4294901760|C:C},Buffer.prototype.readInt32LE=function(m,R){return m>>>=0,R||checkOffset(m,4,this.length),this[m]|this[m+1]<<8|this[m+2]<<16|this[m+3]<<24},Buffer.prototype.readInt32BE=function(m,R){return m>>>=0,R||checkOffset(m,4,this.length),this[m]<<24|this[m+1]<<16|this[m+2]<<8|this[m+3]},Buffer.prototype.readFloatLE=function(m,R){return m>>>=0,R||checkOffset(m,4,this.length),L.read(this,m,!0,23,4)},Buffer.prototype.readFloatBE=function(m,R){return m>>>=0,R||checkOffset(m,4,this.length),L.read(this,m,!1,23,4)},Buffer.prototype.readDoubleLE=function(m,R){return m>>>=0,R||checkOffset(m,8,this.length),L.read(this,m,!0,52,8)},Buffer.prototype.readDoubleBE=function(m,R){return m>>>=0,R||checkOffset(m,8,this.length),L.read(this,m,!1,52,8)},Buffer.prototype.writeUIntLE=function(m,R,C,T){if(m=+m,R>>>=0,C>>>=0,!T){var L=Math.pow(2,8*C)-1;checkInt(this,m,R,C,L,0)}var U=1,$=0;for(this[R]=255&m;++$>>=0,C>>>=0,!T){var L=Math.pow(2,8*C)-1;checkInt(this,m,R,C,L,0)}var U=C-1,$=1;for(this[R+U]=255&m;--U>=0&&($*=256);)this[R+U]=m/$&255;return R+C},Buffer.prototype.writeUInt8=function(m,R,C){return m=+m,R>>>=0,C||checkInt(this,m,R,1,255,0),this[R]=255&m,R+1},Buffer.prototype.writeUInt16LE=function(m,R,C){return m=+m,R>>>=0,C||checkInt(this,m,R,2,65535,0),this[R]=255&m,this[R+1]=m>>>8,R+2},Buffer.prototype.writeUInt16BE=function(m,R,C){return m=+m,R>>>=0,C||checkInt(this,m,R,2,65535,0),this[R]=m>>>8,this[R+1]=255&m,R+2},Buffer.prototype.writeUInt32LE=function(m,R,C){return m=+m,R>>>=0,C||checkInt(this,m,R,4,4294967295,0),this[R+3]=m>>>24,this[R+2]=m>>>16,this[R+1]=m>>>8,this[R]=255&m,R+4},Buffer.prototype.writeUInt32BE=function(m,R,C){return m=+m,R>>>=0,C||checkInt(this,m,R,4,4294967295,0),this[R]=m>>>24,this[R+1]=m>>>16,this[R+2]=m>>>8,this[R+3]=255&m,R+4},Buffer.prototype.writeIntLE=function(m,R,C,T){if(m=+m,R>>>=0,!T){var L=Math.pow(2,8*C-1);checkInt(this,m,R,C,L-1,-L)}var U=0,$=1,B=0;for(this[R]=255&m;++U>0)-B&255;return R+C},Buffer.prototype.writeIntBE=function(m,R,C,T){if(m=+m,R>>>=0,!T){var L=Math.pow(2,8*C-1);checkInt(this,m,R,C,L-1,-L)}var U=C-1,$=1,B=0;for(this[R+U]=255&m;--U>=0&&($*=256);)m<0&&0===B&&0!==this[R+U+1]&&(B=1),this[R+U]=(m/$>>0)-B&255;return R+C},Buffer.prototype.writeInt8=function(m,R,C){return m=+m,R>>>=0,C||checkInt(this,m,R,1,127,-128),m<0&&(m=255+m+1),this[R]=255&m,R+1},Buffer.prototype.writeInt16LE=function(m,R,C){return m=+m,R>>>=0,C||checkInt(this,m,R,2,32767,-32768),this[R]=255&m,this[R+1]=m>>>8,R+2},Buffer.prototype.writeInt16BE=function(m,R,C){return m=+m,R>>>=0,C||checkInt(this,m,R,2,32767,-32768),this[R]=m>>>8,this[R+1]=255&m,R+2},Buffer.prototype.writeInt32LE=function(m,R,C){return m=+m,R>>>=0,C||checkInt(this,m,R,4,2147483647,-2147483648),this[R]=255&m,this[R+1]=m>>>8,this[R+2]=m>>>16,this[R+3]=m>>>24,R+4},Buffer.prototype.writeInt32BE=function(m,R,C){return m=+m,R>>>=0,C||checkInt(this,m,R,4,2147483647,-2147483648),m<0&&(m=4294967295+m+1),this[R]=m>>>24,this[R+1]=m>>>16,this[R+2]=m>>>8,this[R+3]=255&m,R+4},Buffer.prototype.writeFloatLE=function(m,R,C){return writeFloat(this,m,R,!0,C)},Buffer.prototype.writeFloatBE=function(m,R,C){return writeFloat(this,m,R,!1,C)},Buffer.prototype.writeDoubleLE=function(m,R,C){return writeDouble(this,m,R,!0,C)},Buffer.prototype.writeDoubleBE=function(m,R,C){return writeDouble(this,m,R,!1,C)},Buffer.prototype.copy=function(m,R,C,T){if(!Buffer.isBuffer(m))throw TypeError("argument should be a Buffer");if(C||(C=0),T||0===T||(T=this.length),R>=m.length&&(R=m.length),R||(R=0),T>0&&T=this.length)throw RangeError("Index out of range");if(T<0)throw RangeError("sourceEnd out of bounds");T>this.length&&(T=this.length),m.length-R=0;--U)m[U+R]=this[U+C];else Uint8Array.prototype.set.call(m,this.subarray(C,T),R);return L},Buffer.prototype.fill=function(m,R,C,T){if("string"==typeof m){if("string"==typeof R?(T=R,R=0,C=this.length):"string"==typeof C&&(T=C,C=this.length),void 0!==T&&"string"!=typeof T)throw TypeError("encoding must be a string");if("string"==typeof T&&!Buffer.isEncoding(T))throw TypeError("Unknown encoding: "+T);if(1===m.length){var L,U=m.charCodeAt(0);("utf8"===T&&U<128||"latin1"===T)&&(m=U)}}else"number"==typeof m?m&=255:"boolean"==typeof m&&(m=Number(m));if(R<0||this.length>>=0,C=void 0===C?this.length:C>>>0,m||(m=0),"number"==typeof m)for(L=R;L55295&&C<57344){if(!L){if(C>56319||$+1===T){(R-=3)>-1&&U.push(239,191,189);continue}L=C;continue}if(C<56320){(R-=3)>-1&&U.push(239,191,189),L=C;continue}C=(L-55296<<10|C-56320)+65536}else L&&(R-=3)>-1&&U.push(239,191,189);if(L=null,C<128){if((R-=1)<0)break;U.push(C)}else if(C<2048){if((R-=2)<0)break;U.push(C>>6|192,63&C|128)}else if(C<65536){if((R-=3)<0)break;U.push(C>>12|224,C>>6&63|128,63&C|128)}else if(C<1114112){if((R-=4)<0)break;U.push(C>>18|240,C>>12&63|128,C>>6&63|128,63&C|128)}else throw Error("Invalid code point")}return U}function asciiToBytes(m){for(var R=[],C=0;C=R.length)&&!(L>=m.length);++L)R[L+C]=m[L];return L}function isInstance(m,R){return m instanceof R||null!=m&&null!=m.constructor&&null!=m.constructor.name&&m.constructor.name===R.name}var B=function(){for(var m="0123456789abcdef",R=Array(256),C=0;C<16;++C)for(var T=16*C,L=0;L<16;++L)R[T+L]=m[C]+m[L];return R}()},783:function(m,R){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh */R.read=function(m,R,C,T,L){var U,$,B=8*L-T-1,V=(1<>1,G=-7,q=C?L-1:0,W=C?-1:1,Z=m[R+q];for(q+=W,U=Z&(1<<-G)-1,Z>>=-G,G+=B;G>0;U=256*U+m[R+q],q+=W,G-=8);for($=U&(1<<-G)-1,U>>=-G,G+=T;G>0;$=256*$+m[R+q],q+=W,G-=8);if(0===U)U=1-H;else{if(U===V)return $?NaN:(Z?-1:1)*(1/0);$+=Math.pow(2,T),U-=H}return(Z?-1:1)*$*Math.pow(2,U-T)},R.write=function(m,R,C,T,L,U){var $,B,V,H=8*U-L-1,G=(1<>1,W=23===L?5960464477539062e-23:0,Z=T?0:U-1,Y=T?1:-1,K=R<0||0===R&&1/R<0?1:0;for(isNaN(R=Math.abs(R))||R===1/0?(B=isNaN(R)?1:0,$=G):($=Math.floor(Math.log(R)/Math.LN2),R*(V=Math.pow(2,-$))<1&&($--,V*=2),$+q>=1?R+=W/V:R+=W*Math.pow(2,1-q),R*V>=2&&($++,V/=2),$+q>=G?(B=0,$=G):$+q>=1?(B=(R*V-1)*Math.pow(2,L),$+=q):(B=R*Math.pow(2,q-1)*Math.pow(2,L),$=0));L>=8;m[C+Z]=255&B,Z+=Y,B/=256,L-=8);for($=$<0;m[C+Z]=255&$,Z+=Y,$/=256,H-=8);m[C+Z-Y]|=128*K}}},C={};function __nccwpck_require__(m){var T=C[m];if(void 0!==T)return T.exports;var L=C[m]={exports:{}},U=!0;try{R[m](L,L.exports,__nccwpck_require__),U=!1}finally{U&&delete C[m]}return L.exports}__nccwpck_require__.ab="//";var T=__nccwpck_require__(72);m.exports=T}()},993:function(){},46305:function(){},17591:function(){},77663:function(m){!function(){var R={229:function(m){var R,C,T,L=m.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(m){if(R===setTimeout)return setTimeout(m,0);if((R===defaultSetTimout||!R)&&setTimeout)return R=setTimeout,setTimeout(m,0);try{return R(m,0)}catch(C){try{return R.call(null,m,0)}catch(C){return R.call(this,m,0)}}}!function(){try{R="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(m){R=defaultSetTimout}try{C="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(m){C=defaultClearTimeout}}();var U=[],$=!1,B=-1;function cleanUpNextTick(){$&&T&&($=!1,T.length?U=T.concat(U):B=-1,U.length&&drainQueue())}function drainQueue(){if(!$){var m=runTimeout(cleanUpNextTick);$=!0;for(var R=U.length;R;){for(T=U,U=[];++B1)for(var C=1;C",">":">","'":"'","'":"'",""":'"',""":'"'," ":" "," ":" ","©":"\xa9","©":"\xa9","®":"\xae","®":"\xae","…":"…","…":"…","/":"/","/":"/"},unescapeHtmlEntity=function(m){return H[m]};function ownKeys(m,R){var C=Object.keys(m);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(m);R&&(T=T.filter(function(R){return Object.getOwnPropertyDescriptor(m,R).enumerable})),C.push.apply(C,T)}return C}function _objectSpread(m){for(var R=1;R0&&void 0!==arguments[0]?arguments[0]:{};G=_objectSpread(_objectSpread({},G),m)}(m.options.react),T=m}}},25617:function(m,R,C){"use strict";C.d(R,{zt:function(){return components_Provider},I0:function(){return W},v9:function(){return Z}});var T,L,U,$,B=C(67294),V=B.createContext(null),batch=function(m){m()},H={notify:function(){},get:function(){return[]}};function Subscription_createSubscription(m,R){var C,T=H;function handleChangeWrapper(){L.onStateChange&&L.onStateChange()}function trySubscribe(){if(!C){var L,U,$;C=R?R.addNestedSub(handleChangeWrapper):m.subscribe(handleChangeWrapper),L=batch,U=null,$=null,T={clear:function(){U=null,$=null},notify:function(){L(function(){for(var m=U;m;)m.callback(),m=m.next})},get:function(){for(var m=[],R=U;R;)m.push(R),R=R.next;return m},subscribe:function(m){var R=!0,C=$={callback:m,next:null,prev:$};return C.prev?C.prev.next=C:U=C,function(){R&&null!==U&&(R=!1,C.next?C.next.prev=C.prev:$=C.prev,C.prev?C.prev.next=C.next:U=C.next)}}}}}var L={addNestedSub:function(m){return trySubscribe(),T.subscribe(m)},notifyNestedSubs:function(){T.notify()},handleChangeWrapper:handleChangeWrapper,isSubscribed:function(){return!!C},trySubscribe:trySubscribe,tryUnsubscribe:function(){C&&(C(),C=void 0,T.clear(),T=H)},getListeners:function(){return T}};return L}var G="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?B.useLayoutEffect:B.useEffect,components_Provider=function(m){var R=m.store,C=m.context,T=m.children,L=(0,B.useMemo)(function(){var m=Subscription_createSubscription(R);return{store:R,subscription:m}},[R]),U=(0,B.useMemo)(function(){return R.getState()},[R]);G(function(){var m=L.subscription;return m.onStateChange=m.notifyNestedSubs,m.trySubscribe(),U!==R.getState()&&m.notifyNestedSubs(),function(){m.tryUnsubscribe(),m.onStateChange=null}},[L,U]);var $=C||V;return B.createElement($.Provider,{value:L},T)};function useReduxContext_useReduxContext(){return(0,B.useContext)(V)}function createStoreHook(m){void 0===m&&(m=V);var R=m===V?useReduxContext_useReduxContext:function(){return(0,B.useContext)(m)};return function(){return R().store}}C(8679),C(72973),C(87462);var q=createStoreHook(),W=(void 0===T&&(T=V),L=T===V?q:createStoreHook(T),function(){return L().dispatch}),refEquality=function(m,R){return m===R},Z=(void 0===U&&(U=V),$=U===V?useReduxContext_useReduxContext:function(){return(0,B.useContext)(U)},function(m,R){void 0===R&&(R=refEquality);var C=$(),T=function(m,R,C,T){var L,U=(0,B.useReducer)(function(m){return m+1},0)[1],$=(0,B.useMemo)(function(){return Subscription_createSubscription(C,T)},[C,T]),V=(0,B.useRef)(),H=(0,B.useRef)(),q=(0,B.useRef)(),W=(0,B.useRef)(),Z=C.getState();try{if(m!==H.current||Z!==q.current||V.current){var Y=m(Z);L=void 0!==W.current&&R(Y,W.current)?W.current:Y}else L=W.current}catch(m){throw V.current&&(m.message+="\nThe error may be correlated with this previous error:\n"+V.current.stack+"\n\n"),m}return G(function(){H.current=m,q.current=Z,W.current=L,V.current=void 0}),G(function(){function checkForUpdates(){try{var m=C.getState();if(m===q.current)return;var T=H.current(m);if(R(T,W.current))return;W.current=T,q.current=m}catch(m){V.current=m}U()}return $.onStateChange=checkForUpdates,$.trySubscribe(),checkForUpdates(),function(){return $.tryUnsubscribe()}},[C,$]),L}(m,R,C.store,C.subscription);return(0,B.useDebugValue)(T),T});batch=C(73935).unstable_batchedUpdates},88359:function(m,R){"use strict";/** @license React v17.0.2 * react-is.production.min.js * * Copyright (c) Facebook, Inc. and its affiliates. * * This source code is licensed under the MIT license found in the * LICENSE file in the root directory of this source tree. */var C=60103,T=60106,L=60107,U=60108,$=60114,B=60109,V=60110,H=60112,G=60113,q=60120,W=60115,Z=60116;if("function"==typeof Symbol&&Symbol.for){var Y=Symbol.for;Y("react.element"),Y("react.portal"),Y("react.fragment"),Y("react.strict_mode"),Y("react.profiler"),Y("react.provider"),Y("react.context"),Y("react.forward_ref"),Y("react.suspense"),Y("react.suspense_list"),Y("react.memo"),Y("react.lazy"),Y("react.block"),Y("react.server.block"),Y("react.fundamental"),Y("react.debug_trace_mode"),Y("react.legacy_hidden")}},72973:function(m,R,C){"use strict";C(88359)},68697:function(m,R,C){"use strict";C.d(R,{P1:function(){return L}});var T="NOT_FOUND",defaultEqualityCheck=function(m,R){return m===R},L=function(m){for(var R=arguments.length,C=Array(R>1?R-1:0),T=1;T-1){var U=C[L];return L>0&&(C.splice(L,1),C.unshift(U)),U.value}return T}return{get:get,put:function(R,L){get(R)===T&&(C.unshift({key:R,value:L}),C.length>m&&C.pop())},getEntries:function(){return C},clear:function(){C=[]}}}(V,G);function memoized(){var R=q.get(arguments);if(R===T){if(R=m.apply(null,arguments),H){var C=q.getEntries().find(function(m){return H(m.value,R)});C&&(R=C.value)}q.put(arguments,R)}return R}return memoized.clearCache=function(){return q.clear()},memoized})},83154:function(m,R,C){var T;if("function"==typeof fetch&&(T=void 0!==C.g&&C.g.fetch?C.g.fetch:"undefined"!=typeof window&&window.fetch?window.fetch:fetch),"undefined"==typeof window||void 0===window.document){var L=T||C(68203);L.default&&(L=L.default),R.default=L,m.exports=R.default}},83878:function(m,R,C){"use strict";function _arrayWithHoles(m){if(Array.isArray(m))return m}C.d(R,{Z:function(){return _arrayWithHoles}})},97326:function(m,R,C){"use strict";function _assertThisInitialized(m){if(void 0===m)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return m}C.d(R,{Z:function(){return _assertThisInitialized}})},15671:function(m,R,C){"use strict";function _classCallCheck(m,R){if(!(m instanceof R))throw TypeError("Cannot call a class as a function")}C.d(R,{Z:function(){return _classCallCheck}})},43144:function(m,R,C){"use strict";C.d(R,{Z:function(){return _createClass}});var T=C(83997);function _defineProperties(m,R){for(var C=0;Cm.length)&&(R=m.length);for(var C=0,T=Array(R);C=400?L:T)(V)},"u">typeof FormData&&H instanceof FormData||H&&"object"==typeof H&&(G["content-type"]="application/json",H=JSON.stringify(H)),V.withCredentials=!!C.withCredentials,G)V.setRequestHeader(U,G[U]);V.send(H)})}C.r(R),C.d(R,{del:function(){return $},get:function(){return T},patch:function(){return U},post:function(){return L},put:function(){return B},send:function(){return send}});var T=send.bind(send,"GET"),L=send.bind(send,"POST"),U=send.bind(send,"PATCH"),$=send.bind(send,"DELETE"),B=send.bind(send,"PUT")},34853:function(m,R,C){"use strict";C.d(R,{ZP:function(){return eh}});var T=C(71002),L=C(15671),U=C(43144),$=C(97326),B=C(89611);function _inherits(m,R){if("function"!=typeof R&&null!==R)throw TypeError("Super expression must either be null or a function");m.prototype=Object.create(R&&R.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),Object.defineProperty(m,"prototype",{writable:!1}),R&&(0,B.Z)(m,R)}function _possibleConstructorReturn(m,R){if(R&&("object"===(0,T.Z)(R)||"function"==typeof R))return R;if(void 0!==R)throw TypeError("Derived constructors may only return object or undefined");return(0,$.Z)(m)}function _getPrototypeOf(m){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(m){return m.__proto__||Object.getPrototypeOf(m)})(m)}var V=C(4942),H=C(83878),G=C(81563),q=C(25267);function ownKeys(m,R){var C=Object.keys(m);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(m);R&&(T=T.filter(function(R){return Object.getOwnPropertyDescriptor(m,R).enumerable})),C.push.apply(C,T)}return C}function _objectSpread(m){for(var R=1;R1&&void 0!==arguments[1]?arguments[1]:{};(0,L.Z)(this,Logger),this.init(m,R)}return(0,U.Z)(Logger,[{key:"init",value:function(m){var R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=R.prefix||"i18next:",this.logger=m||W,this.options=R,this.debug=R.debug}},{key:"setDebug",value:function(m){this.debug=m}},{key:"log",value:function(){for(var m=arguments.length,R=Array(m),C=0;C1?R-1:0),T=1;T-1?m.replace(/###/g,"."):m}function canNotTraverseDeeper(){return!m||"string"==typeof m}for(var T="string"!=typeof R?[].concat(R):R.split(".");T.length>1;){if(canNotTraverseDeeper())return{};var L=cleanKey(T.shift());!m[L]&&C&&(m[L]=new C),m=Object.prototype.hasOwnProperty.call(m,L)?m[L]:{}}return canNotTraverseDeeper()?{}:{obj:m,k:cleanKey(T.shift())}}function setPath(m,R,C){var T=getLastOfPath(m,R,Object);T.obj[T.k]=C}function getPath(m,R){var C=getLastOfPath(m,R),T=C.obj,L=C.k;if(T)return T[L]}function getPathWithDefaults(m,R,C){var T=getPath(m,C);return void 0!==T?T:getPath(R,C)}function regexEscape(m){return m.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var K={"&":"&","<":"<",">":">",'"':""","'":"'","/":"/"};function i18next_escape(m){return"string"==typeof m?m.replace(/[&<>"'\/]/g,function(m){return K[m]}):m}var J="undefined"!=typeof window&&window.navigator&&void 0===window.navigator.userAgentData&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,X=[" ",",","?","!",";"];function ownKeys$1(m,R){var C=Object.keys(m);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(m);R&&(T=T.filter(function(R){return Object.getOwnPropertyDescriptor(m,R).enumerable})),C.push.apply(C,T)}return C}function _objectSpread$1(m){for(var R=1;R1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return(0,L.Z)(this,ResourceStore),R=C.call(this),J&&Y.call((0,$.Z)(R)),R.data=m||{},R.options=T,void 0===R.options.keySeparator&&(R.options.keySeparator="."),void 0===R.options.ignoreJSONStructure&&(R.options.ignoreJSONStructure=!0),R}return(0,U.Z)(ResourceStore,[{key:"addNamespaces",value:function(m){0>this.options.ns.indexOf(m)&&this.options.ns.push(m)}},{key:"removeNamespaces",value:function(m){var R=this.options.ns.indexOf(m);R>-1&&this.options.ns.splice(R,1)}},{key:"getResource",value:function(m,R,C){var T=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},L=void 0!==T.keySeparator?T.keySeparator:this.options.keySeparator,U=void 0!==T.ignoreJSONStructure?T.ignoreJSONStructure:this.options.ignoreJSONStructure,$=[m,R];C&&"string"!=typeof C&&($=$.concat(C)),C&&"string"==typeof C&&($=$.concat(L?C.split(L):C)),m.indexOf(".")>-1&&($=m.split("."));var B=getPath(this.data,$);return B||!U||"string"!=typeof C?B:function deepFind(m,R){var C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(m){if(m[R])return m[R];for(var T=R.split(C),L=m,U=0;UU+$;)$++,V=L[B=T.slice(U,U+$).join(C)];if(void 0===V)return;if(null===V)return null;if(R.endsWith(B)){if("string"==typeof V)return V;if(B&&"string"==typeof V[B])return V[B]}var H=T.slice(U+$).join(C);if(H)return deepFind(V,H,C);return}L=L[T[U]]}return L}}(this.data&&this.data[m]&&this.data[m][R],C,L)}},{key:"addResource",value:function(m,R,C,T){var L=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},U=this.options.keySeparator;void 0===U&&(U=".");var $=[m,R];C&&($=$.concat(U?C.split(U):C)),m.indexOf(".")>-1&&($=m.split("."),T=R,R=$[1]),this.addNamespaces(R),setPath(this.data,$,T),L.silent||this.emit("added",m,R,C,T)}},{key:"addResources",value:function(m,R,C){var T=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var L in C)("string"==typeof C[L]||"[object Array]"===Object.prototype.toString.apply(C[L]))&&this.addResource(m,R,L,C[L],{silent:!0});T.silent||this.emit("added",m,R,C)}},{key:"addResourceBundle",value:function(m,R,C,T,L){var U=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},$=[m,R];m.indexOf(".")>-1&&($=m.split("."),T=C,C=R,R=$[1]),this.addNamespaces(R);var B=getPath(this.data,$)||{};T?function deepExtend(m,R,C){for(var T in R)"__proto__"!==T&&"constructor"!==T&&(T in m?"string"==typeof m[T]||m[T]instanceof String||"string"==typeof R[T]||R[T]instanceof String?C&&(m[T]=R[T]):deepExtend(m[T],R[T],C):m[T]=R[T]);return m}(B,C,L):B=_objectSpread$1(_objectSpread$1({},B),C),setPath(this.data,$,B),U.silent||this.emit("added",m,R,C)}},{key:"removeResourceBundle",value:function(m,R){this.hasResourceBundle(m,R)&&delete this.data[m][R],this.removeNamespaces(R),this.emit("removed",m,R)}},{key:"hasResourceBundle",value:function(m,R){return void 0!==this.getResource(m,R)}},{key:"getResourceBundle",value:function(m,R){return(R||(R=this.options.defaultNS),"v1"===this.options.compatibilityAPI)?_objectSpread$1(_objectSpread$1({},{}),this.getResource(m,R)):this.getResource(m,R)}},{key:"getDataByLanguage",value:function(m){return this.data[m]}},{key:"hasLanguageSomeTranslations",value:function(m){var R=this.getDataByLanguage(m);return!!(R&&Object.keys(R)||[]).find(function(m){return R[m]&&Object.keys(R[m]).length>0})}},{key:"toJSON",value:function(){return this.data}}]),ResourceStore}(Y),ee={processors:{},addPostProcessor:function(m){this.processors[m.name]=m},handle:function(m,R,C,T,L){var U=this;return m.forEach(function(m){U.processors[m]&&(R=U.processors[m].process(R,C,T,L))}),R}};function ownKeys$2(m,R){var C=Object.keys(m);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(m);R&&(T=T.filter(function(R){return Object.getOwnPropertyDescriptor(m,R).enumerable})),C.push.apply(C,T)}return C}function _objectSpread$2(m){for(var R=1;R1&&void 0!==arguments[1]?arguments[1]:{};return(0,L.Z)(this,Translator),R=C.call(this),J&&Y.call((0,$.Z)(R)),!function(m,R,C){m.forEach(function(m){R[m]&&(C[m]=R[m])})}(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],m,(0,$.Z)(R)),R.options=T,void 0===R.options.keySeparator&&(R.options.keySeparator="."),R.logger=Z.create("translator"),R}return(0,U.Z)(Translator,[{key:"changeLanguage",value:function(m){m&&(this.language=m)}},{key:"exists",value:function(m){var R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==m)return!1;var C=this.resolve(m,R);return C&&void 0!==C.res}},{key:"extractFromKey",value:function(m,R){var C=void 0!==R.nsSeparator?R.nsSeparator:this.options.nsSeparator;void 0===C&&(C=":");var T=void 0!==R.keySeparator?R.keySeparator:this.options.keySeparator,L=R.ns||this.options.defaultNS||[],U=C&&m.indexOf(C)>-1,$=!this.options.userDefinedKeySeparator&&!R.keySeparator&&!this.options.userDefinedNsSeparator&&!R.nsSeparator&&!function(m,R,C){R=R||"",C=C||"";var T=X.filter(function(m){return 0>R.indexOf(m)&&0>C.indexOf(m)});if(0===T.length)return!0;var L=new RegExp("(".concat(T.map(function(m){return"?"===m?"\\?":m}).join("|"),")")),U=!L.test(m);if(!U){var $=m.indexOf(C);$>0&&!L.test(m.substring(0,$))&&(U=!0)}return U}(m,C,T);if(U&&!$){var B=m.match(this.interpolator.nestingRegexp);if(B&&B.length>0)return{key:m,namespaces:L};var V=m.split(C);(C!==T||C===T&&this.options.ns.indexOf(V[0])>-1)&&(L=V.shift()),m=V.join(T)}return"string"==typeof L&&(L=[L]),{key:m,namespaces:L}}},{key:"translate",value:function(m,R,C){var L=this;if("object"!==(0,T.Z)(R)&&this.options.overloadTranslationOptionHandler&&(R=this.options.overloadTranslationOptionHandler(arguments)),R||(R={}),null==m)return"";Array.isArray(m)||(m=[String(m)]);var U=void 0!==R.returnDetails?R.returnDetails:this.options.returnDetails,$=void 0!==R.keySeparator?R.keySeparator:this.options.keySeparator,B=this.extractFromKey(m[m.length-1],R),V=B.key,H=B.namespaces,G=H[H.length-1],q=R.lng||this.language,W=R.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(q&&"cimode"===q.toLowerCase()){if(W){var Z=R.nsSeparator||this.options.nsSeparator;return U?(Y.res="".concat(G).concat(Z).concat(V),Y):"".concat(G).concat(Z).concat(V)}return U?(Y.res=V,Y):V}var Y=this.resolve(m,R),K=Y&&Y.res,J=Y&&Y.usedKey||V,X=Y&&Y.exactUsedKey||V,Q=Object.prototype.toString.apply(K),ee=void 0!==R.joinArrays?R.joinArrays:this.options.joinArrays,et=!this.i18nFormat||this.i18nFormat.handleAsObject,er="string"!=typeof K&&"boolean"!=typeof K&&"number"!=typeof K;if(et&&K&&er&&0>["[object Number]","[object Function]","[object RegExp]"].indexOf(Q)&&!("string"==typeof ee&&"[object Array]"===Q)){if(!R.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var en=this.options.returnedObjectHandler?this.options.returnedObjectHandler(J,K,_objectSpread$2(_objectSpread$2({},R),{},{ns:H})):"key '".concat(V," (").concat(this.language,")' returned an object instead of string.");return U?(Y.res=en,Y):en}if($){var eo="[object Array]"===Q,ei=eo?[]:{},ea=eo?X:J;for(var es in K)if(Object.prototype.hasOwnProperty.call(K,es)){var el="".concat(ea).concat($).concat(es);ei[es]=this.translate(el,_objectSpread$2(_objectSpread$2({},R),{joinArrays:!1,ns:H})),ei[es]===el&&(ei[es]=K[es])}K=ei}}else if(et&&"string"==typeof ee&&"[object Array]"===Q)(K=K.join(ee))&&(K=this.extendTranslation(K,m,R,C));else{var eu=!1,ec=!1,ed=void 0!==R.count&&"string"!=typeof R.count,ef=Translator.hasDefaultValue(R),ep=ed?this.pluralResolver.getSuffix(q,R.count,R):"",eh=R["defaultValue".concat(ep)]||R.defaultValue;!this.isValidLookup(K)&&ef&&(eu=!0,K=eh),this.isValidLookup(K)||(ec=!0,K=V);var eg=(R.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&ec?void 0:K,em=ef&&eh!==K&&this.options.updateMissing;if(ec||eu||em){if(this.logger.log(em?"updateKey":"missingKey",q,G,V,em?eh:K),$){var ey=this.resolve(V,_objectSpread$2(_objectSpread$2({},R),{},{keySeparator:!1}));ey&&ey.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var ev=[],eb=this.languageUtils.getFallbackCodes(this.options.fallbackLng,R.lng||this.language);if("fallback"===this.options.saveMissingTo&&eb&&eb[0])for(var eE=0;eE1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof m&&(m=[m]),m.forEach(function(m){if(!$.isValidLookup(R)){var V=$.extractFromKey(m,B),H=V.key;C=H;var G=V.namespaces;$.options.fallbackNS&&(G=G.concat($.options.fallbackNS));var q=void 0!==B.count&&"string"!=typeof B.count,W=q&&!B.ordinal&&0===B.count&&$.pluralResolver.shouldUseIntlApi(),Z=void 0!==B.context&&("string"==typeof B.context||"number"==typeof B.context)&&""!==B.context,Y=B.lngs?B.lngs:$.languageUtils.toResolveHierarchy(B.lng||$.language,B.fallbackLng);G.forEach(function(m){$.isValidLookup(R)||(U=m,!et["".concat(Y[0],"-").concat(m)]&&$.utils&&$.utils.hasLoadedNamespace&&!$.utils.hasLoadedNamespace(U)&&(et["".concat(Y[0],"-").concat(m)]=!0,$.logger.warn('key "'.concat(C,'" for languages "').concat(Y.join(", "),'" won\'t get resolved as namespace "').concat(U,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),Y.forEach(function(C){if(!$.isValidLookup(R)){L=C;var U,V=[H];if($.i18nFormat&&$.i18nFormat.addLookupKeys)$.i18nFormat.addLookupKeys(V,H,C,m,B);else{q&&(G=$.pluralResolver.getSuffix(C,B.count,B));var G,Y="".concat($.options.pluralSeparator,"zero");if(q&&(V.push(H+G),W&&V.push(H+Y)),Z){var K="".concat(H).concat($.options.contextSeparator).concat(B.context);V.push(K),q&&(V.push(K+G),W&&V.push(K+Y))}}for(;U=V.pop();)$.isValidLookup(R)||(T=U,R=$.getResource(C,m,U,B))}}))})}}),{res:R,usedKey:C,exactUsedKey:T,usedLng:L,usedNS:U}}},{key:"isValidLookup",value:function(m){return void 0!==m&&!(!this.options.returnNull&&null===m)&&!(!this.options.returnEmptyString&&""===m)}},{key:"getResource",value:function(m,R,C){var T=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(m,R,C,T):this.resourceStore.getResource(m,R,C,T)}}],[{key:"hasDefaultValue",value:function(m){var R="defaultValue";for(var C in m)if(Object.prototype.hasOwnProperty.call(m,C)&&R===C.substring(0,R.length)&&void 0!==m[C])return!0;return!1}}]),Translator}(Y);function capitalize(m){return m.charAt(0).toUpperCase()+m.slice(1)}var en=function(){function LanguageUtil(m){(0,L.Z)(this,LanguageUtil),this.options=m,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Z.create("languageUtils")}return(0,U.Z)(LanguageUtil,[{key:"getScriptPartFromCode",value:function(m){if(!m||0>m.indexOf("-"))return null;var R=m.split("-");return 2===R.length?null:(R.pop(),"x"===R[R.length-1].toLowerCase())?null:this.formatLanguageCode(R.join("-"))}},{key:"getLanguagePartFromCode",value:function(m){if(!m||0>m.indexOf("-"))return m;var R=m.split("-");return this.formatLanguageCode(R[0])}},{key:"formatLanguageCode",value:function(m){if("string"==typeof m&&m.indexOf("-")>-1){var R=["hans","hant","latn","cyrl","cans","mong","arab"],C=m.split("-");return this.options.lowerCaseLng?C=C.map(function(m){return m.toLowerCase()}):2===C.length?(C[0]=C[0].toLowerCase(),C[1]=C[1].toUpperCase(),R.indexOf(C[1].toLowerCase())>-1&&(C[1]=capitalize(C[1].toLowerCase()))):3===C.length&&(C[0]=C[0].toLowerCase(),2===C[1].length&&(C[1]=C[1].toUpperCase()),"sgn"!==C[0]&&2===C[2].length&&(C[2]=C[2].toUpperCase()),R.indexOf(C[1].toLowerCase())>-1&&(C[1]=capitalize(C[1].toLowerCase())),R.indexOf(C[2].toLowerCase())>-1&&(C[2]=capitalize(C[2].toLowerCase()))),C.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?m.toLowerCase():m}},{key:"isSupportedCode",value:function(m){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(m=this.getLanguagePartFromCode(m)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(m)>-1}},{key:"getBestMatchFromCodes",value:function(m){var R,C=this;return m?(m.forEach(function(m){if(!R){var T=C.formatLanguageCode(m);(!C.options.supportedLngs||C.isSupportedCode(T))&&(R=T)}}),!R&&this.options.supportedLngs&&m.forEach(function(m){if(!R){var T=C.getLanguagePartFromCode(m);if(C.isSupportedCode(T))return R=T;R=C.options.supportedLngs.find(function(m){if(0===m.indexOf(T))return m})}}),R||(R=this.getFallbackCodes(this.options.fallbackLng)[0]),R):null}},{key:"getFallbackCodes",value:function(m,R){if(!m)return[];if("function"==typeof m&&(m=m(R)),"string"==typeof m&&(m=[m]),"[object Array]"===Object.prototype.toString.apply(m))return m;if(!R)return m.default||[];var C=m[R];return C||(C=m[this.getScriptPartFromCode(R)]),C||(C=m[this.formatLanguageCode(R)]),C||(C=m[this.getLanguagePartFromCode(R)]),C||(C=m.default),C||[]}},{key:"toResolveHierarchy",value:function(m,R){var C=this,T=this.getFallbackCodes(R||this.options.fallbackLng||[],m),L=[],addCode=function(m){m&&(C.isSupportedCode(m)?L.push(m):C.logger.warn("rejecting language code not found in supportedLngs: ".concat(m)))};return"string"==typeof m&&m.indexOf("-")>-1?("languageOnly"!==this.options.load&&addCode(this.formatLanguageCode(m)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&addCode(this.getScriptPartFromCode(m)),"currentOnly"!==this.options.load&&addCode(this.getLanguagePartFromCode(m))):"string"==typeof m&&addCode(this.formatLanguageCode(m)),T.forEach(function(m){0>L.indexOf(m)&&addCode(C.formatLanguageCode(m))}),L}}]),LanguageUtil}(),eo=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],ei={1:function(m){return Number(m>1)},2:function(m){return Number(1!=m)},3:function(m){return 0},4:function(m){return Number(m%10==1&&m%100!=11?0:m%10>=2&&m%10<=4&&(m%100<10||m%100>=20)?1:2)},5:function(m){return Number(0==m?0:1==m?1:2==m?2:m%100>=3&&m%100<=10?3:m%100>=11?4:5)},6:function(m){return Number(1==m?0:m>=2&&m<=4?1:2)},7:function(m){return Number(1==m?0:m%10>=2&&m%10<=4&&(m%100<10||m%100>=20)?1:2)},8:function(m){return Number(1==m?0:2==m?1:8!=m&&11!=m?2:3)},9:function(m){return Number(m>=2)},10:function(m){return Number(1==m?0:2==m?1:m<7?2:m<11?3:4)},11:function(m){return Number(1==m||11==m?0:2==m||12==m?1:m>2&&m<20?2:3)},12:function(m){return Number(m%10!=1||m%100==11)},13:function(m){return Number(0!==m)},14:function(m){return Number(1==m?0:2==m?1:3==m?2:3)},15:function(m){return Number(m%10==1&&m%100!=11?0:m%10>=2&&(m%100<10||m%100>=20)?1:2)},16:function(m){return Number(m%10==1&&m%100!=11?0:0!==m?1:2)},17:function(m){return Number(1==m||m%10==1&&m%100!=11?0:1)},18:function(m){return Number(0==m?0:1==m?1:2)},19:function(m){return Number(1==m?0:0==m||m%100>1&&m%100<11?1:m%100>10&&m%100<20?2:3)},20:function(m){return Number(1==m?0:0==m||m%100>0&&m%100<20?1:2)},21:function(m){return Number(m%100==1?1:m%100==2?2:m%100==3||m%100==4?3:0)},22:function(m){return Number(1==m?0:2==m?1:(m<0||m>10)&&m%10==0?2:3)}},ea=["v1","v2","v3"],es={zero:0,one:1,two:2,few:3,many:4,other:5},el=function(){function PluralResolver(m){var R,C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,L.Z)(this,PluralResolver),this.languageUtils=m,this.options=C,this.logger=Z.create("pluralResolver"),this.options.compatibilityJSON&&"v4"!==this.options.compatibilityJSON||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=(R={},eo.forEach(function(m){m.lngs.forEach(function(C){R[C]={numbers:m.nr,plurals:ei[m.fc]}})}),R)}return(0,U.Z)(PluralResolver,[{key:"addRule",value:function(m,R){this.rules[m]=R}},{key:"getRule",value:function(m){var R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(m,{type:R.ordinal?"ordinal":"cardinal"})}catch(m){return}return this.rules[m]||this.rules[this.languageUtils.getLanguagePartFromCode(m)]}},{key:"needsPlural",value:function(m){var R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},C=this.getRule(m,R);return this.shouldUseIntlApi()?C&&C.resolvedOptions().pluralCategories.length>1:C&&C.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(m,R){var C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(m,C).map(function(m){return"".concat(R).concat(m)})}},{key:"getSuffixes",value:function(m){var R=this,C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},T=this.getRule(m,C);return T?this.shouldUseIntlApi()?T.resolvedOptions().pluralCategories.sort(function(m,R){return es[m]-es[R]}).map(function(m){return"".concat(R.options.prepend).concat(m)}):T.numbers.map(function(T){return R.getSuffix(m,T,C)}):[]}},{key:"getSuffix",value:function(m,R){var C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},T=this.getRule(m,C);return T?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(T.select(R)):this.getSuffixRetroCompatible(T,R):(this.logger.warn("no plural rule found for: ".concat(m)),"")}},{key:"getSuffixRetroCompatible",value:function(m,R){var C=this,T=m.noAbs?m.plurals(R):m.plurals(Math.abs(R)),L=m.numbers[T];this.options.simplifyPluralSuffix&&2===m.numbers.length&&1===m.numbers[0]&&(2===L?L="plural":1===L&&(L=""));var returnSuffix=function(){return C.options.prepend&&L.toString()?C.options.prepend+L.toString():L.toString()};return"v1"===this.options.compatibilityJSON?1===L?"":"number"==typeof L?"_plural_".concat(L.toString()):returnSuffix():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===m.numbers.length&&1===m.numbers[0]?returnSuffix():this.options.prepend&&T.toString()?this.options.prepend+T.toString():T.toString()}},{key:"shouldUseIntlApi",value:function(){return!ea.includes(this.options.compatibilityJSON)}}]),PluralResolver}();function ownKeys$3(m,R){var C=Object.keys(m);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(m);R&&(T=T.filter(function(R){return Object.getOwnPropertyDescriptor(m,R).enumerable})),C.push.apply(C,T)}return C}function _objectSpread$3(m){for(var R=1;R0&&void 0!==arguments[0]?arguments[0]:{};(0,L.Z)(this,Interpolator),this.logger=Z.create("interpolator"),this.options=m,this.format=m.interpolation&&m.interpolation.format||function(m){return m},this.init(m)}return(0,U.Z)(Interpolator,[{key:"init",value:function(){var m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m.interpolation||(m.interpolation={escapeValue:!0});var R=m.interpolation;this.escape=void 0!==R.escape?R.escape:i18next_escape,this.escapeValue=void 0===R.escapeValue||R.escapeValue,this.useRawValueToEscape=void 0!==R.useRawValueToEscape&&R.useRawValueToEscape,this.prefix=R.prefix?regexEscape(R.prefix):R.prefixEscaped||"{{",this.suffix=R.suffix?regexEscape(R.suffix):R.suffixEscaped||"}}",this.formatSeparator=R.formatSeparator?R.formatSeparator:R.formatSeparator||",",this.unescapePrefix=R.unescapeSuffix?"":R.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":R.unescapeSuffix||"",this.nestingPrefix=R.nestingPrefix?regexEscape(R.nestingPrefix):R.nestingPrefixEscaped||regexEscape("$t("),this.nestingSuffix=R.nestingSuffix?regexEscape(R.nestingSuffix):R.nestingSuffixEscaped||regexEscape(")"),this.nestingOptionsSeparator=R.nestingOptionsSeparator?R.nestingOptionsSeparator:R.nestingOptionsSeparator||",",this.maxReplaces=R.maxReplaces?R.maxReplaces:1e3,this.alwaysFormat=void 0!==R.alwaysFormat&&R.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var m="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=RegExp(m,"g");var R="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=RegExp(R,"g");var C="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=RegExp(C,"g")}},{key:"interpolate",value:function(m,R,C,T){var L,U,$,B=this,V=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function regexSafe(m){return m.replace(/\$/g,"$$$$")}var handleFormat=function(m){if(0>m.indexOf(B.formatSeparator)){var L=getPathWithDefaults(R,V,m);return B.alwaysFormat?B.format(L,void 0,C,_objectSpread$3(_objectSpread$3(_objectSpread$3({},T),R),{},{interpolationkey:m})):L}var U=m.split(B.formatSeparator),$=U.shift().trim(),H=U.join(B.formatSeparator).trim();return B.format(getPathWithDefaults(R,V,$),H,C,_objectSpread$3(_objectSpread$3(_objectSpread$3({},T),R),{},{interpolationkey:$}))};this.resetRegExp();var H=T&&T.missingInterpolationHandler||this.options.missingInterpolationHandler,G=T&&T.interpolation&&void 0!==T.interpolation.skipOnVariables?T.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(m){return regexSafe(m)}},{regex:this.regexp,safeValue:function(m){return B.escapeValue?regexSafe(B.escape(m)):regexSafe(m)}}].forEach(function(R){for($=0;L=R.regex.exec(m);){var C=L[1].trim();if(void 0===(U=handleFormat(C))){if("function"==typeof H){var V=H(m,L,T);U="string"==typeof V?V:""}else if(T&&T.hasOwnProperty(C))U="";else if(G){U=L[0];continue}else B.logger.warn("missed to pass in variable ".concat(C," for interpolating ").concat(m)),U=""}else"string"==typeof U||B.useRawValueToEscape||(U=makeString(U));var q=R.safeValue(U);if(m=m.replace(L[0],q),G?(R.regex.lastIndex+=U.length,R.regex.lastIndex-=L[0].length):R.regex.lastIndex=0,++$>=B.maxReplaces)break}}),m}},{key:"nest",value:function(m,R){var C,T,L=this,U=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},$=_objectSpread$3({},U);function handleHasOptions(m,R){var C=this.nestingOptionsSeparator;if(0>m.indexOf(C))return m;var T=m.split(new RegExp("".concat(C,"[ ]*{"))),L="{".concat(T[1]);m=T[0];var U=(L=this.interpolate(L,$)).match(/'/g),B=L.match(/"/g);(U&&U.length%2==0&&!B||B.length%2!=0)&&(L=L.replace(/'/g,'"'));try{$=JSON.parse(L),R&&($=_objectSpread$3(_objectSpread$3({},R),$))}catch(R){return this.logger.warn("failed parsing options string in nesting for key ".concat(m),R),"".concat(m).concat(C).concat(L)}return delete $.defaultValue,m}for($.applyPostProcessor=!1,delete $.defaultValue;C=this.nestingRegexp.exec(m);){var B=[],V=!1;if(-1!==C[0].indexOf(this.formatSeparator)&&!/{.*}/.test(C[1])){var H=C[1].split(this.formatSeparator).map(function(m){return m.trim()});C[1]=H.shift(),B=H,V=!0}if((T=R(handleHasOptions.call(this,C[1].trim(),$),$))&&C[0]===m&&"string"!=typeof T)return T;"string"!=typeof T&&(T=makeString(T)),T||(this.logger.warn("missed to resolve ".concat(C[1]," for nesting ").concat(m)),T=""),V&&(T=B.reduce(function(m,R){return L.format(m,R,U.lng,_objectSpread$3(_objectSpread$3({},U),{},{interpolationkey:C[1].trim()}))},T.trim())),m=m.replace(C[0],T),this.regexp.lastIndex=0}return m}}]),Interpolator}();function ownKeys$4(m,R){var C=Object.keys(m);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(m);R&&(T=T.filter(function(R){return Object.getOwnPropertyDescriptor(m,R).enumerable})),C.push.apply(C,T)}return C}function _objectSpread$4(m){for(var R=1;R0&&void 0!==arguments[0]?arguments[0]:{};(0,L.Z)(this,Formatter),this.logger=Z.create("formatter"),this.options=m,this.formats={number:createCachedFormatter(function(m,R){var C=new Intl.NumberFormat(m,R);return function(m){return C.format(m)}}),currency:createCachedFormatter(function(m,R){var C=new Intl.NumberFormat(m,_objectSpread$4(_objectSpread$4({},R),{},{style:"currency"}));return function(m){return C.format(m)}}),datetime:createCachedFormatter(function(m,R){var C=new Intl.DateTimeFormat(m,_objectSpread$4({},R));return function(m){return C.format(m)}}),relativetime:createCachedFormatter(function(m,R){var C=new Intl.RelativeTimeFormat(m,_objectSpread$4({},R));return function(m){return C.format(m,R.range||"day")}}),list:createCachedFormatter(function(m,R){var C=new Intl.ListFormat(m,_objectSpread$4({},R));return function(m){return C.format(m)}})},this.init(m)}return(0,U.Z)(Formatter,[{key:"init",value:function(m){var R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},C=R.interpolation;this.formatSeparator=C.formatSeparator?C.formatSeparator:C.formatSeparator||","}},{key:"add",value:function(m,R){this.formats[m.toLowerCase().trim()]=R}},{key:"addCached",value:function(m,R){this.formats[m.toLowerCase().trim()]=createCachedFormatter(R)}},{key:"format",value:function(m,R,C,T){var L=this;return R.split(this.formatSeparator).reduce(function(m,R){var U=function(m){var R=m.toLowerCase().trim(),C={};if(m.indexOf("(")>-1){var T=m.split("(");R=T[0].toLowerCase().trim();var L=T[1].substring(0,T[1].length-1);"currency"===R&&0>L.indexOf(":")?C.currency||(C.currency=L.trim()):"relativetime"===R&&0>L.indexOf(":")?C.range||(C.range=L.trim()):L.split(";").forEach(function(m){if(m){var R,T=(R=m.split(":"),(0,H.Z)(R)||function(m){if("undefined"!=typeof Symbol&&null!=m[Symbol.iterator]||null!=m["@@iterator"])return Array.from(m)}(R)||(0,G.Z)(R)||(0,q.Z)()),L=T[0],U=T.slice(1).join(":").trim().replace(/^'+|'+$/g,"");C[L.trim()]||(C[L.trim()]=U),"false"===U&&(C[L.trim()]=!1),"true"===U&&(C[L.trim()]=!0),isNaN(U)||(C[L.trim()]=parseInt(U,10))}})}return{formatName:R,formatOptions:C}}(R),$=U.formatName,B=U.formatOptions;if(L.formats[$]){var V=m;try{var W=T&&T.formatParams&&T.formatParams[T.interpolationkey]||{},Z=W.locale||W.lng||T.locale||T.lng||C;V=L.formats[$](m,Z,_objectSpread$4(_objectSpread$4(_objectSpread$4({},B),T),W))}catch(m){L.logger.warn(m)}return V}return L.logger.warn("there was no format function for ".concat($)),m},m)}}]),Formatter}();function ownKeys$5(m,R){var C=Object.keys(m);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(m);R&&(T=T.filter(function(R){return Object.getOwnPropertyDescriptor(m,R).enumerable})),C.push.apply(C,T)}return C}function _objectSpread$5(m){for(var R=1;R3&&void 0!==arguments[3]?arguments[3]:{};return(0,L.Z)(this,Connector),U=C.call(this),J&&Y.call((0,$.Z)(U)),U.backend=m,U.store=R,U.services=T,U.languageUtils=T.languageUtils,U.options=B,U.logger=Z.create("backendConnector"),U.waitingReads=[],U.maxParallelReads=B.maxParallelReads||10,U.readingCalls=0,U.maxRetries=B.maxRetries>=0?B.maxRetries:5,U.retryTimeout=B.retryTimeout>=1?B.retryTimeout:350,U.state={},U.queue=[],U.backend&&U.backend.init&&U.backend.init(T,B.backend,B),U}return(0,U.Z)(Connector,[{key:"queueLoad",value:function(m,R,C,T){var L=this,U={},$={},B={},V={};return m.forEach(function(m){var T=!0;R.forEach(function(R){var B="".concat(m,"|").concat(R);!C.reload&&L.store.hasResourceBundle(m,R)?L.state[B]=2:L.state[B]<0||(1===L.state[B]?void 0===$[B]&&($[B]=!0):(L.state[B]=1,T=!1,void 0===$[B]&&($[B]=!0),void 0===U[B]&&(U[B]=!0),void 0===V[R]&&(V[R]=!0)))}),T||(B[m]=!0)}),(Object.keys(U).length||Object.keys($).length)&&this.queue.push({pending:$,pendingCount:Object.keys($).length,loaded:{},errors:[],callback:T}),{toLoad:Object.keys(U),pending:Object.keys($),toLoadLanguages:Object.keys(B),toLoadNamespaces:Object.keys(V)}}},{key:"loaded",value:function(m,R,C){var T=m.split("|"),L=T[0],U=T[1];R&&this.emit("failedLoading",L,U,R),C&&this.store.addResourceBundle(L,U,C),this.state[m]=R?-1:2;var $={};this.queue.forEach(function(C){var T,B,V,H;(V=(B=getLastOfPath(C.loaded,[L],Object)).obj)[H=B.k]=V[H]||[],T&&(V[H]=V[H].concat(U)),T||V[H].push(U),void 0!==C.pending[m]&&(delete C.pending[m],C.pendingCount--),R&&C.errors.push(R),0!==C.pendingCount||C.done||(Object.keys(C.loaded).forEach(function(m){$[m]||($[m]={});var R=C.loaded[m];R.length&&R.forEach(function(R){void 0===$[m][R]&&($[m][R]=!0)})}),C.done=!0,C.errors.length?C.callback(C.errors):C.callback())}),this.emit("loaded",$),this.queue=this.queue.filter(function(m){return!m.done})}},{key:"read",value:function(m,R,C){var T=this,L=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,U=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,$=arguments.length>5?arguments[5]:void 0;if(!m.length)return $(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:m,ns:R,fcName:C,tried:L,wait:U,callback:$});return}return this.readingCalls++,this.backend[C](m,R,function(B,V){if(T.readingCalls--,T.waitingReads.length>0){var H=T.waitingReads.shift();T.read(H.lng,H.ns,H.fcName,H.tried,H.wait,H.callback)}if(B&&V&&L2&&void 0!==arguments[2]?arguments[2]:{},L=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),L&&L();"string"==typeof m&&(m=this.languageUtils.toResolveHierarchy(m)),"string"==typeof R&&(R=[R]);var U=this.queueLoad(m,R,T,L);if(!U.toLoad.length)return U.pending.length||L(),null;U.toLoad.forEach(function(m){C.loadOne(m)})}},{key:"load",value:function(m,R,C){this.prepareLoading(m,R,{},C)}},{key:"reload",value:function(m,R,C){this.prepareLoading(m,R,{reload:!0},C)}},{key:"loadOne",value:function(m){var R=this,C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",T=m.split("|"),L=T[0],U=T[1];this.read(L,U,"read",void 0,void 0,function(T,$){T&&R.logger.warn("".concat(C,"loading namespace ").concat(U," for language ").concat(L," failed"),T),!T&&$&&R.logger.log("".concat(C,"loaded namespace ").concat(U," for language ").concat(L),$),R.loaded(m,T,$)})}},{key:"saveMissing",value:function(m,R,C,T,L){var U=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(R)){this.logger.warn('did not save key "'.concat(C,'" as the namespace "').concat(R,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}null!=C&&""!==C&&(this.backend&&this.backend.create&&this.backend.create(m,R,C,T,null,_objectSpread$5(_objectSpread$5({},U),{},{isUpdate:L})),m&&m[0]&&this.store.addResource(m[0],R,C,T))}}]),Connector}(Y);function transformOptions(m){return"string"==typeof m.ns&&(m.ns=[m.ns]),"string"==typeof m.fallbackLng&&(m.fallbackLng=[m.fallbackLng]),"string"==typeof m.fallbackNS&&(m.fallbackNS=[m.fallbackNS]),m.supportedLngs&&0>m.supportedLngs.indexOf("cimode")&&(m.supportedLngs=m.supportedLngs.concat(["cimode"])),m}function ownKeys$6(m,R){var C=Object.keys(m);if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(m);R&&(T=T.filter(function(R){return Object.getOwnPropertyDescriptor(m,R).enumerable})),C.push.apply(C,T)}return C}function _objectSpread$6(m){for(var R=1;R0&&void 0!==arguments[0]?arguments[0]:{},T=arguments.length>1?arguments[1]:void 0;if((0,L.Z)(this,I18n),m=C.call(this),J&&Y.call((0,$.Z)(m)),m.options=transformOptions(R),m.services={},m.logger=Z,m.modules={external:[]},!function(m){Object.getOwnPropertyNames(Object.getPrototypeOf(m)).forEach(function(R){"function"==typeof m[R]&&(m[R]=m[R].bind(m))})}((0,$.Z)(m)),T&&!m.isInitialized&&!R.isClone){if(!m.options.initImmediate)return m.init(R,T),_possibleConstructorReturn(m,(0,$.Z)(m));setTimeout(function(){m.init(R,T)},0)}return m}return(0,U.Z)(I18n,[{key:"init",value:function(){var m=this,R=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},C=arguments.length>1?arguments[1]:void 0;"function"==typeof R&&(C=R,R={}),!R.defaultNS&&!1!==R.defaultNS&&R.ns&&("string"==typeof R.ns?R.defaultNS=R.ns:0>R.ns.indexOf("translation")&&(R.defaultNS=R.ns[0]));var L={debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(m){var R={};if("object"===(0,T.Z)(m[1])&&(R=m[1]),"string"==typeof m[1]&&(R.defaultValue=m[1]),"string"==typeof m[2]&&(R.tDescription=m[2]),"object"===(0,T.Z)(m[2])||"object"===(0,T.Z)(m[3])){var C=m[3]||m[2];Object.keys(C).forEach(function(m){R[m]=C[m]})}return R},interpolation:{escapeValue:!0,format:function(m,R,C,T){return m},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}};function createClassOnDemand(m){return m?"function"==typeof m?new m:m:null}if(this.options=_objectSpread$6(_objectSpread$6(_objectSpread$6({},L),this.options),transformOptions(R)),"v1"!==this.options.compatibilityAPI&&(this.options.interpolation=_objectSpread$6(_objectSpread$6({},L.interpolation),this.options.interpolation)),void 0!==R.keySeparator&&(this.options.userDefinedKeySeparator=R.keySeparator),void 0!==R.nsSeparator&&(this.options.userDefinedNsSeparator=R.nsSeparator),!this.options.isClone){this.modules.logger?Z.init(createClassOnDemand(this.modules.logger),this.options):Z.init(null,this.options),this.modules.formatter?U=this.modules.formatter:"undefined"!=typeof Intl&&(U=ec);var U,$=new en(this.options);this.store=new Q(this.options.resources,this.options);var B=this.services;B.logger=Z,B.resourceStore=this.store,B.languageUtils=$,B.pluralResolver=new el($,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),U&&(!this.options.interpolation.format||this.options.interpolation.format===L.interpolation.format)&&(B.formatter=createClassOnDemand(U),B.formatter.init(B,this.options),this.options.interpolation.format=B.formatter.format.bind(B.formatter)),B.interpolator=new eu(this.options),B.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},B.backendConnector=new ed(createClassOnDemand(this.modules.backend),B.resourceStore,B,this.options),B.backendConnector.on("*",function(R){for(var C=arguments.length,T=Array(C>1?C-1:0),L=1;L1?C-1:0),L=1;L0&&"dev"!==V[0]&&(this.options.lng=V[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(function(R){m[R]=function(){var C;return(C=m.store)[R].apply(C,arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(function(R){m[R]=function(){var C;return(C=m.store)[R].apply(C,arguments),m}});var H=defer(),load=function(){var finish=function(R,T){m.isInitialized&&!m.initializedStoreOnce&&m.logger.warn("init: i18next is already initialized. You should call init just once!"),m.isInitialized=!0,m.options.isClone||m.logger.log("initialized",m.options),m.emit("initialized",m.options),H.resolve(T),C(R,T)};if(m.languages&&"v1"!==m.options.compatibilityAPI&&!m.isInitialized)return finish(null,m.t.bind(m));m.changeLanguage(m.options.lng,finish)};return this.options.resources||!this.options.initImmediate?load():setTimeout(load,0),H}},{key:"loadResources",value:function(m){var R=this,C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:noop,T=C,L="string"==typeof m?m:this.language;if("function"==typeof m&&(T=m),!this.options.resources||this.options.partialBundledLanguages){if(L&&"cimode"===L.toLowerCase())return T();var U=[],append=function(m){m&&R.services.languageUtils.toResolveHierarchy(m).forEach(function(m){0>U.indexOf(m)&&U.push(m)})};L?append(L):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(function(m){return append(m)}),this.options.preload&&this.options.preload.forEach(function(m){return append(m)}),this.services.backendConnector.load(U,this.options.ns,function(m){m||R.resolvedLanguage||!R.language||R.setResolvedLanguage(R.language),T(m)})}else T(null)}},{key:"reloadResources",value:function(m,R,C){var T=defer();return m||(m=this.languages),R||(R=this.options.ns),C||(C=noop),this.services.backendConnector.reload(m,R,function(m){T.resolve(),C(m)}),T}},{key:"use",value:function(m){if(!m)throw Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!m.type)throw Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===m.type&&(this.modules.backend=m),("logger"===m.type||m.log&&m.warn&&m.error)&&(this.modules.logger=m),"languageDetector"===m.type&&(this.modules.languageDetector=m),"i18nFormat"===m.type&&(this.modules.i18nFormat=m),"postProcessor"===m.type&&ee.addPostProcessor(m),"formatter"===m.type&&(this.modules.formatter=m),"3rdParty"===m.type&&this.modules.external.push(m),this}},{key:"setResolvedLanguage",value:function(m){if(m&&this.languages&&!(["cimode","dev"].indexOf(m)>-1))for(var R=0;R-1)&&this.store.hasLanguageSomeTranslations(C)){this.resolvedLanguage=C;break}}}},{key:"changeLanguage",value:function(m,R){var C=this;this.isLanguageChangingTo=m;var T=defer();this.emit("languageChanging",m);var setLngProps=function(m){C.language=m,C.languages=C.services.languageUtils.toResolveHierarchy(m),C.resolvedLanguage=void 0,C.setResolvedLanguage(m)},done=function(m,L){L?(setLngProps(L),C.translator.changeLanguage(L),C.isLanguageChangingTo=void 0,C.emit("languageChanged",L),C.logger.log("languageChanged",L)):C.isLanguageChangingTo=void 0,T.resolve(function(){return C.t.apply(C,arguments)}),R&&R(m,function(){return C.t.apply(C,arguments)})},setLng=function(R){m||R||!C.services.languageDetector||(R=[]);var T="string"==typeof R?R:C.services.languageUtils.getBestMatchFromCodes(R);T&&(C.language||setLngProps(T),C.translator.language||C.translator.changeLanguage(T),C.services.languageDetector&&C.services.languageDetector.cacheUserLanguage(T)),C.loadResources(T,function(m){done(m,T)})};return m||!this.services.languageDetector||this.services.languageDetector.async?!m&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(setLng):setLng(m):setLng(this.services.languageDetector.detect()),T}},{key:"getFixedT",value:function(m,R,C){var L=this,fixedT=function fixedT(m,R){if("object"!==(0,T.Z)(R)){for(var U,$=arguments.length,B=Array($>2?$-2:0),V=2;V<$;V++)B[V-2]=arguments[V];U=L.options.overloadTranslationOptionHandler([m,R].concat(B))}else U=_objectSpread$6({},R);U.lng=U.lng||fixedT.lng,U.lngs=U.lngs||fixedT.lngs,U.ns=U.ns||fixedT.ns,U.keyPrefix=U.keyPrefix||C||fixedT.keyPrefix;var H=L.options.keySeparator||".",G=U.keyPrefix?"".concat(U.keyPrefix).concat(H).concat(m):m;return L.t(G,U)};return"string"==typeof m?fixedT.lng=m:fixedT.lngs=m,fixedT.ns=R,fixedT.keyPrefix=C,fixedT}},{key:"t",value:function(){var m;return this.translator&&(m=this.translator).translate.apply(m,arguments)}},{key:"exists",value:function(){var m;return this.translator&&(m=this.translator).exists.apply(m,arguments)}},{key:"setDefaultNamespace",value:function(m){this.options.defaultNS=m}},{key:"hasLoadedNamespace",value:function(m){var R=this,C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var T=this.resolvedLanguage||this.languages[0],L=!!this.options&&this.options.fallbackLng,U=this.languages[this.languages.length-1];if("cimode"===T.toLowerCase())return!0;var loadNotPending=function(m,C){var T=R.services.backendConnector.state["".concat(m,"|").concat(C)];return -1===T||2===T};if(C.precheck){var $=C.precheck(this,loadNotPending);if(void 0!==$)return $}return!!(this.hasResourceBundle(T,m)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||loadNotPending(T,m)&&(!L||loadNotPending(U,m)))}},{key:"loadNamespaces",value:function(m,R){var C=this,T=defer();return this.options.ns?("string"==typeof m&&(m=[m]),m.forEach(function(m){0>C.options.ns.indexOf(m)&&C.options.ns.push(m)}),this.loadResources(function(m){T.resolve(),R&&R(m)}),T):(R&&R(),Promise.resolve())}},{key:"loadLanguages",value:function(m,R){var C=defer();"string"==typeof m&&(m=[m]);var T=this.options.preload||[],L=m.filter(function(m){return 0>T.indexOf(m)});return L.length?(this.options.preload=T.concat(L),this.loadResources(function(m){C.resolve(),R&&R(m)}),C):(R&&R(),Promise.resolve())}},{key:"dir",value:function(m){return(m||(m=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),m)?["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(this.services.languageUtils.getLanguagePartFromCode(m))>-1||m.toLowerCase().indexOf("-arab")>1?"rtl":"ltr":"rtl"}},{key:"cloneInstance",value:function(){var m=this,R=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:noop,T=_objectSpread$6(_objectSpread$6(_objectSpread$6({},this.options),R),{isClone:!0}),L=new I18n(T);return(void 0!==R.debug||void 0!==R.prefix)&&(L.logger=L.logger.clone(R)),["store","services","language"].forEach(function(R){L[R]=m[R]}),L.services=_objectSpread$6({},this.services),L.services.utils={hasLoadedNamespace:L.hasLoadedNamespace.bind(L)},L.translator=new er(L.services,L.options),L.translator.on("*",function(m){for(var R=arguments.length,C=Array(R>1?R-1:0),T=1;T0&&void 0!==arguments[0]?arguments[0]:{},R=arguments.length>1?arguments[1]:void 0;return new ef(m,R)});var ep=ef.createInstance();ep.createInstance=ef.createInstance,ep.createInstance,ep.init,ep.loadResources,ep.reloadResources,ep.use,ep.changeLanguage,ep.getFixedT,ep.t,ep.exists,ep.setDefaultNamespace,ep.hasLoadedNamespace,ep.loadNamespaces,ep.loadLanguages;var eh=ep},48583:function(m,R,C){"use strict";C.d(R,{KO:function(){return useAtom},zt:function(){return Provider}});var T=C(67294),L=C(15103);let U=(0,T.createContext)(void 0),useStore=m=>{let R=(0,T.useContext)(U);return(null==m?void 0:m.store)||R||(0,L.K7)()},Provider=({children:m,store:R})=>{let C=(0,T.useRef)();return R||C.current||(C.current=(0,L.MT)()),(0,T.createElement)(U.Provider,{value:R||C.current},m)},isPromiseLike=m=>"function"==typeof(null==m?void 0:m.then),$=T.use||(m=>{if("pending"===m.status)throw m;if("fulfilled"===m.status)return m.value;if("rejected"===m.status)throw m.reason;throw m.status="pending",m.then(R=>{m.status="fulfilled",m.value=R},R=>{m.status="rejected",m.reason=R}),m});function useAtom(m,R){return[function(m,R){let C=useStore(R),[[L,U,B],V]=(0,T.useReducer)(R=>{let T=C.get(m);return Object.is(R[0],T)&&R[1]===C&&R[2]===m?R:[T,C,m]},void 0,()=>[C.get(m),C,m]),H=L;(U!==C||B!==m)&&(V(),H=C.get(m));let G=null==R?void 0:R.delay;return(0,T.useEffect)(()=>{let R=C.sub(m,()=>{if("number"==typeof G){setTimeout(V,G);return}V()});return V(),R},[C,m,G]),(0,T.useDebugValue)(H),isPromiseLike(H)?$(H):H}(m,R),function(m,R){let C=useStore(R),L=(0,T.useCallback)((...R)=>{if(!("write"in m))throw Error("not writable atom");return C.set(m,...R)},[C,m]);return L}(m,R)]}},15103:function(m,R,C){"use strict";let T;C.d(R,{K7:function(){return getDefaultStore},MT:function(){return createStore},cn:function(){return atom}});let L=0;function atom(m,R){let C=`atom${++L}`,T={toString:()=>C};return"function"==typeof m?T.read=m:(T.init=m,T.read=m=>m(T),T.write=(m,R,C)=>R(T,"function"==typeof C?C(m(T)):C)),R&&(T.write=R),T}let hasInitialValue=m=>"init"in m,isActuallyWritableAtom=m=>!!m.write,U=new WeakMap,registerCancelPromise=(m,R)=>{U.set(m,R),m.catch(()=>{}).finally(()=>U.delete(m))},cancelPromise=(m,R)=>{let C=U.get(m);C&&(U.delete(m),C(R))},resolvePromise=(m,R)=>{m.status="fulfilled",m.value=R},rejectPromise=(m,R)=>{m.status="rejected",m.reason=R},isPromiseLike=m=>"function"==typeof(null==m?void 0:m.then),isEqualAtomValue=(m,R)=>"v"in m&&"v"in R&&Object.is(m.v,R.v),isEqualAtomError=(m,R)=>"e"in m&&"e"in R&&Object.is(m.e,R.e),hasPromiseAtomValue=m=>"v"in m&&m.v instanceof Promise,isEqualPromiseAtomValue=(m,R)=>"v"in m&&"v"in R&&m.v.orig&&m.v.orig===R.v.orig,returnAtomValue=m=>{if("e"in m)throw m.e;return m.v},createStore=()=>{let m,R;let C=new WeakMap,T=new WeakMap,L=new Map;m=new Set,R=new Set;let getAtomState=m=>C.get(m),setAtomState=(m,R)=>{Object.freeze(R);let T=C.get(m);if(C.set(m,R),L.has(m)||L.set(m,T),T&&hasPromiseAtomValue(T)){let m="v"in R?R.v instanceof Promise?R.v:Promise.resolve(R.v):Promise.reject(R.e);cancelPromise(T.v,m)}},updateDependencies=(m,R,C)=>{let T=new Map,L=!1;C.forEach((C,U)=>{C||U!==m||(C=R),C?(T.set(U,C),R.d.get(U)!==C&&(L=!0)):console.warn("[Bug] atom state not found")}),(L||R.d.size!==T.size)&&(R.d=T)},setAtomValue=(m,R,C)=>{let T=getAtomState(m),L={d:(null==T?void 0:T.d)||new Map,v:R};if(C&&updateDependencies(m,L,C),T&&isEqualAtomValue(T,L)&&T.d===L.d)return T;if(T&&hasPromiseAtomValue(T)&&hasPromiseAtomValue(L)&&isEqualPromiseAtomValue(T,L)){if(T.d===L.d)return T;L.v=T.v}return setAtomState(m,L),L},setAtomValueOrPromise=(m,R,C,L)=>{if(isPromiseLike(R)){let U;let $=new Promise((L,B)=>{let V=!1;R.then(R=>{if(!V){V=!0;let U=getAtomState(m),B=setAtomValue(m,$,C);resolvePromise($,R),L(R),T.has(m)&&(null==U?void 0:U.d)!==B.d&&mountDependencies(m,B,null==U?void 0:U.d)}},R=>{if(!V){V=!0;let L=getAtomState(m),U=setAtomValue(m,$,C);rejectPromise($,R),B(R),T.has(m)&&(null==L?void 0:L.d)!==U.d&&mountDependencies(m,U,null==L?void 0:L.d)}}),U=m=>{V||(V=!0,m.then(m=>resolvePromise($,m),m=>rejectPromise($,m)),L(m))}});return $.orig=R,$.status="pending",registerCancelPromise($,m=>{m&&U(m),null==L||L()}),setAtomValue(m,$,C)}return setAtomValue(m,R,C)},setAtomError=(m,R,C)=>{let T=getAtomState(m),L={d:(null==T?void 0:T.d)||new Map,e:R};return(C&&updateDependencies(m,L,C),T&&isEqualAtomError(T,L)&&T.d===L.d)?T:(setAtomState(m,L),L)},readAtomState=(m,R)=>{let C,L;let U=getAtomState(m);if(!R&&U&&(T.has(m)||Array.from(U.d).every(([R,C])=>R===m||readAtomState(R)===C)))return U;let $=new Map,B=!0;try{let R=m.read(R=>{if(R===m){let m=getAtomState(R);if(m)return $.set(R,m),returnAtomValue(m);if(hasInitialValue(R))return $.set(R,void 0),R.init;throw Error("no atom init")}let C=readAtomState(R);return $.set(R,C),returnAtomValue(C)},{get signal(){return C||(C=new AbortController),C.signal},get setSelf(){return isActuallyWritableAtom(m)||console.warn("setSelf function cannot be used with read-only atom"),!L&&isActuallyWritableAtom(m)&&(L=(...R)=>{if(B&&console.warn("setSelf function cannot be called in sync"),!B)return writeAtom(m,...R)}),L}});return setAtomValueOrPromise(m,R,$,()=>null==C?void 0:C.abort())}catch(R){return setAtomError(m,R,$)}finally{B=!1}},addAtom=m=>{let R=T.get(m);return R||(R=mountAtom(m)),R},canUnmountAtom=(m,R)=>!R.l.size&&(!R.t.size||1===R.t.size&&R.t.has(m)),delAtom=m=>{let R=T.get(m);R&&canUnmountAtom(m,R)&&unmountAtom(m)},recomputeDependents=m=>{let R=new Map,C=new WeakMap,getDependents=m=>{var R;let C=new Set(null==(R=T.get(m))?void 0:R.t);return L.forEach((R,T)=>{var L;(null==(L=getAtomState(T))?void 0:L.d.has(m))&&C.add(T)}),C},loop1=m=>{getDependents(m).forEach(T=>{T!==m&&(R.set(T,(R.get(T)||new Set).add(m)),C.set(T,(C.get(T)||0)+1),loop1(T))})};loop1(m);let loop2=m=>{getDependents(m).forEach(T=>{var L;if(T!==m){let m=C.get(T);if(m&&C.set(T,--m),!m){let m=!!(null==(L=R.get(T))?void 0:L.size);if(m){let R=getAtomState(T),C=readAtomState(T,!0);m=!R||!isEqualAtomValue(R,C)}m||R.forEach(m=>m.delete(T))}loop2(T)}})};loop2(m)},writeAtomState=(R,...C)=>{let T=!0,L=R.write(m=>returnAtomValue(readAtomState(m)),(C,...L)=>{let U;if(C===R){if(!hasInitialValue(C))throw Error("atom not writable");let m=getAtomState(C),R=setAtomValueOrPromise(C,L[0]);m&&isEqualAtomValue(m,R)||recomputeDependents(C)}else U=writeAtomState(C,...L);if(!T){let R=flushPending();m.forEach(m=>m({type:"async-write",flushed:R}))}return U},...C);return T=!1,L},writeAtom=(R,...C)=>{let T=writeAtomState(R,...C),L=flushPending();return m.forEach(m=>m({type:"write",flushed:L})),T},mountAtom=(m,C,L)=>{var U;let $=L||[];null==(U=getAtomState(m))||U.d.forEach((R,C)=>{let L=T.get(C);L?L.t.add(m):C!==m&&mountAtom(C,m,$)}),readAtomState(m);let B={t:new Set(C&&[C]),l:new Set};if(T.set(m,B),R.add(m),isActuallyWritableAtom(m)&&m.onMount){let{onMount:R}=m;$.push(()=>{let C=R((...R)=>writeAtom(m,...R));C&&(B.u=C)})}return L||$.forEach(m=>m()),B},unmountAtom=m=>{var C;let L=null==(C=T.get(m))?void 0:C.u;L&&L(),T.delete(m),R.delete(m);let U=getAtomState(m);U?(hasPromiseAtomValue(U)&&cancelPromise(U.v),U.d.forEach((R,C)=>{if(C!==m){let R=T.get(C);R&&(R.t.delete(m),canUnmountAtom(C,R)&&unmountAtom(C))}})):console.warn("[Bug] could not find atom state to unmount",m)},mountDependencies=(m,R,C)=>{let L=new Set(R.d.keys());null==C||C.forEach((R,C)=>{if(L.has(C)){L.delete(C);return}let U=T.get(C);U&&(U.t.delete(m),canUnmountAtom(C,U)&&unmountAtom(C))}),L.forEach(R=>{let C=T.get(R);C?C.t.add(m):T.has(m)&&mountAtom(R,m)})},flushPending=()=>{let m;for(m=new Set;L.size;){let R=Array.from(L);L.clear(),R.forEach(([R,C])=>{let L=getAtomState(R);if(L){let U=T.get(R);U&&L.d!==(null==C?void 0:C.d)&&mountDependencies(R,L,null==C?void 0:C.d),U&&!(C&&!hasPromiseAtomValue(C)&&(isEqualAtomValue(C,L)||isEqualAtomError(C,L)))&&(U.l.forEach(m=>m()),m.add(R))}else console.warn("[Bug] no atom state to flush")})}return m};return{get:m=>returnAtomValue(readAtomState(m)),set:writeAtom,sub:(R,C)=>{let T=addAtom(R),L=flushPending(),U=T.l;return U.add(C),m.forEach(m=>m({type:"sub",flushed:L})),()=>{U.delete(C),delAtom(R),m.forEach(m=>m({type:"unsub"}))}},dev_subscribe_store:(R,C)=>{if(2!==C)throw Error("The current StoreListener revision is 2.");return m.add(R),()=>{m.delete(R)}},dev_get_mounted_atoms:()=>R.values(),dev_get_atom_state:m=>C.get(m),dev_get_mounted:m=>T.get(m),dev_restore_atoms:R=>{for(let[m,C]of R)hasInitialValue(m)&&(setAtomValueOrPromise(m,C),recomputeDependents(m));let C=flushPending();m.forEach(m=>m({type:"restore",flushed:C}))}}};"number"==typeof globalThis.__NUMBER_OF_JOTAI_INSTANCES__?++globalThis.__NUMBER_OF_JOTAI_INSTANCES__:globalThis.__NUMBER_OF_JOTAI_INSTANCES__=1;let getDefaultStore=()=>(T||(1!==globalThis.__NUMBER_OF_JOTAI_INSTANCES__&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"),T=createStore()),T)}},function(m){var __webpack_exec__=function(R){return m(m.s=R)};m.O(0,[774,179],function(){return __webpack_exec__(6840),__webpack_exec__(24751)}),_N_E=m.O()}]);
